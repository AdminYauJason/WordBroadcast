"use weex:vue";

if (typeof Promise !== 'undefined' && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor
    return this.then(
      value => promise.resolve(callback()).then(() => value),
      reason => promise.resolve(callback()).then(() => {
        throw reason
      })
    )
  }
};

if (typeof uni !== 'undefined' && uni && uni.requireGlobal) {
  const global = uni.requireGlobal()
  ArrayBuffer = global.ArrayBuffer
  Int8Array = global.Int8Array
  Uint8Array = global.Uint8Array
  Uint8ClampedArray = global.Uint8ClampedArray
  Int16Array = global.Int16Array
  Uint16Array = global.Uint16Array
  Int32Array = global.Int32Array
  Uint32Array = global.Uint32Array
  Float32Array = global.Float32Array
  Float64Array = global.Float64Array
  BigInt64Array = global.BigInt64Array
  BigUint64Array = global.BigUint64Array
};


(()=>{var us=Object.create;var We=Object.defineProperty,ds=Object.defineProperties,hs=Object.getOwnPropertyDescriptor,fs=Object.getOwnPropertyDescriptors,gs=Object.getOwnPropertyNames,Mt=Object.getOwnPropertySymbols,ps=Object.getPrototypeOf,qt=Object.prototype.hasOwnProperty,ms=Object.prototype.propertyIsEnumerable;var jt=(t,e,n)=>e in t?We(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,O=(t,e)=>{for(var n in e||(e={}))qt.call(e,n)&&jt(t,n,e[n]);if(Mt)for(var n of Mt(e))ms.call(e,n)&&jt(t,n,e[n]);return t},B=(t,e)=>ds(t,fs(e));var ys=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var _s=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of gs(e))!qt.call(t,i)&&i!==n&&We(t,i,{get:()=>e[i],enumerable:!(s=hs(e,i))||s.enumerable});return t};var ws=(t,e,n)=>(n=t!=null?us(ps(t)):{},_s(e||!t||!t.__esModule?We(n,"default",{value:t,enumerable:!0}):n,t));var P=(t,e,n)=>new Promise((s,i)=>{var o=l=>{try{a(n.next(l))}catch(c){i(c)}},r=l=>{try{a(n.throw(l))}catch(c){i(c)}},a=l=>l.done?s(l.value):Promise.resolve(l.value).then(o,r);a((n=n.apply(t,e)).next())});var Ht=ys((ar,Kt)=>{Kt.exports=Vue});var u=ws(Ht());var Q=(t,e)=>{let n=t.__vccOpts||t;for(let[s,i]of e)n[s]=i;return n};var bs=Object.prototype.hasOwnProperty,Ss=(t,e)=>bs.call(t,e),vs="__uniSSR",kn="data",xs="globalData";function ks(){return(0,u.getCurrentInstance)()?kn:xs}function Ts(t,e=!1){if(!t)throw new Error(`${e?"shallowSsrRef":"ssrRef"}: You must provide a key.`)}var Tn=(t,e,n=!1)=>{let s=n?(0,u.shallowRef)(t):(0,u.ref)(t);if(typeof window=="undefined")return s;let i=window[vs];if(!i)return s;let o=ks();return Ts(e,n),Ss(i[o],e)&&(s.value=i[o][e],o===kn&&delete i[o][e]),s},zt=(t,e)=>Tn(t,e),$t=(t,e)=>Tn(t,e,!0);function Je(t,e,...n){uni.__log__?uni.__log__(t,e,...n):console[t].apply(console,[...n,e])}function X(t,e){return typeof t=="string"?e:t}var Is=[{path:"pages/launch/launch",style:{navigationStyle:"custom"}},{path:"pages/home_page/home_page",style:{enablePullDownRefresh:!1,navigationStyle:"custom"}},{path:"pages/grid/grid",style:{navigationStyle:"custom"}},{path:"pages/list/search/search",style:{navigationBarTitleText:"\u641C\u7D22"}},{path:"pages/list/detail",style:{navigationBarTitleText:"\u76F4\u64AD\u52A9\u624B"}},{path:"pages/ucenter/ucenter",style:{navigationStyle:"custom"}},{path:"pages/uni-agree/uni-agree",style:{navigationStyle:"custom","app-plus":{popGesture:"none"}}},{path:"pages/ucenter/settings/settings",style:{navigationBarTitleText:"\u8BBE\u7F6E"}},{path:"pages/ucenter/about/about",style:{navigationBarTitleText:"\u5173\u4E8E","app-plus":{titleNView:{buttons:[{type:"share"}]}}}},{path:"uni_modules/uni-upgrade-center-app/pages/upgrade-popup",style:{disableScroll:!0,"app-plus":{backgroundColorTop:"transparent",background:"transparent",titleNView:!1,scrollIndicator:!1,popGesture:"none",animationType:"fade-in",animationDuration:200}}},{path:"pages/ucenter/invite/invite",style:{navigationStyle:"custom",enablePullDownRefresh:!1}},{path:"uni_modules/uni-pay/pages/success/success",style:{backgroundColor:"#F8F8F8",navigationBarTitleText:"\u652F\u4ED8\u6210\u529F"}},{path:"uni_modules/uni-pay/pages/ad-interactive-webview/ad-interactive-webview",style:{backgroundColor:"#F8F8F8",navigationBarTitleText:"ad"}},{path:"uni_modules/uni-pay/pages/pay-desk/pay-desk",style:{backgroundColor:"#F8F8F8",navigationBarTitleText:"\u6536\u94F6\u53F0"}},{path:"pages/Robot/Robot",style:{navigationBarTitleText:"\u6211\u7684Robot"}},{path:"pages/list/list",style:{enablePullDownRefresh:!0,navigationStyle:"custom"}},{path:"pages/confirm/confirm",style:{navigationBarTitleText:"\u786E\u8BA4\u9875\u9762"}},{path:"pages/live_record/live_record",style:{navigationBarTitleText:"\u6211\u7684\u76F4\u64AD\u8BB0\u5F55"}},{path:"pages/wallet/wallet",style:{navigationBarTitleText:"\u6211\u7684\u94B1\u5305"}},{path:"pages/auth/auth",style:{navigationBarTitleText:"\u6388\u6743\u767B\u5F55",navigationBarBackgroundColor:"#ffffff",navigationBarTextStyle:"black"}}],Cs=[{root:"uni_modules/uni-feedback",pages:[{path:"pages/opendb-feedback/opendb-feedback",style:{navigationBarTitleText:"\u610F\u89C1\u53CD\u9988",enablePullDownRefresh:!1}}]},{root:"uni_modules/uni-id-pages/pages",pages:[{path:"userinfo/userinfo",style:{navigationBarTitleText:"\u4E2A\u4EBA\u8D44\u6599"}},{path:"userinfo/realname-verify/realname-verify",style:{enablePullDownRefresh:!1,navigationBarTitleText:"\u5B9E\u540D\u8BA4\u8BC1"}},{path:"login/login-withoutpwd"},{path:"login/login-withpwd"},{path:"userinfo/deactivate/deactivate",style:{navigationBarTitleText:"\u6CE8\u9500\u8D26\u53F7"}},{path:"userinfo/bind-mobile/bind-mobile",style:{navigationBarTitleText:"\u7ED1\u5B9A\u624B\u673A\u53F7\u7801"}},{path:"login/login-smscode",style:{navigationBarTitleText:"\u624B\u673A\u9A8C\u8BC1\u7801\u767B\u5F55"}},{path:"register/register",style:{navigationBarTitleText:"\u6CE8\u518C"}},{path:"retrieve/retrieve",style:{navigationBarTitleText:"\u91CD\u7F6E\u5BC6\u7801"}},{path:"common/webview/webview",style:{enablePullDownRefresh:!1,navigationBarTitleText:""}},{path:"userinfo/change_pwd/change_pwd",style:{enablePullDownRefresh:!1,navigationBarTitleText:"\u4FEE\u6539\u5BC6\u7801"}},{path:"register/register-by-email",style:{navigationBarTitleText:"\u90AE\u7BB1\u9A8C\u8BC1\u7801\u6CE8\u518C"}},{path:"retrieve/retrieve-by-email",style:{navigationBarTitleText:"\u901A\u8FC7\u90AE\u7BB1\u91CD\u7F6E\u5BC6\u7801"}},{path:"userinfo/set-pwd/set-pwd",style:{enablePullDownRefresh:!1,navigationBarTitleText:"\u8BBE\u7F6E\u5BC6\u7801"}}]}],As={navigationBarTextStyle:"black",navigationBarTitleText:"\u6211\u7684Robot",navigationBarBackgroundColor:"#FFFFFF",backgroundColor:"#F8F8F8",enablePullDownRefresh:!1,rpxCalcMaxDeviceWidth:375,rpxCalcBaseDeviceWidth:375},Ps={color:"#7A7E83",selectedColor:"#007AFF",borderStyle:"black",backgroundColor:"#FFFFFF",list:[{pagePath:"pages/home_page/home_page",iconPath:"static/tabbar/list.png",selectedIconPath:"static/tabbar/list_active.png",text:"\u4E3B\u9875"},{pagePath:"pages/grid/grid",iconPath:"static/tabbar/grid.png",selectedIconPath:"static/tabbar/grid_active.png",text:"\u8BDD\u672F\u751F\u6210"},{pagePath:"pages/ucenter/ucenter",iconPath:"static/tabbar/me.png",selectedIconPath:"static/tabbar/me_active.png",text:"\u6211\u7684"}]},Ls={loginPage:"uni_modules/uni-id-pages/pages/login/login-withoutpwd",needLogin:["/uni_modules/uni-id-pages/pages/userinfo/userinfo"],resToLogin:!0},In={pages:Is,subPackages:Cs,globalStyle:As,tabBar:Ps,uniIdRouter:Ls},Os=[];function Es(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function V(t,e,n){return t(n={path:e,exports:{},require:function(s,i){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(i==null&&n.path)}},n.exports),n.exports}var Rs=V(function(t,e){var n;t.exports=(n=n||function(s,i){var o=Object.create||function(){function h(){}return function(m){var _;return h.prototype=m,_=new h,h.prototype=null,_}}(),r={},a=r.lib={},l=a.Base={extend:function(h){var m=o(this);return h&&m.mixIn(h),m.hasOwnProperty("init")&&this.init!==m.init||(m.init=function(){m.$super.init.apply(this,arguments)}),m.init.prototype=m,m.$super=this,m},create:function(){var h=this.extend();return h.init.apply(h,arguments),h},init:function(){},mixIn:function(h){for(var m in h)h.hasOwnProperty(m)&&(this[m]=h[m]);h.hasOwnProperty("toString")&&(this.toString=h.toString)},clone:function(){return this.init.prototype.extend(this)}},c=a.WordArray=l.extend({init:function(h,m){h=this.words=h||[],this.sigBytes=m!=i?m:4*h.length},toString:function(h){return(h||d).stringify(this)},concat:function(h){var m=this.words,_=h.words,b=this.sigBytes,S=h.sigBytes;if(this.clamp(),b%4)for(var I=0;I<S;I++){var A=_[I>>>2]>>>24-I%4*8&255;m[b+I>>>2]|=A<<24-(b+I)%4*8}else for(I=0;I<S;I+=4)m[b+I>>>2]=_[I>>>2];return this.sigBytes+=S,this},clamp:function(){var h=this.words,m=this.sigBytes;h[m>>>2]&=4294967295<<32-m%4*8,h.length=s.ceil(m/4)},clone:function(){var h=l.clone.call(this);return h.words=this.words.slice(0),h},random:function(h){for(var m,_=[],b=function(A){var E=987654321,L=4294967295;return function(){var U=((E=36969*(65535&E)+(E>>16)&L)<<16)+(A=18e3*(65535&A)+(A>>16)&L)&L;return U/=4294967296,(U+=.5)*(s.random()>.5?1:-1)}},S=0;S<h;S+=4){var I=b(4294967296*(m||s.random()));m=987654071*I(),_.push(4294967296*I()|0)}return new c.init(_,h)}}),g=r.enc={},d=g.Hex={stringify:function(h){for(var m=h.words,_=h.sigBytes,b=[],S=0;S<_;S++){var I=m[S>>>2]>>>24-S%4*8&255;b.push((I>>>4).toString(16)),b.push((15&I).toString(16))}return b.join("")},parse:function(h){for(var m=h.length,_=[],b=0;b<m;b+=2)_[b>>>3]|=parseInt(h.substr(b,2),16)<<24-b%8*4;return new c.init(_,m/2)}},p=g.Latin1={stringify:function(h){for(var m=h.words,_=h.sigBytes,b=[],S=0;S<_;S++){var I=m[S>>>2]>>>24-S%4*8&255;b.push(String.fromCharCode(I))}return b.join("")},parse:function(h){for(var m=h.length,_=[],b=0;b<m;b++)_[b>>>2]|=(255&h.charCodeAt(b))<<24-b%4*8;return new c.init(_,m)}},y=g.Utf8={stringify:function(h){try{return decodeURIComponent(escape(p.stringify(h)))}catch(m){throw new Error("Malformed UTF-8 data")}},parse:function(h){return p.parse(unescape(encodeURIComponent(h)))}},w=a.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(h){typeof h=="string"&&(h=y.parse(h)),this._data.concat(h),this._nDataBytes+=h.sigBytes},_process:function(h){var m=this._data,_=m.words,b=m.sigBytes,S=this.blockSize,I=b/(4*S),A=(I=h?s.ceil(I):s.max((0|I)-this._minBufferSize,0))*S,E=s.min(4*A,b);if(A){for(var L=0;L<A;L+=S)this._doProcessBlock(_,L);var U=_.splice(0,A);m.sigBytes-=E}return new c.init(U,E)},clone:function(){var h=l.clone.call(this);return h._data=this._data.clone(),h},_minBufferSize:0});a.Hasher=w.extend({cfg:l.extend(),init:function(h){this.cfg=this.cfg.extend(h),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(h){return this._append(h),this._process(),this},finalize:function(h){return h&&this._append(h),this._doFinalize()},blockSize:16,_createHelper:function(h){return function(m,_){return new h.init(_).finalize(m)}},_createHmacHelper:function(h){return function(m,_){return new f.HMAC.init(h,_).finalize(m)}}});var f=r.algo={};return r}(Math),n)}),ee=Rs,Ds=(V(function(t,e){var n;t.exports=(n=ee,function(s){var i=n,o=i.lib,r=o.WordArray,a=o.Hasher,l=i.algo,c=[];(function(){for(var f=0;f<64;f++)c[f]=4294967296*s.abs(s.sin(f+1))|0})();var g=l.MD5=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(f,h){for(var m=0;m<16;m++){var _=h+m,b=f[_];f[_]=16711935&(b<<8|b>>>24)|4278255360&(b<<24|b>>>8)}var S=this._hash.words,I=f[h+0],A=f[h+1],E=f[h+2],L=f[h+3],U=f[h+4],J=f[h+5],K=f[h+6],ne=f[h+7],G=f[h+8],ae=f[h+9],se=f[h+10],Ce=f[h+11],Ae=f[h+12],Pe=f[h+13],Le=f[h+14],Oe=f[h+15],v=S[0],T=S[1],x=S[2],k=S[3];v=d(v,T,x,k,I,7,c[0]),k=d(k,v,T,x,A,12,c[1]),x=d(x,k,v,T,E,17,c[2]),T=d(T,x,k,v,L,22,c[3]),v=d(v,T,x,k,U,7,c[4]),k=d(k,v,T,x,J,12,c[5]),x=d(x,k,v,T,K,17,c[6]),T=d(T,x,k,v,ne,22,c[7]),v=d(v,T,x,k,G,7,c[8]),k=d(k,v,T,x,ae,12,c[9]),x=d(x,k,v,T,se,17,c[10]),T=d(T,x,k,v,Ce,22,c[11]),v=d(v,T,x,k,Ae,7,c[12]),k=d(k,v,T,x,Pe,12,c[13]),x=d(x,k,v,T,Le,17,c[14]),v=p(v,T=d(T,x,k,v,Oe,22,c[15]),x,k,A,5,c[16]),k=p(k,v,T,x,K,9,c[17]),x=p(x,k,v,T,Ce,14,c[18]),T=p(T,x,k,v,I,20,c[19]),v=p(v,T,x,k,J,5,c[20]),k=p(k,v,T,x,se,9,c[21]),x=p(x,k,v,T,Oe,14,c[22]),T=p(T,x,k,v,U,20,c[23]),v=p(v,T,x,k,ae,5,c[24]),k=p(k,v,T,x,Le,9,c[25]),x=p(x,k,v,T,L,14,c[26]),T=p(T,x,k,v,G,20,c[27]),v=p(v,T,x,k,Pe,5,c[28]),k=p(k,v,T,x,E,9,c[29]),x=p(x,k,v,T,ne,14,c[30]),v=y(v,T=p(T,x,k,v,Ae,20,c[31]),x,k,J,4,c[32]),k=y(k,v,T,x,G,11,c[33]),x=y(x,k,v,T,Ce,16,c[34]),T=y(T,x,k,v,Le,23,c[35]),v=y(v,T,x,k,A,4,c[36]),k=y(k,v,T,x,U,11,c[37]),x=y(x,k,v,T,ne,16,c[38]),T=y(T,x,k,v,se,23,c[39]),v=y(v,T,x,k,Pe,4,c[40]),k=y(k,v,T,x,I,11,c[41]),x=y(x,k,v,T,L,16,c[42]),T=y(T,x,k,v,K,23,c[43]),v=y(v,T,x,k,ae,4,c[44]),k=y(k,v,T,x,Ae,11,c[45]),x=y(x,k,v,T,Oe,16,c[46]),v=w(v,T=y(T,x,k,v,E,23,c[47]),x,k,I,6,c[48]),k=w(k,v,T,x,ne,10,c[49]),x=w(x,k,v,T,Le,15,c[50]),T=w(T,x,k,v,J,21,c[51]),v=w(v,T,x,k,Ae,6,c[52]),k=w(k,v,T,x,L,10,c[53]),x=w(x,k,v,T,se,15,c[54]),T=w(T,x,k,v,A,21,c[55]),v=w(v,T,x,k,G,6,c[56]),k=w(k,v,T,x,Oe,10,c[57]),x=w(x,k,v,T,K,15,c[58]),T=w(T,x,k,v,Pe,21,c[59]),v=w(v,T,x,k,U,6,c[60]),k=w(k,v,T,x,Ce,10,c[61]),x=w(x,k,v,T,E,15,c[62]),T=w(T,x,k,v,ae,21,c[63]),S[0]=S[0]+v|0,S[1]=S[1]+T|0,S[2]=S[2]+x|0,S[3]=S[3]+k|0},_doFinalize:function(){var f=this._data,h=f.words,m=8*this._nDataBytes,_=8*f.sigBytes;h[_>>>5]|=128<<24-_%32;var b=s.floor(m/4294967296),S=m;h[15+(_+64>>>9<<4)]=16711935&(b<<8|b>>>24)|4278255360&(b<<24|b>>>8),h[14+(_+64>>>9<<4)]=16711935&(S<<8|S>>>24)|4278255360&(S<<24|S>>>8),f.sigBytes=4*(h.length+1),this._process();for(var I=this._hash,A=I.words,E=0;E<4;E++){var L=A[E];A[E]=16711935&(L<<8|L>>>24)|4278255360&(L<<24|L>>>8)}return I},clone:function(){var f=a.clone.call(this);return f._hash=this._hash.clone(),f}});function d(f,h,m,_,b,S,I){var A=f+(h&m|~h&_)+b+I;return(A<<S|A>>>32-S)+h}function p(f,h,m,_,b,S,I){var A=f+(h&_|m&~_)+b+I;return(A<<S|A>>>32-S)+h}function y(f,h,m,_,b,S,I){var A=f+(h^m^_)+b+I;return(A<<S|A>>>32-S)+h}function w(f,h,m,_,b,S,I){var A=f+(m^(h|~_))+b+I;return(A<<S|A>>>32-S)+h}i.MD5=a._createHelper(g),i.HmacMD5=a._createHmacHelper(g)}(Math),n.MD5)}),V(function(t,e){var n;t.exports=(n=ee,void function(){var s=n,i=s.lib.Base,o=s.enc.Utf8;s.algo.HMAC=i.extend({init:function(r,a){r=this._hasher=new r.init,typeof a=="string"&&(a=o.parse(a));var l=r.blockSize,c=4*l;a.sigBytes>c&&(a=r.finalize(a)),a.clamp();for(var g=this._oKey=a.clone(),d=this._iKey=a.clone(),p=g.words,y=d.words,w=0;w<l;w++)p[w]^=1549556828,y[w]^=909522486;g.sigBytes=d.sigBytes=c,this.reset()},reset:function(){var r=this._hasher;r.reset(),r.update(this._iKey)},update:function(r){return this._hasher.update(r),this},finalize:function(r){var a=this._hasher,l=a.finalize(r);return a.reset(),a.finalize(this._oKey.clone().concat(l))}})}())}),V(function(t,e){t.exports=ee.HmacMD5})),Ns=V(function(t,e){t.exports=ee.enc.Utf8}),Us=V(function(t,e){var n;t.exports=(n=ee,function(){var s=n,i=s.lib.WordArray;function o(r,a,l){for(var c=[],g=0,d=0;d<a;d++)if(d%4){var p=l[r.charCodeAt(d-1)]<<d%4*2,y=l[r.charCodeAt(d)]>>>6-d%4*2;c[g>>>2]|=(p|y)<<24-g%4*8,g++}return i.create(c,g)}s.enc.Base64={stringify:function(r){var a=r.words,l=r.sigBytes,c=this._map;r.clamp();for(var g=[],d=0;d<l;d+=3)for(var p=(a[d>>>2]>>>24-d%4*8&255)<<16|(a[d+1>>>2]>>>24-(d+1)%4*8&255)<<8|a[d+2>>>2]>>>24-(d+2)%4*8&255,y=0;y<4&&d+.75*y<l;y++)g.push(c.charAt(p>>>6*(3-y)&63));var w=c.charAt(64);if(w)for(;g.length%4;)g.push(w);return g.join("")},parse:function(r){var a=r.length,l=this._map,c=this._reverseMap;if(!c){c=this._reverseMap=[];for(var g=0;g<l.length;g++)c[l.charCodeAt(g)]=g}var d=l.charAt(64);if(d){var p=r.indexOf(d);p!==-1&&(a=p)}return o(r,a,c)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64)}),Cn="uni_id_token",An="uni_id_token_expired",Fs="uniIdToken",Fe={DEFAULT:"FUNCTION",FUNCTION:"FUNCTION",OBJECT:"OBJECT",CLIENT_DB:"CLIENT_DB"},Vt="pending",Bs="fulfilled",Wt="rejected";function be(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function Pn(t){return be(t)==="object"}function Ln(t){return typeof t=="function"}function Ms(t){return function(){try{return t.apply(t,arguments)}catch(e){console.error(e)}}}var Jt="REJECTED",On="NOT_PENDING",Be=class{constructor({createPromise:e,retryRule:n=Jt}={}){this.createPromise=e,this.status=null,this.promise=null,this.retryRule=n}get needRetry(){if(!this.status)return!0;switch(this.retryRule){case Jt:return this.status===Wt;case On:return this.status!==Vt}}exec(){return this.needRetry?(this.status=Vt,this.promise=this.createPromise().then(e=>(this.status=Bs,Promise.resolve(e)),e=>(this.status=Wt,Promise.reject(e))),this.promise):this.promise}},ut=class{constructor(){this._callback={}}addListener(e,n){this._callback[e]||(this._callback[e]=[]),this._callback[e].push(n)}on(e,n){return this.addListener(e,n)}removeListener(e,n){if(!n)throw new Error('The "listener" argument must be of type function. Received undefined');let s=this._callback[e];if(!s)return;let i=function(o,r){for(let a=o.length-1;a>=0;a--)if(o[a]===r)return a;return-1}(s,n);s.splice(i,1)}off(e,n){return this.removeListener(e,n)}removeAllListener(e){delete this._callback[e]}emit(e,...n){let s=this._callback[e];if(s)for(let i=0;i<s.length;i++)s[i](...n)}};function Et(t){return t&&typeof t=="string"?JSON.parse(t):t}var js=!1,qs="app",Ks=Et(Os),Rt=qs;Et("");var Hs=Et('[{"provider":"aliyun","spaceName":"live-agent","spaceId":"mp-2f9390ec-7ecb-48a2-9e47-e99a53037e27","clientSecret":"V0qIAEe36jSG4uDyjnH33w==","endpoint":"https://api.next.bspapp.com"}]')||[],zs="";try{zs="__UNI__D091391"}catch(t){}var Ge,Ue={};function ue(t,e={}){var n,s;return n=Ue,s=t,Object.prototype.hasOwnProperty.call(n,s)||(Ue[t]=e),Ue[t]}function $s(){return Ge||(Ge=function(){if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;function t(){return this}return t()!==void 0?t():new Function("return this")()}(),Ge)}Ue=uni._globalUniCloudObj?uni._globalUniCloudObj:uni._globalUniCloudObj={};var En=["invoke","success","fail","complete"],$=ue("_globalUniCloudInterceptor");function Rn(t,e){$[t]||($[t]={}),Pn(e)&&Object.keys(e).forEach(n=>{En.indexOf(n)>-1&&function(s,i,o){let r=$[s][i];r||(r=$[s][i]=[]),r.indexOf(o)===-1&&Ln(o)&&r.push(o)}(t,n,e[n])})}function Vs(t,e){$[t]||($[t]={}),Pn(e)?Object.keys(e).forEach(n=>{En.indexOf(n)>-1&&function(s,i,o){let r=$[s][i];if(!r)return;let a=r.indexOf(o);a>-1&&r.splice(a,1)}(t,n,e[n])}):delete $[t]}function M(t,e){return t&&t.length!==0?t.reduce((n,s)=>n.then(()=>s(e)),Promise.resolve()):Promise.resolve()}function j(t,e){return $[t]&&$[t][e]||[]}function Ws(t){Rn("callObject",t)}var Qe=ue("_globalUniCloudListener"),R={RESPONSE:"response",NEED_LOGIN:"needLogin",REFRESH_TOKEN:"refreshToken"},Z={CLIENT_DB:"clientdb",CLOUD_FUNCTION:"cloudfunction",CLOUD_OBJECT:"cloudobject"};function Te(t){return Qe[t]||(Qe[t]=[]),Qe[t]}function Ye(t,e){let n=Te(t);n.includes(e)||n.push(e)}function Xe(t,e){let n=Te(t),s=n.indexOf(e);s!==-1&&n.splice(s,1)}function z(t,e){let n=Te(t);for(let s=0;s<n.length;s++)(0,n[s])(e)}var Ze,et=!1;function Dn(){return Ze||(Ze=new Promise(t=>{et&&t(),function e(){if(typeof getCurrentPages=="function"){let n=getCurrentPages();n&&n[0]&&(et=!0,t())}et||setTimeout(()=>{e()},30)}()}),Ze)}function Nn(t){let e={};for(let n in t){let s=t[n];Ln(s)&&(e[n]=Ms(s))}return e}var C=class extends Error{constructor(e){super(e.message),this.errMsg=e.message||e.errMsg||"unknown system error",this.code=this.errCode=e.code||e.errCode||"SYSTEM_ERROR",this.errSubject=this.subject=e.subject||e.errSubject,this.cause=e.cause,this.requestId=e.requestId}toJson(e=0){if(!(e>=10))return e++,{errCode:this.errCode,errMsg:this.errMsg,errSubject:this.errSubject,cause:this.cause&&this.cause.toJson?this.cause.toJson(e):this.cause}}},N={request:t=>uni.request(t),uploadFile:t=>uni.uploadFile(t),setStorageSync:(t,e)=>uni.setStorageSync(t,e),getStorageSync:t=>uni.getStorageSync(t),removeStorageSync:t=>uni.removeStorageSync(t),clearStorageSync:()=>uni.clearStorageSync(),connectSocket:t=>uni.connectSocket(t)};function Un(t){return t&&Un(t.__v_raw)||t}function Se(){return{token:N.getStorageSync(Cn)||N.getStorageSync(Fs),tokenExpired:N.getStorageSync(An)}}function Fn({token:t,tokenExpired:e}={}){t&&N.setStorageSync(Cn,t),e&&N.setStorageSync(An,e)}var tt,Ee;function Bn(){return tt||(tt=uni.getSystemInfoSync()),tt}function Js(){let t,e;try{if(uni.getLaunchOptionsSync){if(uni.getLaunchOptionsSync.toString().indexOf("not yet implemented")>-1)return;let{scene:n,channel:s}=uni.getLaunchOptionsSync();t=s,e=n}}catch(n){}return{channel:t,scene:e}}var dt={};function ht(){let t=uni.getLocale&&uni.getLocale()||"en";if(Ee)return B(O(O({},dt),Ee),{locale:t,LOCALE:t});let e=Bn(),{deviceId:n,osName:s,uniPlatform:i,appId:o}=e,r=["appId","appLanguage","appName","appVersion","appVersionCode","appWgtVersion","browserName","browserVersion","deviceBrand","deviceId","deviceModel","deviceType","osName","osVersion","romName","romVersion","ua","hostName","hostVersion","uniPlatform","uniRuntimeVersion","uniRuntimeVersionCode","uniCompilerVersion","uniCompilerVersionCode"];for(let a in e)Object.hasOwnProperty.call(e,a)&&r.indexOf(a)===-1&&delete e[a];return Ee=O(O({PLATFORM:i,OS:s,APPID:o,DEVICEID:n},Js()),e),B(O(O({},dt),Ee),{locale:t,LOCALE:t})}var ce={sign:function(t,e){let n="";return Object.keys(t).sort().forEach(function(s){t[s]&&(n=n+"&"+s+"="+t[s])}),n=n.slice(1),Ds(n,e).toString()},wrappedRequest:function(t,e){return new Promise((n,s)=>{e(Object.assign(t,{complete(i){i||(i={});let o=i.data&&i.data.header&&i.data.header["x-serverless-request-id"]||i.header&&i.header["request-id"];if(!i.statusCode||i.statusCode>=400){let a=i.data&&i.data.error&&i.data.error.code||"SYS_ERR",l=i.data&&i.data.error&&i.data.error.message||i.errMsg||"request:fail";return s(new C({code:a,message:l,requestId:o}))}let r=i.data;if(r.error)return s(new C({code:r.error.code,message:r.error.message,requestId:o}));r.result=r.data,r.requestId=o,delete r.data,n(r)}}))})},toBase64:function(t){return Us.stringify(Ns.parse(t))}},Gs=class{constructor(t){["spaceId","clientSecret"].forEach(e=>{if(!Object.prototype.hasOwnProperty.call(t,e))throw new Error(`${e} required`)}),this.config=Object.assign({},{endpoint:t.spaceId.indexOf("mp-")===0?"https://api.next.bspapp.com":"https://api.bspapp.com"},t),this.config.provider="aliyun",this.config.requestUrl=this.config.endpoint+"/client",this.config.envType=this.config.envType||"public",this.config.accessTokenKey="access_token_"+this.config.spaceId,this.adapter=N,this._getAccessTokenPromiseHub=new Be({createPromise:()=>this.requestAuth(this.setupRequest({method:"serverless.auth.user.anonymousAuthorize",params:"{}"},"auth")).then(e=>{if(!e.result||!e.result.accessToken)throw new C({code:"AUTH_FAILED",message:"\u83B7\u53D6accessToken\u5931\u8D25"});this.setAccessToken(e.result.accessToken)}),retryRule:On})}get hasAccessToken(){return!!this.accessToken}setAccessToken(t){this.accessToken=t}requestWrapped(t){return ce.wrappedRequest(t,this.adapter.request)}requestAuth(t){return this.requestWrapped(t)}request(t,e){return Promise.resolve().then(()=>this.hasAccessToken?e?this.requestWrapped(t):this.requestWrapped(t).catch(n=>new Promise((s,i)=>{!n||n.code!=="GATEWAY_INVALID_TOKEN"&&n.code!=="InvalidParameter.InvalidToken"?i(n):s()}).then(()=>this.getAccessToken()).then(()=>{let s=this.rebuildRequest(t);return this.request(s,!0)})):this.getAccessToken().then(()=>{let n=this.rebuildRequest(t);return this.request(n,!0)}))}rebuildRequest(t){let e=Object.assign({},t);return e.data.token=this.accessToken,e.header["x-basement-token"]=this.accessToken,e.header["x-serverless-sign"]=ce.sign(e.data,this.config.clientSecret),e}setupRequest(t,e){let n=Object.assign({},t,{spaceId:this.config.spaceId,timestamp:Date.now()}),s={"Content-Type":"application/json"};return e!=="auth"&&(n.token=this.accessToken,s["x-basement-token"]=this.accessToken),s["x-serverless-sign"]=ce.sign(n,this.config.clientSecret),{url:this.config.requestUrl,method:"POST",data:n,dataType:"json",header:s}}getAccessToken(){return this._getAccessTokenPromiseHub.exec()}authorize(){return P(this,null,function*(){yield this.getAccessToken()})}callFunction(t){let e={method:"serverless.function.runtime.invoke",params:JSON.stringify({functionTarget:t.name,functionArgs:t.data||{}})};return this.request(B(O({},this.setupRequest(e)),{timeout:t.timeout}))}getOSSUploadOptionsFromPath(t){let e={method:"serverless.file.resource.generateProximalSign",params:JSON.stringify(t)};return this.request(this.setupRequest(e))}uploadFileToOSS({url:t,formData:e,name:n,filePath:s,fileType:i,onUploadProgress:o}){return new Promise((r,a)=>{let l=this.adapter.uploadFile({url:t,formData:e,name:n,filePath:s,fileType:i,header:{"X-OSS-server-side-encrpytion":"AES256"},success(c){c&&c.statusCode<400?r(c):a(new C({code:"UPLOAD_FAILED",message:"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))},fail(c){a(new C({code:c.code||"UPLOAD_FAILED",message:c.message||c.errMsg||"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))}});typeof o=="function"&&l&&typeof l.onProgressUpdate=="function"&&l.onProgressUpdate(c=>{o({loaded:c.totalBytesSent,total:c.totalBytesExpectedToSend})})})}reportOSSUpload(t){let e={method:"serverless.file.resource.report",params:JSON.stringify(t)};return this.request(this.setupRequest(e))}uploadFile(r){return P(this,arguments,function*({filePath:t,cloudPath:e,fileType:n="image",cloudPathAsRealPath:s=!1,onUploadProgress:i,config:o}){if(be(e)!=="string")throw new C({code:"INVALID_PARAM",message:"cloudPath\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32\u7C7B\u578B"});if(!(e=e.trim()))throw new C({code:"INVALID_PARAM",message:"cloudPath\u4E0D\u53EF\u4E3A\u7A7A"});if(/:\/\//.test(e))throw new C({code:"INVALID_PARAM",message:"cloudPath\u4E0D\u5408\u6CD5"});let a=o&&o.envType||this.config.envType;if(s&&(e[0]!=="/"&&(e="/"+e),e.indexOf("\\")>-1))throw new C({code:"INVALID_PARAM",message:"\u4F7F\u7528cloudPath\u4F5C\u4E3A\u8DEF\u5F84\u65F6\uFF0CcloudPath\u4E0D\u53EF\u5305\u542B\u201C\\\u201D"});let l=(yield this.getOSSUploadOptionsFromPath({env:a,filename:s?e.split("/").pop():e,fileId:s?e:void 0})).result,c="https://"+l.cdnDomain+"/"+l.ossPath,{securityToken:g,accessKeyId:d,signature:p,host:y,ossPath:w,id:f,policy:h,ossCallbackUrl:m}=l,_={"Cache-Control":"max-age=2592000","Content-Disposition":"attachment",OSSAccessKeyId:d,Signature:p,host:y,id:f,key:w,policy:h,success_action_status:200};if(g&&(_["x-oss-security-token"]=g),m){let S=JSON.stringify({callbackUrl:m,callbackBody:JSON.stringify({fileId:f,spaceId:this.config.spaceId}),callbackBodyType:"application/json"});_.callback=ce.toBase64(S)}let b={url:"https://"+l.host,formData:_,fileName:"file",name:"file",filePath:t,fileType:n};if(yield this.uploadFileToOSS(Object.assign({},b,{onUploadProgress:i})),m)return{success:!0,filePath:t,fileID:c};if((yield this.reportOSSUpload({id:f})).success)return{success:!0,filePath:t,fileID:c};throw new C({code:"UPLOAD_FAILED",message:"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"})})}getTempFileURL({fileList:t}={}){return new Promise((e,n)=>{Array.isArray(t)&&t.length!==0||n(new C({code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u5B57\u7B26\u4E32"})),e({fileList:t.map(s=>({fileID:s,tempFileURL:s}))})})}getFileInfo(){return P(this,arguments,function*({fileList:t}={}){if(!Array.isArray(t)||t.length===0)throw new C({code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u5B57\u7B26\u4E32"});let e={method:"serverless.file.resource.info",params:JSON.stringify({id:t.map(n=>n.split("?")[0]).join(",")})};return{fileList:(yield this.request(this.setupRequest(e))).result}})}},Qs={init(t){let e=new Gs(t),n={signInAnonymously:function(){return e.authorize()},getLoginState:function(){return Promise.resolve(!1)}};return e.auth=function(){return n},e.customAuth=e.auth,e}},Ys=typeof location!="undefined"&&location.protocol==="http:"?"http:":"https:",Gt;(function(t){t.local="local",t.none="none",t.session="session"})(Gt||(Gt={}));var Xs=function(){},Zs=V(function(t,e){var n;t.exports=(n=ee,function(s){var i=n,o=i.lib,r=o.WordArray,a=o.Hasher,l=i.algo,c=[],g=[];(function(){function y(m){for(var _=s.sqrt(m),b=2;b<=_;b++)if(!(m%b))return!1;return!0}function w(m){return 4294967296*(m-(0|m))|0}for(var f=2,h=0;h<64;)y(f)&&(h<8&&(c[h]=w(s.pow(f,.5))),g[h]=w(s.pow(f,1/3)),h++),f++})();var d=[],p=l.SHA256=a.extend({_doReset:function(){this._hash=new r.init(c.slice(0))},_doProcessBlock:function(y,w){for(var f=this._hash.words,h=f[0],m=f[1],_=f[2],b=f[3],S=f[4],I=f[5],A=f[6],E=f[7],L=0;L<64;L++){if(L<16)d[L]=0|y[w+L];else{var U=d[L-15],J=(U<<25|U>>>7)^(U<<14|U>>>18)^U>>>3,K=d[L-2],ne=(K<<15|K>>>17)^(K<<13|K>>>19)^K>>>10;d[L]=J+d[L-7]+ne+d[L-16]}var G=h&m^h&_^m&_,ae=(h<<30|h>>>2)^(h<<19|h>>>13)^(h<<10|h>>>22),se=E+((S<<26|S>>>6)^(S<<21|S>>>11)^(S<<7|S>>>25))+(S&I^~S&A)+g[L]+d[L];E=A,A=I,I=S,S=b+se|0,b=_,_=m,m=h,h=se+(ae+G)|0}f[0]=f[0]+h|0,f[1]=f[1]+m|0,f[2]=f[2]+_|0,f[3]=f[3]+b|0,f[4]=f[4]+S|0,f[5]=f[5]+I|0,f[6]=f[6]+A|0,f[7]=f[7]+E|0},_doFinalize:function(){var y=this._data,w=y.words,f=8*this._nDataBytes,h=8*y.sigBytes;return w[h>>>5]|=128<<24-h%32,w[14+(h+64>>>9<<4)]=s.floor(f/4294967296),w[15+(h+64>>>9<<4)]=f,y.sigBytes=4*w.length,this._process(),this._hash},clone:function(){var y=a.clone.call(this);return y._hash=this._hash.clone(),y}});i.SHA256=a._createHelper(p),i.HmacSHA256=a._createHmacHelper(p)}(Math),n.SHA256)}),ft=Zs,Mn=V(function(t,e){t.exports=ee.HmacSHA256}),Ie=()=>{let t;if(!Promise){t=()=>{},t.promise={};let n=()=>{throw new C({message:'Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.'})};return Object.defineProperty(t.promise,"then",{get:n}),Object.defineProperty(t.promise,"catch",{get:n}),t}let e=new Promise((n,s)=>{t=(i,o)=>i?s(i):n(o)});return t.promise=e,t};function ei(t){return t===void 0}function ti(t){return Object.prototype.toString.call(t)==="[object Null]"}function Qt(t=""){return t.replace(/([\s\S]+)\s+(请前往云开发AI小助手查看问题：.*)/,"$1")}function Yt(t=32){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="";for(let s=0;s<t;s++)n+=e.charAt(Math.floor(62*Math.random()));return n}var Xt;function ni(t){let e=(n=t,Object.prototype.toString.call(n)==="[object Array]"?t:[t]);var n;for(let s of e){let{isMatch:i,genAdapter:o,runtime:r}=s;if(i())return{adapter:o(),runtime:r}}}(function(t){t.WEB="web",t.WX_MP="wx_mp"})(Xt||(Xt={}));var F={adapter:null,runtime:void 0},si=["anonymousUuidKey"],ye=class extends Xs{constructor(){super(),F.adapter.root.tcbObject||(F.adapter.root.tcbObject={})}setItem(e,n){F.adapter.root.tcbObject[e]=n}getItem(e){return F.adapter.root.tcbObject[e]}removeItem(e){delete F.adapter.root.tcbObject[e]}clear(){delete F.adapter.root.tcbObject}};function Zt(t,e){switch(t){case"local":return e.localStorage||new ye;case"none":return new ye;default:return e.sessionStorage||new ye}}var Me=class{constructor(e){if(!this._storage){this._persistence=F.adapter.primaryStorage||e.persistence,this._storage=Zt(this._persistence,F.adapter);let n=`access_token_${e.env}`,s=`access_token_expire_${e.env}`,i=`refresh_token_${e.env}`,o=`anonymous_uuid_${e.env}`,r=`login_type_${e.env}`,a="device_id",l=`token_type_${e.env}`,c=`user_info_${e.env}`;this.keys={accessTokenKey:n,accessTokenExpireKey:s,refreshTokenKey:i,anonymousUuidKey:o,loginTypeKey:r,userInfoKey:c,deviceIdKey:a,tokenTypeKey:l}}}updatePersistence(e){if(e===this._persistence)return;let n=this._persistence==="local";this._persistence=e;let s=Zt(e,F.adapter);for(let i in this.keys){let o=this.keys[i];if(n&&si.includes(i))continue;let r=this._storage.getItem(o);ei(r)||ti(r)||(s.setItem(o,r),this._storage.removeItem(o))}this._storage=s}setStore(e,n,s){if(!this._storage)return;let i={version:s||"localCachev1",content:n},o=JSON.stringify(i);try{this._storage.setItem(e,o)}catch(r){throw r}}getStore(e,n){try{if(!this._storage)return}catch(i){return""}n=n||"localCachev1";let s=this._storage.getItem(e);return s&&s.indexOf(n)>=0?JSON.parse(s).content:""}removeStore(e){this._storage.removeItem(e)}},jn={},qn={};function fe(t){return jn[t]}var je=class{constructor(e,n){this.data=n||null,this.name=e}},gt=class extends je{constructor(e,n){super("error",{error:e,data:n}),this.error=e}},Dt=new class{constructor(){this._listeners={}}on(t,e){return function(n,s,i){i[n]=i[n]||[],i[n].push(s)}(t,e,this._listeners),this}off(t,e){return function(n,s,i){if(i&&i[n]){let o=i[n].indexOf(s);o!==-1&&i[n].splice(o,1)}}(t,e,this._listeners),this}fire(t,e){if(t instanceof gt)return console.error(t.error),this;let n=typeof t=="string"?new je(t,e||{}):t,s=n.name;if(this._listens(s)){n.target=this;let i=this._listeners[s]?[...this._listeners[s]]:[];for(let o of i)o.call(this,n)}return this}_listens(t){return this._listeners[t]&&this._listeners[t].length>0}};function Y(t,e){Dt.on(t,e)}function q(t,e={}){Dt.fire(t,e)}function ii(t,e){Dt.off(t,e)}var de="loginStateChanged",Kn="loginStateExpire",te="loginTypeChanged",pt="anonymousConverted",Hn="refreshAccessToken",D;(function(t){t.ANONYMOUS="ANONYMOUS",t.WECHAT="WECHAT",t.WECHAT_PUBLIC="WECHAT-PUBLIC",t.WECHAT_OPEN="WECHAT-OPEN",t.CUSTOM="CUSTOM",t.EMAIL="EMAIL",t.USERNAME="USERNAME",t.NULL="NULL"})(D||(D={}));var mt=class{constructor(){this._fnPromiseMap=new Map}run(e,n){return P(this,null,function*(){let s=this._fnPromiseMap.get(e);return s||(s=new Promise((i,o)=>P(this,null,function*(){try{yield this._runIdlePromise();let r=n();i(yield r)}catch(r){o(r)}finally{this._fnPromiseMap.delete(e)}})),this._fnPromiseMap.set(e,s)),s})}_runIdlePromise(){return Promise.resolve()}},yt=class{constructor(e){this._singlePromise=new mt,this._cache=fe(e.env),this._baseURL=`https://${e.env}.ap-shanghai.tcb-api.tencentcloudapi.com`,this._reqClass=new F.adapter.reqClass({timeout:e.timeout,timeoutMsg:`\u8BF7\u6C42\u5728${e.timeout/1e3}s\u5185\u672A\u5B8C\u6210\uFF0C\u5DF2\u4E2D\u65AD`,restrictedMethods:["post"]})}_getDeviceId(){if(this._deviceID)return this._deviceID;let{deviceIdKey:e}=this._cache.keys,n=this._cache.getStore(e);return typeof n=="string"&&n.length>=16&&n.length<=48||(n=Yt(),this._cache.setStore(e,n)),this._deviceID=n,n}_request(i,o){return P(this,arguments,function*(e,n,s={}){let r={"x-request-id":Yt(),"x-device-id":this._getDeviceId()};if(s.withAccessToken){let{tokenTypeKey:a}=this._cache.keys,l=yield this.getAccessToken(),c=this._cache.getStore(a);r.authorization=`${c} ${l}`}return this._reqClass[s.method==="get"?"get":"post"]({url:`${this._baseURL}${e}`,data:n,headers:r})})}_fetchAccessToken(){return P(this,null,function*(){let{loginTypeKey:e,accessTokenKey:n,accessTokenExpireKey:s,tokenTypeKey:i}=this._cache.keys,o=this._cache.getStore(e);if(o&&o!==D.ANONYMOUS)throw new C({code:"INVALID_OPERATION",message:"\u975E\u533F\u540D\u767B\u5F55\u4E0D\u652F\u6301\u5237\u65B0 access token"});let r=yield this._singlePromise.run("fetchAccessToken",()=>P(this,null,function*(){return(yield this._request("/auth/v1/signin/anonymously",{},{method:"post"})).data})),{access_token:a,expires_in:l,token_type:c}=r;return this._cache.setStore(i,c),this._cache.setStore(n,a),this._cache.setStore(s,Date.now()+1e3*l),a})}isAccessTokenExpired(e,n){let s=!0;return e&&n&&(s=n<Date.now()),s}getAccessToken(){return P(this,null,function*(){let{accessTokenKey:e,accessTokenExpireKey:n}=this._cache.keys,s=this._cache.getStore(e),i=this._cache.getStore(n);return this.isAccessTokenExpired(s,i)?this._fetchAccessToken():s})}refreshAccessToken(){return P(this,null,function*(){let{accessTokenKey:e,accessTokenExpireKey:n,loginTypeKey:s}=this._cache.keys;return this._cache.removeStore(e),this._cache.removeStore(n),this._cache.setStore(s,D.ANONYMOUS),this.getAccessToken()})}getUserInfo(){return P(this,null,function*(){return this._singlePromise.run("getUserInfo",()=>P(this,null,function*(){return(yield this._request("/auth/v1/user/me",{},{withAccessToken:!0,method:"get"})).data}))})}},en=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"],oi={"X-SDK-Version":"1.3.5"};function nt(t,e,n){let s=t[e];t[e]=function(i){let o={},r={};n.forEach(l=>{let{data:c,headers:g}=l.call(t,i);Object.assign(o,c),Object.assign(r,g)});let a=i.data;return a&&(()=>{var l;if(l=a,Object.prototype.toString.call(l)!=="[object FormData]")i.data=O(O({},a),o);else for(let c in o)a.append(c,o[c])})(),i.headers=O(O({},i.headers||{}),r),s.call(t,i)}}function st(){let t=Math.random().toString(16).slice(2);return{data:{seqId:t},headers:B(O({},oi),{"x-seqid":t})}}var _t=class{constructor(e={}){var n;this.config=e,this._reqClass=new F.adapter.reqClass({timeout:this.config.timeout,timeoutMsg:`\u8BF7\u6C42\u5728${this.config.timeout/1e3}s\u5185\u672A\u5B8C\u6210\uFF0C\u5DF2\u4E2D\u65AD`,restrictedMethods:["post"]}),this._cache=fe(this.config.env),this._localCache=(n=this.config.env,qn[n]),this.oauth=new yt(this.config),nt(this._reqClass,"post",[st]),nt(this._reqClass,"upload",[st]),nt(this._reqClass,"download",[st])}post(e){return P(this,null,function*(){return yield this._reqClass.post(e)})}upload(e){return P(this,null,function*(){return yield this._reqClass.upload(e)})}download(e){return P(this,null,function*(){return yield this._reqClass.download(e)})}refreshAccessToken(){return P(this,null,function*(){let e,n;this._refreshAccessTokenPromise||(this._refreshAccessTokenPromise=this._refreshAccessToken());try{e=yield this._refreshAccessTokenPromise}catch(s){n=s}if(this._refreshAccessTokenPromise=null,this._shouldRefreshAccessTokenHook=null,n)throw n;return e})}_refreshAccessToken(){return P(this,null,function*(){let{accessTokenKey:e,accessTokenExpireKey:n,refreshTokenKey:s,loginTypeKey:i,anonymousUuidKey:o}=this._cache.keys;this._cache.removeStore(e),this._cache.removeStore(n);let r=this._cache.getStore(s);if(!r)throw new C({message:"\u672A\u767B\u5F55CloudBase"});let a={refresh_token:r},l=yield this.request("auth.fetchAccessTokenWithRefreshToken",a);if(l.data.code){let{code:c}=l.data;if(c==="SIGN_PARAM_INVALID"||c==="REFRESH_TOKEN_EXPIRED"||c==="INVALID_REFRESH_TOKEN"){if(this._cache.getStore(i)===D.ANONYMOUS&&c==="INVALID_REFRESH_TOKEN"){let g=this._cache.getStore(o),d=this._cache.getStore(s),p=yield this.send("auth.signInAnonymously",{anonymous_uuid:g,refresh_token:d});return this.setRefreshToken(p.refresh_token),this._refreshAccessToken()}q(Kn),this._cache.removeStore(s)}throw new C({code:l.data.code,message:`\u5237\u65B0access token\u5931\u8D25\uFF1A${l.data.code}`})}if(l.data.access_token)return q(Hn),this._cache.setStore(e,l.data.access_token),this._cache.setStore(n,l.data.access_token_expire+Date.now()),{accessToken:l.data.access_token,accessTokenExpire:l.data.access_token_expire};l.data.refresh_token&&(this._cache.removeStore(s),this._cache.setStore(s,l.data.refresh_token),this._refreshAccessToken())})}getAccessToken(){return P(this,null,function*(){let{accessTokenKey:e,accessTokenExpireKey:n,refreshTokenKey:s}=this._cache.keys;if(!this._cache.getStore(s))throw new C({message:"refresh token\u4E0D\u5B58\u5728\uFF0C\u767B\u5F55\u72B6\u6001\u5F02\u5E38"});let i=this._cache.getStore(e),o=this._cache.getStore(n),r=!0;return this._shouldRefreshAccessTokenHook&&!(yield this._shouldRefreshAccessTokenHook(i,o))&&(r=!1),(!i||!o||o<Date.now())&&r?this.refreshAccessToken():{accessToken:i,accessTokenExpire:o}})}request(e,n,s){return P(this,null,function*(){let i=`x-tcb-trace_${this.config.env}`,o="application/x-www-form-urlencoded",r=O({action:e,env:this.config.env,dataVersion:"2019-08-16"},n),a;if(en.indexOf(e)===-1&&(this._cache.keys,r.access_token=yield this.oauth.getAccessToken()),e==="storage.uploadFile"){a=new FormData;for(let m in a)a.hasOwnProperty(m)&&a[m]!==void 0&&a.append(m,r[m]);o="multipart/form-data"}else{o="application/json",a={};for(let m in r)r[m]!==void 0&&(a[m]=r[m])}let l={headers:{"content-type":o}};s&&s.timeout&&(l.timeout=s.timeout),s&&s.onUploadProgress&&(l.onUploadProgress=s.onUploadProgress);let c=this._localCache.getStore(i);c&&(l.headers["X-TCB-Trace"]=c);let{parse:g,inQuery:d,search:p}=n,y={env:this.config.env};g&&(y.parse=!0),d&&(y=O(O({},d),y));let w=function(m,_,b={}){let S=/\?/.test(_),I="";for(let A in b)I===""?!S&&(_+="?"):I+="&",I+=`${A}=${encodeURIComponent(b[A])}`;return/^http(s)?\:\/\//.test(_+=I)?_:`${m}${_}`}(Ys,"//tcb-api.tencentcloudapi.com/web",y);p&&(w+=p);let f=yield this.post(O({url:w,data:a},l)),h=f.header&&f.header["x-tcb-trace"];if(h&&this._localCache.setStore(i,h),Number(f.status)!==200&&Number(f.statusCode)!==200||!f.data)throw new C({code:"NETWORK_ERROR",message:"network request error"});return f})}send(i){return P(this,arguments,function*(e,n={},s={}){let o=yield this.request(e,n,B(O({},s),{onUploadProgress:n.onUploadProgress}));if((o.data.code==="ACCESS_TOKEN_DISABLED"||o.data.code==="ACCESS_TOKEN_EXPIRED")&&en.indexOf(e)===-1){yield this.oauth.refreshAccessToken();let r=yield this.request(e,n,B(O({},s),{onUploadProgress:n.onUploadProgress}));if(r.data.code)throw new C({code:r.data.code,message:Qt(r.data.message)});return r.data}if(o.data.code)throw new C({code:o.data.code,message:Qt(o.data.message)});return o.data})}setRefreshToken(e){let{accessTokenKey:n,accessTokenExpireKey:s,refreshTokenKey:i}=this._cache.keys;this._cache.removeStore(n),this._cache.removeStore(s),this._cache.setStore(i,e)}},zn={};function W(t){return zn[t]}var he=class{constructor(e){this.config=e,this._cache=fe(e.env),this._request=W(e.env)}setRefreshToken(e){let{accessTokenKey:n,accessTokenExpireKey:s,refreshTokenKey:i}=this._cache.keys;this._cache.removeStore(n),this._cache.removeStore(s),this._cache.setStore(i,e)}setAccessToken(e,n){let{accessTokenKey:s,accessTokenExpireKey:i}=this._cache.keys;this._cache.setStore(s,e),this._cache.setStore(i,n)}refreshUserInfo(){return P(this,null,function*(){let{data:e}=yield this._request.send("auth.getUserInfo",{});return this.setLocalUserInfo(e),e})}setLocalUserInfo(e){let{userInfoKey:n}=this._cache.keys;this._cache.setStore(n,e)}},wt=class{constructor(e){if(!e)throw new C({code:"PARAM_ERROR",message:"envId is not defined"});this._envId=e,this._cache=fe(this._envId),this._request=W(this._envId),this.setUserInfo()}linkWithTicket(e){if(typeof e!="string")throw new C({code:"PARAM_ERROR",message:"ticket must be string"});return this._request.send("auth.linkWithTicket",{ticket:e})}linkWithRedirect(e){e.signInWithRedirect()}updatePassword(e,n){return this._request.send("auth.updatePassword",{oldPassword:n,newPassword:e})}updateEmail(e){return this._request.send("auth.updateEmail",{newEmail:e})}updateUsername(e){if(typeof e!="string")throw new C({code:"PARAM_ERROR",message:"username must be a string"});return this._request.send("auth.updateUsername",{username:e})}getLinkedUidList(){return P(this,null,function*(){let{data:e}=yield this._request.send("auth.getLinkedUidList",{}),n=!1,{users:s}=e;return s.forEach(i=>{i.wxOpenId&&i.wxPublicId&&(n=!0)}),{users:s,hasPrimaryUid:n}})}setPrimaryUid(e){return this._request.send("auth.setPrimaryUid",{uid:e})}unlink(e){return this._request.send("auth.unlink",{platform:e})}update(e){return P(this,null,function*(){let{nickName:n,gender:s,avatarUrl:i,province:o,country:r,city:a}=e,{data:l}=yield this._request.send("auth.updateUserInfo",{nickName:n,gender:s,avatarUrl:i,province:o,country:r,city:a});this.setLocalUserInfo(l)})}refresh(){return P(this,null,function*(){let e=yield this._request.oauth.getUserInfo();return this.setLocalUserInfo(e),e})}setUserInfo(){let{userInfoKey:e}=this._cache.keys,n=this._cache.getStore(e);["uid","loginType","openid","wxOpenId","wxPublicId","unionId","qqMiniOpenId","email","hasPassword","customUserId","nickName","gender","avatarUrl"].forEach(s=>{this[s]=n[s]}),this.location={country:n.country,province:n.province,city:n.city}}setLocalUserInfo(e){let{userInfoKey:n}=this._cache.keys;this._cache.setStore(n,e),this.setUserInfo()}},re=class{constructor(e){if(!e)throw new C({code:"PARAM_ERROR",message:"envId is not defined"});this._cache=fe(e);let{refreshTokenKey:n,accessTokenKey:s,accessTokenExpireKey:i}=this._cache.keys,o=this._cache.getStore(n),r=this._cache.getStore(s),a=this._cache.getStore(i);this.credential={refreshToken:o,accessToken:r,accessTokenExpire:a},this.user=new wt(e)}get isAnonymousAuth(){return this.loginType===D.ANONYMOUS}get isCustomAuth(){return this.loginType===D.CUSTOM}get isWeixinAuth(){return this.loginType===D.WECHAT||this.loginType===D.WECHAT_OPEN||this.loginType===D.WECHAT_PUBLIC}get loginType(){return this._cache.getStore(this._cache.keys.loginTypeKey)}},_e=class extends he{signIn(){return P(this,null,function*(){this._cache.updatePersistence("local"),yield this._request.oauth.getAccessToken(),q(de),q(te,{env:this.config.env,loginType:D.ANONYMOUS,persistence:"local"});let e=new re(this.config.env);return yield e.user.refresh(),e})}linkAndRetrieveDataWithTicket(e){return P(this,null,function*(){let{anonymousUuidKey:n,refreshTokenKey:s}=this._cache.keys,i=this._cache.getStore(n),o=this._cache.getStore(s),r=yield this._request.send("auth.linkAndRetrieveDataWithTicket",{anonymous_uuid:i,refresh_token:o,ticket:e});if(r.refresh_token)return this._clearAnonymousUUID(),this.setRefreshToken(r.refresh_token),yield this._request.refreshAccessToken(),q(pt,{env:this.config.env}),q(te,{loginType:D.CUSTOM,persistence:"local"}),{credential:{refreshToken:r.refresh_token}};throw new C({message:"\u533F\u540D\u8F6C\u5316\u5931\u8D25"})})}_setAnonymousUUID(e){let{anonymousUuidKey:n,loginTypeKey:s}=this._cache.keys;this._cache.removeStore(n),this._cache.setStore(n,e),this._cache.setStore(s,D.ANONYMOUS)}_clearAnonymousUUID(){this._cache.removeStore(this._cache.keys.anonymousUuidKey)}},qe=class extends he{signIn(e){return P(this,null,function*(){if(typeof e!="string")throw new C({code:"PARAM_ERROR",message:"ticket must be a string"});let{refreshTokenKey:n}=this._cache.keys,s=yield this._request.send("auth.signInWithTicket",{ticket:e,refresh_token:this._cache.getStore(n)||""});if(s.refresh_token)return this.setRefreshToken(s.refresh_token),yield this._request.refreshAccessToken(),q(de),q(te,{env:this.config.env,loginType:D.CUSTOM,persistence:this.config.persistence}),yield this.refreshUserInfo(),new re(this.config.env);throw new C({message:"\u81EA\u5B9A\u4E49\u767B\u5F55\u5931\u8D25"})})}},Ke=class extends he{signIn(e,n){return P(this,null,function*(){if(typeof e!="string")throw new C({code:"PARAM_ERROR",message:"email must be a string"});let{refreshTokenKey:s}=this._cache.keys,i=yield this._request.send("auth.signIn",{loginType:"EMAIL",email:e,password:n,refresh_token:this._cache.getStore(s)||""}),{refresh_token:o,access_token:r,access_token_expire:a}=i;if(o)return this.setRefreshToken(o),r&&a?this.setAccessToken(r,a):yield this._request.refreshAccessToken(),yield this.refreshUserInfo(),q(de),q(te,{env:this.config.env,loginType:D.EMAIL,persistence:this.config.persistence}),new re(this.config.env);throw i.code?new C({code:i.code,message:`\u90AE\u7BB1\u767B\u5F55\u5931\u8D25: ${i.message}`}):new C({message:"\u90AE\u7BB1\u767B\u5F55\u5931\u8D25"})})}activate(e){return P(this,null,function*(){return this._request.send("auth.activateEndUserMail",{token:e})})}resetPasswordWithToken(e,n){return P(this,null,function*(){return this._request.send("auth.resetPasswordWithToken",{token:e,newPassword:n})})}},He=class extends he{signIn(e,n){return P(this,null,function*(){if(typeof e!="string")throw new C({code:"PARAM_ERROR",message:"username must be a string"});typeof n!="string"&&(n="",console.warn("password is empty"));let{refreshTokenKey:s}=this._cache.keys,i=yield this._request.send("auth.signIn",{loginType:D.USERNAME,username:e,password:n,refresh_token:this._cache.getStore(s)||""}),{refresh_token:o,access_token_expire:r,access_token:a}=i;if(o)return this.setRefreshToken(o),a&&r?this.setAccessToken(a,r):yield this._request.refreshAccessToken(),yield this.refreshUserInfo(),q(de),q(te,{env:this.config.env,loginType:D.USERNAME,persistence:this.config.persistence}),new re(this.config.env);throw i.code?new C({code:i.code,message:`\u7528\u6237\u540D\u5BC6\u7801\u767B\u5F55\u5931\u8D25: ${i.message}`}):new C({message:"\u7528\u6237\u540D\u5BC6\u7801\u767B\u5F55\u5931\u8D25"})})}},bt=class{constructor(e){this.config=e,this._cache=fe(e.env),this._request=W(e.env),this._onAnonymousConverted=this._onAnonymousConverted.bind(this),this._onLoginTypeChanged=this._onLoginTypeChanged.bind(this),Y(te,this._onLoginTypeChanged)}get currentUser(){let e=this.hasLoginState();return e&&e.user||null}get loginType(){return this._cache.getStore(this._cache.keys.loginTypeKey)}anonymousAuthProvider(){return new _e(this.config)}customAuthProvider(){return new qe(this.config)}emailAuthProvider(){return new Ke(this.config)}usernameAuthProvider(){return new He(this.config)}signInAnonymously(){return P(this,null,function*(){return new _e(this.config).signIn()})}signInWithEmailAndPassword(e,n){return P(this,null,function*(){return new Ke(this.config).signIn(e,n)})}signInWithUsernameAndPassword(e,n){return new He(this.config).signIn(e,n)}linkAndRetrieveDataWithTicket(e){return P(this,null,function*(){return this._anonymousAuthProvider||(this._anonymousAuthProvider=new _e(this.config)),Y(pt,this._onAnonymousConverted),yield this._anonymousAuthProvider.linkAndRetrieveDataWithTicket(e)})}signOut(){return P(this,null,function*(){if(this.loginType===D.ANONYMOUS)throw new C({message:"\u533F\u540D\u7528\u6237\u4E0D\u652F\u6301\u767B\u51FA\u64CD\u4F5C"});let{refreshTokenKey:e,accessTokenKey:n,accessTokenExpireKey:s}=this._cache.keys,i=this._cache.getStore(e);if(!i)return;let o=yield this._request.send("auth.logout",{refresh_token:i});return this._cache.removeStore(e),this._cache.removeStore(n),this._cache.removeStore(s),q(de),q(te,{env:this.config.env,loginType:D.NULL,persistence:this.config.persistence}),o})}signUpWithEmailAndPassword(e,n){return P(this,null,function*(){return this._request.send("auth.signUpWithEmailAndPassword",{email:e,password:n})})}sendPasswordResetEmail(e){return P(this,null,function*(){return this._request.send("auth.sendPasswordResetEmail",{email:e})})}onLoginStateChanged(e){Y(de,()=>{let s=this.hasLoginState();e.call(this,s)});let n=this.hasLoginState();e.call(this,n)}onLoginStateExpired(e){Y(Kn,e.bind(this))}onAccessTokenRefreshed(e){Y(Hn,e.bind(this))}onAnonymousConverted(e){Y(pt,e.bind(this))}onLoginTypeChanged(e){Y(te,()=>{let n=this.hasLoginState();e.call(this,n)})}getAccessToken(){return P(this,null,function*(){return{accessToken:(yield this._request.getAccessToken()).accessToken,env:this.config.env}})}hasLoginState(){let{accessTokenKey:e,accessTokenExpireKey:n}=this._cache.keys,s=this._cache.getStore(e),i=this._cache.getStore(n);return this._request.oauth.isAccessTokenExpired(s,i)?null:new re(this.config.env)}isUsernameRegistered(e){return P(this,null,function*(){if(typeof e!="string")throw new C({code:"PARAM_ERROR",message:"username must be a string"});let{data:n}=yield this._request.send("auth.isUsernameRegistered",{username:e});return n&&n.isRegistered})}getLoginState(){return Promise.resolve(this.hasLoginState())}signInWithTicket(e){return P(this,null,function*(){return new qe(this.config).signIn(e)})}shouldRefreshAccessToken(e){this._request._shouldRefreshAccessTokenHook=e.bind(this)}getUserInfo(){return this._request.send("auth.getUserInfo",{}).then(e=>e.code?e:B(O({},e.data),{requestId:e.seqId}))}getAuthHeader(){let{refreshTokenKey:e,accessTokenKey:n}=this._cache.keys,s=this._cache.getStore(e);return{"x-cloudbase-credentials":this._cache.getStore(n)+"/@@/"+s}}_onAnonymousConverted(e){let{env:n}=e.data;n===this.config.env&&this._cache.updatePersistence(this.config.persistence)}_onLoginTypeChanged(e){let{loginType:n,persistence:s,env:i}=e.data;i===this.config.env&&(this._cache.updatePersistence(s),this._cache.setStore(this._cache.keys.loginTypeKey,n))}},ri=function(t,e){e=e||Ie();let n=W(this.config.env),{cloudPath:s,filePath:i,onUploadProgress:o,fileType:r="image"}=t;return n.send("storage.getUploadMetadata",{path:s}).then(a=>{let{data:{url:l,authorization:c,token:g,fileId:d,cosFileId:p},requestId:y}=a,w={key:s,signature:c,"x-cos-meta-fileid":p,success_action_status:"201","x-cos-security-token":g};n.upload({url:l,data:w,file:i,name:s,fileType:r,onUploadProgress:o}).then(f=>{f.statusCode===201?e(null,{fileID:d,requestId:y}):e(new C({code:"STORAGE_REQUEST_FAIL",message:`STORAGE_REQUEST_FAIL: ${f.data}`}))}).catch(f=>{e(f)})}).catch(a=>{e(a)}),e.promise},ai=function(t,e){e=e||Ie();let n=W(this.config.env),{cloudPath:s}=t;return n.send("storage.getUploadMetadata",{path:s}).then(i=>{e(null,i)}).catch(i=>{e(i)}),e.promise},ci=function({fileList:t},e){if(e=e||Ie(),!t||!Array.isArray(t))return{code:"INVALID_PARAM",message:"fileList\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u6570\u7EC4"};for(let s of t)if(!s||typeof s!="string")return{code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u5B57\u7B26\u4E32"};let n={fileid_list:t};return W(this.config.env).send("storage.batchDeleteFile",n).then(s=>{s.code?e(null,s):e(null,{fileList:s.data.delete_list,requestId:s.requestId})}).catch(s=>{e(s)}),e.promise},$n=function({fileList:t},e){e=e||Ie(),t&&Array.isArray(t)||e(null,{code:"INVALID_PARAM",message:"fileList\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u6570\u7EC4"});let n=[];for(let i of t)typeof i=="object"?(i.hasOwnProperty("fileID")&&i.hasOwnProperty("maxAge")||e(null,{code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u5305\u542BfileID\u548CmaxAge\u7684\u5BF9\u8C61"}),n.push({fileid:i.fileID,max_age:i.maxAge})):typeof i=="string"?n.push({fileid:i}):e(null,{code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u5B57\u7B26\u4E32"});let s={file_list:n};return W(this.config.env).send("storage.batchGetDownloadUrl",s).then(i=>{i.code?e(null,i):e(null,{fileList:i.data.download_list,requestId:i.requestId})}).catch(i=>{e(i)}),e.promise},li=function(n,s){return P(this,arguments,function*({fileID:t},e){let i=(yield $n.call(this,{fileList:[{fileID:t,maxAge:600}]})).fileList[0];if(i.code!=="SUCCESS")return e?e(i):new Promise(a=>{a(i)});let o=W(this.config.env),r=i.download_url;if(r=encodeURI(r),!e)return o.download({url:r});e(yield o.download({url:r}))})},ui=function({name:t,data:e,query:n,parse:s,search:i,timeout:o},r){let a=r||Ie(),l;try{l=e?JSON.stringify(e):""}catch(g){return Promise.reject(g)}if(!t)return Promise.reject(new C({code:"PARAM_ERROR",message:"\u51FD\u6570\u540D\u4E0D\u80FD\u4E3A\u7A7A"}));let c={inQuery:n,parse:s,search:i,function_name:t,request_data:l};return W(this.config.env).send("functions.invokeFunction",c,{timeout:o}).then(g=>{if(g.code)a(null,g);else{let d=g.data.response_data;if(s)a(null,{result:d,requestId:g.requestId});else try{d=JSON.parse(g.data.response_data),a(null,{result:d,requestId:g.requestId})}catch(p){a(new C({message:"response data must be json"}))}}return a.promise}).catch(g=>{a(g)}),a.promise},tn={timeout:15e3,persistence:"session"},nn=6e5,sn={},St=class t{constructor(e){this.config=e||this.config,this.authObj=void 0}init(e){switch(F.adapter||(this.requestClient=new F.adapter.reqClass({timeout:e.timeout||5e3,timeoutMsg:`\u8BF7\u6C42\u5728${(e.timeout||5e3)/1e3}s\u5185\u672A\u5B8C\u6210\uFF0C\u5DF2\u4E2D\u65AD`})),this.config=O(O({},tn),e),!0){case this.config.timeout>nn:console.warn("timeout\u5927\u4E8E\u53EF\u914D\u7F6E\u4E0A\u9650[10\u5206\u949F]\uFF0C\u5DF2\u91CD\u7F6E\u4E3A\u4E0A\u9650\u6570\u503C"),this.config.timeout=nn;break;case this.config.timeout<100:console.warn("timeout\u5C0F\u4E8E\u53EF\u914D\u7F6E\u4E0B\u9650[100ms]\uFF0C\u5DF2\u91CD\u7F6E\u4E3A\u4E0B\u9650\u6570\u503C"),this.config.timeout=100}return new t(this.config)}auth({persistence:e}={}){if(this.authObj)return this.authObj;let n=e||F.adapter.primaryStorage||tn.persistence;var s;return n!==this.config.persistence&&(this.config.persistence=n),function(i){let{env:o}=i;jn[o]=new Me(i),qn[o]=new Me(B(O({},i),{persistence:"local"}))}(this.config),s=this.config,zn[s.env]=new _t(s),this.authObj=new bt(this.config),this.authObj}on(e,n){return Y.apply(this,[e,n])}off(e,n){return ii.apply(this,[e,n])}callFunction(e,n){return ui.apply(this,[e,n])}deleteFile(e,n){return ci.apply(this,[e,n])}getTempFileURL(e,n){return $n.apply(this,[e,n])}downloadFile(e,n){return li.apply(this,[e,n])}uploadFile(e,n){return ri.apply(this,[e,n])}getUploadMetadata(e,n){return ai.apply(this,[e,n])}registerExtension(e){sn[e.name]=e}invokeExtension(e,n){return P(this,null,function*(){let s=sn[e];if(!s)throw new C({message:`\u6269\u5C55${e} \u5FC5\u987B\u5148\u6CE8\u518C`});return yield s.invoke(n,this)})}useAdapters(e){let{adapter:n,runtime:s}=ni(e)||{};n&&(F.adapter=n),s&&(F.runtime=s)}},Vn=new St;function it(t,e,n){n===void 0&&(n={});var s=/\?/.test(e),i="";for(var o in n)i===""?!s&&(e+="?"):i+="&",i+=o+"="+encodeURIComponent(n[o]);return/^http(s)?:\/\//.test(e+=i)?e:""+t+e}var vt=class{get(e){let{url:n,data:s,headers:i,timeout:o}=e;return new Promise((r,a)=>{N.request({url:it("https:",n),data:s,method:"GET",header:i,timeout:o,success(l){r(l)},fail(l){a(l)}})})}post(e){let{url:n,data:s,headers:i,timeout:o}=e;return new Promise((r,a)=>{N.request({url:it("https:",n),data:s,method:"POST",header:i,timeout:o,success(l){r(l)},fail(l){a(l)}})})}upload(e){return new Promise((n,s)=>{let{url:i,file:o,data:r,headers:a,fileType:l}=e,c=N.uploadFile({url:it("https:",i),name:"file",formData:Object.assign({},r),filePath:o,fileType:l,header:a,success(g){let d={statusCode:g.statusCode,data:g.data||{}};g.statusCode===200&&r.success_action_status&&(d.statusCode=parseInt(r.success_action_status,10)),n(d)},fail(g){s(new Error(g.errMsg||"uploadFile:fail"))}});typeof e.onUploadProgress=="function"&&c&&typeof c.onProgressUpdate=="function"&&c.onProgressUpdate(g=>{e.onUploadProgress({loaded:g.totalBytesSent,total:g.totalBytesExpectedToSend})})})}},di={setItem(t,e){N.setStorageSync(t,e)},getItem:t=>N.getStorageSync(t),removeItem(t){N.removeStorageSync(t)},clear(){N.clearStorageSync()}},hi={genAdapter:function(){return{root:{},reqClass:vt,localStorage:di,primaryStorage:"local"}},isMatch:function(){return!0},runtime:"uni_app"};Vn.useAdapters(hi);var Nt=Vn,fi=Nt.init;Nt.init=function(t){t.env=t.spaceId;let e=fi.call(this,t);e.config.provider="tencent",e.config.spaceId=t.spaceId;let n=e.auth;return e.auth=function(s){let i=n.call(this,s);return["linkAndRetrieveDataWithTicket","signInAnonymously","signOut","getAccessToken","getLoginState","signInWithTicket","getUserInfo"].forEach(o=>{var r;i[o]=(r=i[o],function(a){a=a||{};let{success:l,fail:c,complete:g}=Nn(a);if(!(l||c||g))return r.call(this,a);r.call(this,a).then(d=>{l&&l(d),g&&g(d)},d=>{c&&c(d),g&&g(d)})}).bind(i)}),i},e.customAuth=e.auth,e};var on=Nt;function gi(t,e){return P(this,null,function*(){let n=`http://${t}:${e}/system/ping`;try{let i=yield(s={url:n,timeout:500},new Promise((o,r)=>{N.request(B(O({},s),{success(a){o(a)},fail(a){r(a)}}))}));return!(!i.data||i.data.code!==0)}catch(i){return!1}var s})}function pi(t,e){return P(this,null,function*(){let n;for(let s=0;s<t.length;s++){let i=t[s];if(yield gi(i,e)){n=i;break}}return{address:n,port:e}})}var mi={"serverless.file.resource.generateProximalSign":"storage/generate-proximal-sign","serverless.file.resource.report":"storage/report","serverless.file.resource.delete":"storage/delete","serverless.file.resource.getTempFileURL":"storage/get-temp-file-url"},yi=class{constructor(t){if(["spaceId","clientSecret"].forEach(e=>{if(!Object.prototype.hasOwnProperty.call(t,e))throw new Error(`${e} required`)}),!t.endpoint)throw new Error("\u96C6\u7FA4\u7A7A\u95F4\u672A\u914D\u7F6EApiEndpoint\uFF0C\u914D\u7F6E\u540E\u9700\u8981\u91CD\u65B0\u5173\u8054\u670D\u52A1\u7A7A\u95F4\u540E\u751F\u6548");this.config=Object.assign({},t),this.config.provider="dcloud",this.config.requestUrl=this.config.endpoint+"/client",this.config.envType=this.config.envType||"public",this.adapter=N}request(t,e=!0){return P(this,null,function*(){return t=this.setupRequest(t),Promise.resolve().then(()=>ce.wrappedRequest(t,this.adapter.request))})}requestLocal(t){return new Promise((e,n)=>{this.adapter.request(Object.assign(t,{complete(s){if(s||(s={}),!s.statusCode||s.statusCode>=400){let i=s.data&&s.data.code||"SYS_ERR",o=s.data&&s.data.message||"request:fail";return n(new C({code:i,message:o}))}e({success:!0,result:s.data})}}))})}setupRequest(t){let e=Object.assign({},t,{spaceId:this.config.spaceId,timestamp:Date.now()}),n={"Content-Type":"application/json"};n["x-serverless-sign"]=ce.sign(e,this.config.clientSecret);let s=ht();n["x-client-info"]=encodeURIComponent(JSON.stringify(s));let{token:i}=Se();return n["x-client-token"]=i,{url:this.config.requestUrl,method:"POST",data:e,dataType:"json",header:JSON.parse(JSON.stringify(n))}}setupLocalRequest(t){return P(this,null,function*(){let e=ht(),{token:n}=Se(),s=Object.assign({},t,{spaceId:this.config.spaceId,timestamp:Date.now(),clientInfo:e,token:n}),{address:i,servePort:o}=this.__dev__&&this.__dev__.debugInfo||{},{address:r}=yield pi(i,o);return{url:`http://${r}:${o}/${mi[t.method]}`,method:"POST",data:s,dataType:"json",header:JSON.parse(JSON.stringify({"Content-Type":"application/json"}))}})}callFunction(t){let e={method:"serverless.function.runtime.invoke",params:JSON.stringify({functionTarget:t.name,functionArgs:t.data||{}})};return this.request(e,!1)}getUploadFileOptions(t){let e={method:"serverless.file.resource.generateProximalSign",params:JSON.stringify(t)};return this.request(e)}reportUploadFile(t){let e={method:"serverless.file.resource.report",params:JSON.stringify(t)};return this.request(e)}uploadFile({filePath:t,cloudPath:e,fileType:n="image",onUploadProgress:s}){if(!e)throw new C({code:"CLOUDPATH_REQUIRED",message:"cloudPath\u4E0D\u53EF\u4E3A\u7A7A"});let i;return this.getUploadFileOptions({cloudPath:e}).then(o=>{let{url:r,formData:a,name:l}=o.result;return i=o.result.fileUrl,new Promise((c,g)=>{let d=this.adapter.uploadFile({url:r,formData:a,name:l,filePath:t,fileType:n,success(p){p&&p.statusCode<400?c(p):g(new C({code:"UPLOAD_FAILED",message:"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))},fail(p){g(new C({code:p.code||"UPLOAD_FAILED",message:p.message||p.errMsg||"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))}});typeof s=="function"&&d&&typeof d.onProgressUpdate=="function"&&d.onProgressUpdate(p=>{s({loaded:p.totalBytesSent,total:p.totalBytesExpectedToSend})})})}).then(()=>this.reportUploadFile({cloudPath:e})).then(o=>new Promise((r,a)=>{o.success?r({success:!0,filePath:t,fileID:i}):a(new C({code:"UPLOAD_FAILED",message:"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))}))}deleteFile({fileList:t}){let e={method:"serverless.file.resource.delete",params:JSON.stringify({fileList:t})};return this.request(e).then(n=>{if(n.success)return n.result;throw new C({code:"DELETE_FILE_FAILED",message:"\u5220\u9664\u6587\u4EF6\u5931\u8D25"})})}getTempFileURL({fileList:t,maxAge:e}={}){if(!Array.isArray(t)||t.length===0)throw new C({code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u5B57\u7B26\u4E32"});let n={method:"serverless.file.resource.getTempFileURL",params:JSON.stringify({fileList:t,maxAge:e})};return this.request(n).then(s=>{if(s.success)return{fileList:s.result.fileList.map(i=>({fileID:i.fileID,tempFileURL:i.tempFileURL}))};throw new C({code:"GET_TEMP_FILE_URL_FAILED",message:"\u83B7\u53D6\u4E34\u65F6\u6587\u4EF6\u94FE\u63A5\u5931\u8D25"})})}},rn={init(t){let e=new yi(t),n={signInAnonymously:function(){return Promise.resolve()},getLoginState:function(){return Promise.resolve(!1)}};return e.auth=function(){return n},e.customAuth=e.auth,e}},we=V(function(t,e){t.exports=ee.enc.Hex});function Wn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return(t==="x"?e:3&e|8).toString(16)})}function Jn(t="",e={}){let{data:n,functionName:s,method:i,headers:o,signHeaderKeys:r=[],config:a}=e,l=String(Date.now()),c=Wn(),g=Object.assign({},o,{"x-from-app-id":a.spaceAppId,"x-from-env-id":a.spaceId,"x-to-env-id":a.spaceId,"x-from-instance-id":l,"x-from-function-name":s,"x-client-timestamp":l,"x-alipay-source":"client","x-request-id":c,"x-alipay-callid":c,"x-trace-id":c}),d=["x-from-app-id","x-from-env-id","x-to-env-id","x-from-instance-id","x-from-function-name","x-client-timestamp"].concat(r),[p="",y=""]=t.split("?")||[],w=function(f){let h="HMAC-SHA256",m=f.signedHeaders.join(";"),_=f.signedHeaders.map(L=>`${L.toLowerCase()}:${f.headers[L]}
`).join(""),b=ft(f.body).toString(we),S=`${f.method.toUpperCase()}
${f.path}
${f.query}
${_}
${m}
${b}
`,I=ft(S).toString(we),A=`${h}
${f.timestamp}
${I}
`,E=Mn(A,f.secretKey).toString(we);return`${h} Credential=${f.secretId}, SignedHeaders=${m}, Signature=${E}`}({path:p,query:y,method:i,headers:g,timestamp:l,body:JSON.stringify(n),secretId:a.accessKey,secretKey:a.secretKey,signedHeaders:d.sort()});return{url:`${a.endpoint}${t}`,headers:Object.assign({},g,{Authorization:w})}}function Gn({url:t,data:e,method:n="POST",headers:s={},timeout:i}){return new Promise((o,r)=>{N.request({url:t,method:n,data:typeof e=="object"?JSON.stringify(e):e,header:s,dataType:"json",timeout:i,complete:(a={})=>{let l=s["x-trace-id"]||"";if(!a.statusCode||a.statusCode>=400){let{message:c,errMsg:g,trace_id:d}=a.data||{};return r(new C({code:"SYS_ERR",message:c||g||"request:fail",requestId:d||l}))}o({status:a.statusCode,data:a.data,headers:a.header,requestId:l})}})})}function an(t,e){let{path:n,data:s,method:i="GET"}=t,{url:o,headers:r}=Jn(n,{functionName:"",data:s,method:i,headers:{"x-alipay-cloud-mode":"oss","x-data-api-type":"oss","x-expire-timestamp":Date.now()+6e4},signHeaderKeys:["x-data-api-type","x-expire-timestamp"],config:e});return Gn({url:o,data:s,method:i,headers:r}).then(a=>{let l=a.data||{};if(!l.success)throw new C({code:a.errCode,message:a.errMsg,requestId:a.requestId});return l.data||{}}).catch(a=>{throw new C({code:a.errCode,message:a.errMsg,requestId:a.requestId})})}function _i(t=""){let e=t.trim().replace(/^cloud:\/\//,""),n=e.indexOf("/");if(n<=0)throw new C({code:"INVALID_PARAM",message:"fileID\u4E0D\u5408\u6CD5"});let s=e.substring(0,n),i=e.substring(n+1);return s!==this.config.spaceId&&console.warn("file ".concat(t," does not belong to env ").concat(this.config.spaceId)),i}function wi(t=""){return"cloud://".concat(this.config.spaceId,"/").concat(t.replace(/^\/+/,""))}var xt=class{constructor(e){this.config=e}signedURL(e,n={}){let s=`/ws/function/${e}`,i=this.config.wsEndpoint.replace(/^ws(s)?:\/\//,""),o=Object.assign({},n,{accessKeyId:this.config.accessKey,signatureNonce:Wn(),timestamp:""+Date.now()}),r=[s,["accessKeyId","authorization","signatureNonce","timestamp"].sort().map(function(g){return o[g]?"".concat(g,"=").concat(o[g]):null}).filter(Boolean).join("&"),`host:${i}`].join(`
`),a=["HMAC-SHA256",ft(r).toString(we)].join(`
`),l=Mn(a,this.config.secretKey).toString(we),c=Object.keys(o).map(g=>`${g}=${encodeURIComponent(o[g])}`).join("&");return`${this.config.wsEndpoint}${s}?${c}&signature=${l}`}},bi=class{constructor(t){if(["spaceId","spaceAppId","accessKey","secretKey"].forEach(e=>{if(!Object.prototype.hasOwnProperty.call(t,e))throw new Error(`${e} required`)}),t.endpoint){if(typeof t.endpoint!="string")throw new Error("endpoint must be string");if(!/^https:\/\//.test(t.endpoint))throw new Error("endpoint must start with https://");t.endpoint=t.endpoint.replace(/\/$/,"")}this.config=Object.assign({},t,{endpoint:t.endpoint||`https://${t.spaceId}.api-hz.cloudbasefunction.cn`,wsEndpoint:t.wsEndpoint||`wss://${t.spaceId}.api-hz.cloudbasefunction.cn`}),this._websocket=new xt(this.config)}callFunction(t){return function(e,n){let{name:s,data:i,async:o=!1,timeout:r}=e,a="POST",l={"x-to-function-name":s};o&&(l["x-function-invoke-type"]="async");let{url:c,headers:g}=Jn("/functions/invokeFunction",{functionName:s,data:i,method:a,headers:l,signHeaderKeys:["x-to-function-name"],config:n});return Gn({url:c,data:i,method:a,headers:g,timeout:r}).then(d=>{let p=0;if(o){let y=d.data||{};p=y.errCode==="200"?0:y.errCode,d.data=y.data||{},d.errMsg=y.errMsg}if(p!==0)throw new C({code:p,message:d.errMsg,requestId:d.requestId});return{errCode:p,success:p===0,requestId:d.requestId,result:d.data}}).catch(d=>{throw new C({code:d.errCode,message:d.errMsg,requestId:d.requestId})})}(t,this.config)}uploadFileToOSS({url:t,filePath:e,fileType:n,formData:s,onUploadProgress:i}){return new Promise((o,r)=>{let a=N.uploadFile({url:t,filePath:e,fileType:n,formData:s,name:"file",success(l){l&&l.statusCode<400?o(l):r(new C({code:"UPLOAD_FAILED",message:"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))},fail(l){r(new C({code:l.code||"UPLOAD_FAILED",message:l.message||l.errMsg||"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))}});typeof i=="function"&&a&&typeof a.onProgressUpdate=="function"&&a.onProgressUpdate(l=>{i({loaded:l.totalBytesSent,total:l.totalBytesExpectedToSend})})})}uploadFile(i){return P(this,arguments,function*({filePath:t,cloudPath:e="",fileType:n="image",onUploadProgress:s}){if(be(e)!=="string")throw new C({code:"INVALID_PARAM",message:"cloudPath\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32\u7C7B\u578B"});if(!(e=e.trim()))throw new C({code:"INVALID_PARAM",message:"cloudPath\u4E0D\u53EF\u4E3A\u7A7A"});if(/:\/\//.test(e))throw new C({code:"INVALID_PARAM",message:"cloudPath\u4E0D\u5408\u6CD5"});let o=yield an({path:"/".concat(e.replace(/^\//,""),"?post_url")},this.config),{file_id:r,upload_url:a,form_data:l}=o,c=l&&l.reduce((g,d)=>(g[d.key]=d.value,g),{});return this.uploadFileToOSS({url:a,filePath:t,fileType:n,formData:c,onUploadProgress:s}).then(()=>({fileID:r}))})}getTempFileURL(e){return P(this,arguments,function*({fileList:t}){return new Promise((n,s)=>{(!t||t.length<0)&&n({code:"INVALID_PARAM",message:"fileList\u4E0D\u80FD\u4E3A\u7A7A\u6570\u7EC4"}),t.length>50&&n({code:"INVALID_PARAM",message:"fileList\u6570\u7EC4\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC750"});let i=[];for(let o of t){let r;be(o)!=="string"&&n({code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u5B57\u7B26\u4E32"});try{r=_i.call(this,o)}catch(a){console.warn(a.errCode,a.errMsg),r=o}i.push({file_id:r,expire:600})}an({path:"/?download_url",data:{file_list:i},method:"POST"},this.config).then(o=>{let{file_list:r=[]}=o;n({fileList:r.map(a=>({fileID:wi.call(this,a.file_id),tempFileURL:a.download_url}))})}).catch(o=>s(o))})})}connectWebSocket(t){return P(this,null,function*(){let{name:e,query:n}=t;return N.connectSocket({url:this._websocket.signedURL(e,n),complete:()=>{}})})}},Si={init:t=>{t.provider="alipay";let e=new bi(t);return e.auth=function(){return{signInAnonymously:function(){return Promise.resolve()},getLoginState:function(){return Promise.resolve(!0)}}},e}};function vi({data:t}){let e;e=ht();let n=JSON.parse(JSON.stringify(t||{}));if(Object.assign(n,{clientInfo:e}),!n.uniIdToken){let{token:s}=Se();s&&(n.uniIdToken=s)}return n}var xi=[{rule:/fc_function_not_found|FUNCTION_NOT_FOUND/,content:"\uFF0C\u4E91\u51FD\u6570[{functionName}]\u5728\u4E91\u7AEF\u4E0D\u5B58\u5728\uFF0C\u8BF7\u68C0\u67E5\u6B64\u4E91\u51FD\u6570\u540D\u79F0\u662F\u5426\u6B63\u786E\u4EE5\u53CA\u8BE5\u4E91\u51FD\u6570\u662F\u5426\u5DF2\u4E0A\u4F20\u5230\u670D\u52A1\u7A7A\u95F4",mode:"append"}],Qn=/[\\^$.*+?()[\]{}|]/g,ki=RegExp(Qn.source);function cn(t,e,n){return t.replace(new RegExp((s=e)&&ki.test(s)?s.replace(Qn,"\\$&"):s,"g"),n);var s}var ot={NONE:"none",REQUEST:"request",RESPONSE:"response",BOTH:"both"},ln="_globalUniCloudStatus",Ti="_globalUniCloudSecureNetworkCache__{spaceId}",Ii="uni-secure-network",Yn={SYSTEM_ERROR:{code:2e4,message:"System error"},APP_INFO_INVALID:{code:20101,message:"Invalid client"},GET_ENCRYPT_KEY_FAILED:{code:20102,message:"Get encrypt key failed"}};function Xn(t){let{errSubject:e,subject:n,errCode:s,errMsg:i,code:o,message:r,cause:a}=t||{};return new C({subject:e||n||Ii,code:s||o||Yn.SYSTEM_ERROR.code,message:i||r,cause:a})}var kt;function un({secretType:t}={}){return t===ot.REQUEST||t===ot.RESPONSE||t===ot.BOTH}function dn({name:t,data:e={}}={}){return t==="DCloud-clientDB"&&e.redirectTo==="encryption"&&e.action==="getAppClientKey"}function Ci({provider:t,spaceId:e,functionName:n}={}){let{appId:s,uniPlatform:i,osName:o}=Bn(),r=i;i==="app"&&(r=o);let a=function({provider:d,spaceId:p}={}){let y=Ks;if(!y)return{};d=function(f){return f==="tencent"?"tcb":f}(d);let w=y.find(f=>f.provider===d&&f.spaceId===p);return w&&w.config}({provider:t,spaceId:e});if(!a||!a.accessControl||!a.accessControl.enable)return!1;let l=a.accessControl.function||{},c=Object.keys(l);if(c.length===0)return!0;let g=function(d,p){let y,w,f;for(let h=0;h<d.length;h++){let m=d[h];m!==p?m!=="*"?m.split(",").map(_=>_.trim()).indexOf(p)>-1&&(w=m):f=m:y=m}return y||w||f}(c,n);if(!g)return!1;if((l[g]||[]).find((d={})=>d.appId===s&&(d.platform||"").toLowerCase()===r.toLowerCase()))return!0;throw console.error(`\u6B64\u5E94\u7528[appId: ${s}, platform: ${r}]\u4E0D\u5728\u4E91\u7AEF\u914D\u7F6E\u7684\u5141\u8BB8\u8BBF\u95EE\u7684\u5E94\u7528\u5217\u8868\u5185\uFF0C\u53C2\u8003\uFF1Ahttps://uniapp.dcloud.net.cn/uniCloud/secure-network.html#verify-client`),Xn(Yn.APP_INFO_INVALID)}function hn({functionName:t,result:e,logPvd:n}){}function Ai(t){let e=t.callFunction,n=function(s){let i=s.name;s.data=vi.call(t,{data:s.data});let o={aliyun:"aliyun",tencent:"tcb",tcb:"tcb",alipay:"alipay",dcloud:"dcloud"}[this.config.provider],r=un(s),a=dn(s),l=r||a;return e.call(this,s).then(c=>(c.errCode=0,!l&&hn.call(this,{functionName:i,result:c,logPvd:o}),Promise.resolve(c)),c=>(!l&&hn.call(this,{functionName:i,result:c,logPvd:o}),c&&c.message&&(c.message=function({message:g="",extraInfo:d={},formatter:p=[]}={}){for(let y=0;y<p.length;y++){let{rule:w,content:f,mode:h}=p[y],m=g.match(w);if(!m)continue;let _=f;for(let b=1;b<m.length;b++)_=cn(_,`{$${b}}`,m[b]);for(let b in d)_=cn(_,`{${b}}`,d[b]);return h==="replace"?_:g+_}return g}({message:`[${s.name}]: ${c.message}`,formatter:xi,extraInfo:{functionName:i}})),Promise.reject(c)))};t.callFunction=function(s){let{provider:i,spaceId:o}=t.config,r=s.name,a,l;return s.data=s.data||{},a=n,a=a.bind(t),dn(s)?l=n.call(t,s):un(s)?l=new kt({secretType:s.secretType,uniCloudIns:t}).wrapEncryptDataCallFunction(n.bind(t))(s):Ci({provider:i,spaceId:o,functionName:r})?l=new kt({secretType:s.secretType,uniCloudIns:t}).wrapVerifyClientCallFunction(n.bind(t))(s):l=a(s),Object.defineProperty(l,"result",{get:()=>(console.warn("\u5F53\u524D\u8FD4\u56DE\u7ED3\u679C\u4E3APromise\u7C7B\u578B\uFF0C\u4E0D\u53EF\u76F4\u63A5\u8BBF\u95EE\u5176result\u5C5E\u6027\uFF0C\u8BE6\u60C5\u8BF7\u53C2\u8003\uFF1Ahttps://uniapp.dcloud.net.cn/uniCloud/faq?id=promise"),{})}),l.then(c=>(typeof UTSJSONObject!="undefined"&&(c.result=new UTSJSONObject(c.result)),c))}}kt=class{constructor(){throw Xn({message:`Platform ${Rt} is not enabled, please check whether secure network module is enabled in your manifest.json`})}};var Zn=Symbol("CLIENT_DB_INTERNAL");function ze(t,e){return t.then="DoNotReturnProxyWithAFunctionNamedThen",t._internalType=Zn,t.inspect=null,t.__v_raw=void 0,new Proxy(t,{get(n,s,i){if(s==="_uniClient")return null;if(typeof s=="symbol")return n[s];if(s in n||typeof s!="string"){let o=n[s];return typeof o=="function"?o.bind(n):o}return e.get(n,s,i)}})}function fn(t){return{on:(e,n)=>{t[e]=t[e]||[],t[e].indexOf(n)>-1||t[e].push(n)},off:(e,n)=>{t[e]=t[e]||[];let s=t[e].indexOf(n);s!==-1&&t[e].splice(s,1)}}}var Pi=["db.Geo","db.command","command.aggregate"];function es(t,e){return Pi.indexOf(`${t}.${e}`)>-1}function oe(t){switch(be(t=Un(t))){case"array":return t.map(e=>oe(e));case"object":return t._internalType===Zn||Object.keys(t).forEach(e=>{t[e]=oe(t[e])}),t;case"regexp":return{$regexp:{source:t.source,flags:t.flags}};case"date":return{$date:t.toISOString()};default:return t}}function ge(t){return t&&t.content&&t.content.$method}var Tt=class{constructor(e,n,s){this.content=e,this.prevStage=n||null,this.udb=null,this._database=s}toJSON(){let e=this,n=[e.content];for(;e.prevStage;)e=e.prevStage,n.push(e.content);return{$db:n.reverse().map(s=>({$method:s.$method,$param:oe(s.$param)}))}}toString(){return JSON.stringify(this.toJSON())}getAction(){let e=this.toJSON().$db.find(n=>n.$method==="action");return e&&e.$param&&e.$param[0]}getCommand(){return{$db:this.toJSON().$db.filter(e=>e.$method!=="action")}}get isAggregate(){let e=this;for(;e;){let n=ge(e),s=ge(e.prevStage);if(n==="aggregate"&&s==="collection"||n==="pipeline")return!0;e=e.prevStage}return!1}get isCommand(){let e=this;for(;e;){if(ge(e)==="command")return!0;e=e.prevStage}return!1}get isAggregateCommand(){let e=this;for(;e;){let n=ge(e),s=ge(e.prevStage);if(n==="aggregate"&&s==="command")return!0;e=e.prevStage}return!1}getNextStageFn(e){let n=this;return function(){return ve({$method:e,$param:oe(Array.from(arguments))},n,n._database)}}get count(){return this.isAggregate?this.getNextStageFn("count"):function(){return this._send("count",Array.from(arguments))}}get remove(){return this.isCommand?this.getNextStageFn("remove"):function(){return this._send("remove",Array.from(arguments))}}get(){return this._send("get",Array.from(arguments))}get add(){return this.isCommand?this.getNextStageFn("add"):function(){return this._send("add",Array.from(arguments))}}update(){return this._send("update",Array.from(arguments))}end(){return this._send("end",Array.from(arguments))}get set(){return this.isCommand?this.getNextStageFn("set"):function(){throw new Error("JQL\u7981\u6B62\u4F7F\u7528set\u65B9\u6CD5")}}_send(e,n){let s=this.getAction(),i=this.getCommand();return i.$db.push({$method:e,$param:oe(n)}),this._database._callCloudFunction({action:s,command:i})}};function ve(t,e,n){return ze(new Tt(t,e,n),{get(s,i){let o="db";return s&&s.content&&(o=s.content.$method),es(o,i)?ve({$method:i},s,n):function(){return ve({$method:i,$param:oe(Array.from(arguments))},s,n)}}})}function rt({path:t,method:e}){return class{constructor(){this.param=Array.from(arguments)}toJSON(){return{$newDb:[...t.map(n=>({$method:n})),{$method:e,$param:this.param}]}}toString(){return JSON.stringify(this.toJSON())}}}var It=class{constructor({uniClient:e={},isJQL:n=!1}={}){this._uniClient=e,this._authCallBacks={},this._dbCallBacks={},e._isDefault&&(this._dbCallBacks=ue("_globalUniCloudDatabaseCallback")),n||(this.auth=fn(this._authCallBacks)),this._isJQL=n,Object.assign(this,fn(this._dbCallBacks)),this.env=ze({},{get:(s,i)=>({$env:i})}),this.Geo=ze({},{get:(s,i)=>rt({path:["Geo"],method:i})}),this.serverDate=rt({path:[],method:"serverDate"}),this.RegExp=rt({path:[],method:"RegExp"})}getCloudEnv(e){if(typeof e!="string"||!e.trim())throw new Error("getCloudEnv\u53C2\u6570\u9519\u8BEF");return{$env:e.replace("$cloudEnv_","")}}_callback(e,n){let s=this._dbCallBacks;s[e]&&s[e].forEach(i=>{i(...n)})}_callbackAuth(e,n){let s=this._authCallBacks;s[e]&&s[e].forEach(i=>{i(...n)})}multiSend(){let e=Array.from(arguments),n=e.map(s=>{let i=s.getAction(),o=s.getCommand();if(o.$db[o.$db.length-1].$method!=="getTemp")throw new Error("multiSend\u53EA\u652F\u6301\u5B50\u547D\u4EE4\u5185\u4F7F\u7528getTemp");return{action:i,command:o}});return this._callCloudFunction({multiCommand:n,queryList:e})}};function gn(t,e={}){return ze(new t(e),{get:(n,s)=>es("db",s)?ve({$method:s},null,n):function(){return ve({$method:s,$param:oe(Array.from(arguments))},null,n)}})}var $e=class extends It{_parseResult(e){return this._isJQL?e.result:e}_callCloudFunction({action:e,command:n,multiCommand:s,queryList:i}){function o(d,p){if(s&&i)for(let y=0;y<i.length;y++){let w=i[y];w.udb&&typeof w.udb.setResult=="function"&&(p?w.udb.setResult(p):w.udb.setResult(d.result.dataList[y]))}}let r=this,a=this._isJQL?"databaseForJQL":"database";function l(d){return r._callback("error",[d]),M(j(a,"fail"),d).then(()=>M(j(a,"complete"),d)).then(()=>(o(null,d),z(R.RESPONSE,{type:Z.CLIENT_DB,content:d}),Promise.reject(d)))}let c=M(j(a,"invoke")),g=this._uniClient;return c.then(()=>g.callFunction({name:"DCloud-clientDB",type:Fe.CLIENT_DB,data:{action:e,command:n,multiCommand:s}})).then(d=>{let{code:p,message:y,token:w,tokenExpired:f,systemInfo:h=[]}=d.result;if(h)for(let _=0;_<h.length;_++){let{level:b,message:S,detail:I}=h[_],A="[System Info]"+S;I&&(A=`${A}
\u8BE6\u7EC6\u4FE1\u606F\uFF1A${I}`),(console[b==="warn"?"error":b]||console.log)(A)}if(p)return l(new C({code:p,message:y,requestId:d.requestId}));d.result.errCode=d.result.errCode||d.result.code,d.result.errMsg=d.result.errMsg||d.result.message,w&&f&&(Fn({token:w,tokenExpired:f}),this._callbackAuth("refreshToken",[{token:w,tokenExpired:f}]),this._callback("refreshToken",[{token:w,tokenExpired:f}]),z(R.REFRESH_TOKEN,{token:w,tokenExpired:f}));let m=[{prop:"affectedDocs",tips:"affectedDocs\u4E0D\u518D\u63A8\u8350\u4F7F\u7528\uFF0C\u8BF7\u4F7F\u7528inserted/deleted/updated/data.length\u66FF\u4EE3"},{prop:"code",tips:"code\u4E0D\u518D\u63A8\u8350\u4F7F\u7528\uFF0C\u8BF7\u4F7F\u7528errCode\u66FF\u4EE3"},{prop:"message",tips:"message\u4E0D\u518D\u63A8\u8350\u4F7F\u7528\uFF0C\u8BF7\u4F7F\u7528errMsg\u66FF\u4EE3"}];for(let _=0;_<m.length;_++){let{prop:b,tips:S}=m[_];if(b in d.result){let I=d.result[b];Object.defineProperty(d.result,b,{get:()=>(console.warn(S),I)})}}return function(_){return M(j(a,"success"),_).then(()=>M(j(a,"complete"),_)).then(()=>{o(_,null);let b=r._parseResult(_);return z(R.RESPONSE,{type:Z.CLIENT_DB,content:b}),Promise.resolve(b)})}(d)},d=>(/fc_function_not_found|FUNCTION_NOT_FOUND/g.test(d.message)&&console.warn("clientDB\u672A\u521D\u59CB\u5316\uFF0C\u8BF7\u5728web\u63A7\u5236\u53F0\u4FDD\u5B58\u4E00\u6B21schema\u4EE5\u5F00\u542FclientDB"),l(new C({code:d.code||"SYSTEM_ERROR",message:d.message,requestId:d.requestId}))))}},ie="token\u65E0\u6548\uFF0C\u8DF3\u8F6C\u767B\u5F55\u9875\u9762",ts="token\u8FC7\u671F\uFF0C\u8DF3\u8F6C\u767B\u5F55\u9875\u9762",Li={TOKEN_INVALID_TOKEN_EXPIRED:ts,TOKEN_INVALID_INVALID_CLIENTID:ie,TOKEN_INVALID:ie,TOKEN_INVALID_WRONG_TOKEN:ie,TOKEN_INVALID_ANONYMOUS_USER:ie},Ct={"uni-id-token-expired":ts,"uni-id-check-token-failed":ie,"uni-id-token-not-exist":ie,"uni-id-check-device-feature-failed":ie};function pn(t,e){let n="";return n=t?`${t}/${e}`:e,n.replace(/^\//,"")}function mn(t=[],e=""){let n=[],s=[];return t.forEach(i=>{i.needLogin===!0?n.push(pn(e,i.path)):i.needLogin===!1&&s.push(pn(e,i.path))}),{needLoginPage:n,notNeedLoginPage:s}}function xe(t){return t.split("?")[0].replace(/^\//,"")}function Ut(){return function(t){let e=t&&t.$page&&t.$page.fullPath||"";return e&&(e.charAt(0)!=="/"&&(e="/"+e),e)}(function(){let t=getCurrentPages();return t[t.length-1]}())}function ns(){return xe(Ut())}function Oi(t="",e={}){if(!t||!(e&&e.list&&e.list.length))return!1;let n=e.list,s=xe(t);return n.some(i=>i.pagePath===s)}var Ei=!!In.uniIdRouter,{loginPage:ke,routerNeedLogin:Ri,resToLogin:Di,needLoginPage:ss,notNeedLoginPage:Ni,loginPageInTabBar:Ui}=function({pages:t=[],subPackages:e=[],uniIdRouter:n={},tabBar:s={}}=In){let{loginPage:i,needLogin:o=[],resToLogin:r=!0}=n,{needLoginPage:a,notNeedLoginPage:l}=mn(t),{needLoginPage:c,notNeedLoginPage:g}=function(d=[]){let p=[],y=[];return d.forEach(w=>{let{root:f,pages:h=[]}=w,{needLoginPage:m,notNeedLoginPage:_}=mn(h,f);p.push(...m),y.push(..._)}),{needLoginPage:p,notNeedLoginPage:y}}(e);return{loginPage:i,routerNeedLogin:o,resToLogin:r,needLoginPage:[...a,...c],notNeedLoginPage:[...l,...g],loginPageInTabBar:Oi(i,s)}}();if(ss.indexOf(ke)>-1)throw new Error(`Login page [${ke}] should not be "needLogin", please check your pages.json`);function is(t){let e=ns();if(t.charAt(0)==="/")return t;let[n,s]=t.split("?"),i=n.replace(/^\//,"").split("/"),o=e.split("/");o.pop();for(let r=0;r<i.length;r++){let a=i[r];a===".."?o.pop():a!=="."&&o.push(a)}return o[0]===""&&o.shift(),"/"+o.join("/")+(s?"?"+s:"")}function Fi(t){let e=xe(is(t));return!(Ni.indexOf(e)>-1)&&(ss.indexOf(e)>-1||Ri.some(n=>function(s,i){return new RegExp(i).test(s)}(t,n)))}function os({redirect:t}){let e=xe(t),n=xe(ke);return ns()!==n&&e!==n}function At({api:t,redirect:e}={}){if(!e||!os({redirect:e}))return;let n=function(i,o){return i.charAt(0)!=="/"&&(i="/"+i),o?i.indexOf("?")>-1?i+`&uniIdRedirectUrl=${encodeURIComponent(o)}`:i+`?uniIdRedirectUrl=${encodeURIComponent(o)}`:i}(ke,e);Ui?t!=="navigateTo"&&t!=="redirectTo"||(t="switchTab"):t==="switchTab"&&(t="navigateTo");let s={navigateTo:uni.navigateTo,redirectTo:uni.redirectTo,switchTab:uni.switchTab,reLaunch:uni.reLaunch};setTimeout(()=>{s[t]({url:n})},0)}function yn({url:t}={}){let e={abortLoginPageJump:!1,autoToLoginPage:!1},n=function(){let{token:s,tokenExpired:i}=Se(),o;if(s){if(i<Date.now()){let r="uni-id-token-expired";o={errCode:r,errMsg:Ct[r]}}}else{let r="uni-id-check-token-failed";o={errCode:r,errMsg:Ct[r]}}return o}();if(Fi(t)&&n){if(n.uniIdRedirectUrl=t,Te(R.NEED_LOGIN).length>0)return setTimeout(()=>{z(R.NEED_LOGIN,n)},0),e.abortLoginPageJump=!0,e;e.autoToLoginPage=!0}return e}function Bi(){(function(){let e=Ut(),{abortLoginPageJump:n,autoToLoginPage:s}=yn({url:e});n||s&&At({api:"redirectTo",redirect:e})})();let t=["navigateTo","redirectTo","reLaunch","switchTab"];for(let e=0;e<t.length;e++){let n=t[e];uni.addInterceptor(n,{invoke(s){let{abortLoginPageJump:i,autoToLoginPage:o}=yn({url:s.url});return i?s:o?(At({api:n,redirect:is(s.url)}),!1):s}})}}function Mi(){this.onResponse(t=>{let{type:e,content:n}=t,s=!1;switch(e){case"cloudobject":s=function(i){if(typeof i!="object")return!1;let{errCode:o}=i||{};return o in Ct}(n);break;case"clientdb":s=function(i){if(typeof i!="object")return!1;let{errCode:o}=i||{};return o in Li}(n)}s&&function(i={}){let o=Te(R.NEED_LOGIN);Dn().then(()=>{let r=Ut();if(r&&os({redirect:r}))return o.length>0?z(R.NEED_LOGIN,Object.assign({uniIdRedirectUrl:r},i)):void(ke&&At({api:"navigateTo",redirect:r}))})}(n)})}function ji(t){(function(e){e.onResponse=function(n){Ye(R.RESPONSE,n)},e.offResponse=function(n){Xe(R.RESPONSE,n)}})(t),function(e){e.onNeedLogin=function(n){Ye(R.NEED_LOGIN,n)},e.offNeedLogin=function(n){Xe(R.NEED_LOGIN,n)},Ei&&(ue(ln).needLoginInit||(ue(ln).needLoginInit=!0,Dn().then(()=>{Bi.call(e)}),Di&&Mi.call(e)))}(t),function(e){e.onRefreshToken=function(n){Ye(R.REFRESH_TOKEN,n)},e.offRefreshToken=function(n){Xe(R.REFRESH_TOKEN,n)}}(t)}var rs,Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",qi=/^(?:[A-Za-z\d+/]{4})*?(?:[A-Za-z\d+/]{2}(?:==)?|[A-Za-z\d+/]{3}=?)?$/;function Ki(){let t=Se().token||"",e=t.split(".");if(!t||e.length!==3)return{uid:null,role:[],permission:[],tokenExpired:0};let n;try{n=JSON.parse((s=e[1],decodeURIComponent(rs(s).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(i){throw new Error("\u83B7\u53D6\u5F53\u524D\u7528\u6237\u4FE1\u606F\u51FA\u9519\uFF0C\u8BE6\u7EC6\u9519\u8BEF\u4FE1\u606F\u4E3A\uFF1A"+i.message)}var s;return n.tokenExpired=1e3*n.exp,delete n.exp,delete n.iat,n}rs=typeof atob!="function"?function(t){if(t=String(t).replace(/[\t\n\f\r ]+/g,""),!qi.test(t))throw new Error("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");var e;t+="==".slice(2-(3&t.length));for(var n,s,i="",o=0;o<t.length;)e=Re.indexOf(t.charAt(o++))<<18|Re.indexOf(t.charAt(o++))<<12|(n=Re.indexOf(t.charAt(o++)))<<6|(s=Re.indexOf(t.charAt(o++))),i+=n===64?String.fromCharCode(e>>16&255):s===64?String.fromCharCode(e>>16&255,e>>8&255):String.fromCharCode(e>>16&255,e>>8&255,255&e);return i}:atob;var Hi=V(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});let n="chooseAndUploadFile:ok",s="chooseAndUploadFile:fail";function i(r,a){return r.tempFiles.forEach((l,c)=>{l.name||(l.name=l.path.substring(l.path.lastIndexOf("/")+1)),a&&(l.fileType=a),l.cloudPath=Date.now()+"_"+c+l.name.substring(l.name.lastIndexOf("."))}),r.tempFilePaths||(r.tempFilePaths=r.tempFiles.map(l=>l.path)),r}function o(r,a,{onChooseFile:l,onUploadProgress:c}){return a.then(g=>{if(l){let d=l(g);if(d!==void 0)return Promise.resolve(d).then(p=>p===void 0?g:p)}return g}).then(g=>g===!1?{errMsg:n,tempFilePaths:[],tempFiles:[]}:function(d,p,y=5,w){(p=Object.assign({},p)).errMsg=n;let f=p.tempFiles,h=f.length,m=0;return new Promise(_=>{for(;m<y;)b();function b(){let S=m++;if(S>=h)return void(!f.find(A=>!A.url&&!A.errMsg)&&_(p));let I=f[S];d.uploadFile({provider:I.provider,filePath:I.path,cloudPath:I.cloudPath,fileType:I.fileType,cloudPathAsRealPath:I.cloudPathAsRealPath,onUploadProgress(A){A.index=S,A.tempFile=I,A.tempFilePath=I.path,w&&w(A)}}).then(A=>{I.url=A.fileID,S<h&&b()}).catch(A=>{I.errMsg=A.errMsg||A.message,S<h&&b()})}})}(r,g,5,c))}e.initChooseAndUploadFile=function(r){return function(a={type:"all"}){return a.type==="image"?o(r,function(l){let{count:c,sizeType:g,sourceType:d=["album","camera"],extension:p}=l;return new Promise((y,w)=>{uni.chooseImage({count:c,sizeType:g,sourceType:d,extension:p,success(f){y(i(f,"image"))},fail(f){w({errMsg:f.errMsg.replace("chooseImage:fail",s)})}})})}(a),a):a.type==="video"?o(r,function(l){let{camera:c,compressed:g,maxDuration:d,sourceType:p=["album","camera"],extension:y}=l;return new Promise((w,f)=>{uni.chooseVideo({camera:c,compressed:g,maxDuration:d,sourceType:p,extension:y,success(h){let{tempFilePath:m,duration:_,size:b,height:S,width:I}=h;w(i({errMsg:"chooseVideo:ok",tempFilePaths:[m],tempFiles:[{name:h.tempFile&&h.tempFile.name||"",path:m,size:b,type:h.tempFile&&h.tempFile.type||"",width:I,height:S,duration:_,fileType:"video",cloudPath:""}]},"video"))},fail(h){f({errMsg:h.errMsg.replace("chooseVideo:fail",s)})}})})}(a),a):o(r,function(l){let{count:c,extension:g}=l;return new Promise((d,p)=>{let y=uni.chooseFile;if(typeof wx!="undefined"&&typeof wx.chooseMessageFile=="function"&&(y=wx.chooseMessageFile),typeof y!="function")return p({errMsg:s+" \u8BF7\u6307\u5B9A type \u7C7B\u578B\uFF0C\u8BE5\u5E73\u53F0\u4EC5\u652F\u6301\u9009\u62E9 image \u6216 video\u3002"});y({type:"all",count:c,extension:g,success(w){d(i(w))},fail(w){p({errMsg:w.errMsg.replace("chooseFile:fail",s)})}})})}(a),a)}}}),zi=Es(Hi),$i={auto:"auto",onready:"onready",manual:"manual"};function as(t){return{props:{localdata:{type:Array,default:()=>[]},options:{type:[Object,Array],default:()=>({})},spaceInfo:{type:Object,default:()=>({})},collection:{type:[String,Array],default:""},action:{type:String,default:""},field:{type:String,default:""},orderby:{type:String,default:""},where:{type:[String,Object],default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:20},getcount:{type:[Boolean,String],default:!1},gettree:{type:[Boolean,String],default:!1},gettreepath:{type:[Boolean,String],default:!1},startwith:{type:String,default:""},limitlevel:{type:Number,default:10},groupby:{type:String,default:""},groupField:{type:String,default:""},distinct:{type:[Boolean,String],default:!1},foreignKey:{type:String,default:""},loadtime:{type:String,default:"auto"},manual:{type:Boolean,default:!1}},data:()=>({mixinDatacomLoading:!1,mixinDatacomHasMore:!1,mixinDatacomResData:[],mixinDatacomErrorMessage:"",mixinDatacomPage:{},mixinDatacomError:null}),created(){this.mixinDatacomPage={current:this.pageCurrent,size:this.pageSize,count:0},this.$watch(()=>{var e=[];return["pageCurrent","pageSize","localdata","collection","action","field","orderby","where","getont","getcount","gettree","groupby","groupField","distinct"].forEach(n=>{e.push(this[n])}),e},(e,n)=>{if(this.loadtime===$i.manual)return;let s=!1,i=[];for(let o=2;o<e.length;o++)e[o]!==n[o]&&(i.push(e[o]),s=!0);e[0]!==n[0]&&(this.mixinDatacomPage.current=this.pageCurrent),this.mixinDatacomPage.size=this.pageSize,this.onMixinDatacomPropsChange(s,i)})},methods:{onMixinDatacomPropsChange(e,n){},mixinDatacomEasyGet({getone:e=!1,success:n,fail:s}={}){this.mixinDatacomLoading||(this.mixinDatacomLoading=!0,this.mixinDatacomErrorMessage="",this.mixinDatacomError=null,this.mixinDatacomGet().then(i=>{this.mixinDatacomLoading=!1;let{data:o,count:r}=i.result;this.getcount&&(this.mixinDatacomPage.count=r),this.mixinDatacomHasMore=o.length<this.pageSize;let a=e?o.length?o[0]:void 0:o;this.mixinDatacomResData=a,n&&n(a)}).catch(i=>{this.mixinDatacomLoading=!1,this.mixinDatacomErrorMessage=i,this.mixinDatacomError=i,s&&s(i)}))},mixinDatacomGet(e={}){let n;e=e||{},n=typeof __uniX!="undefined"&&__uniX?t.databaseForJQL(this.spaceInfo):t.database(this.spaceInfo);let s=e.action||this.action;s&&(n=n.action(s));let i=e.collection||this.collection;n=Array.isArray(i)?n.collection(...i):n.collection(i);let o=e.where||this.where;o&&Object.keys(o).length&&(n=n.where(o));let r=e.field||this.field;r&&(n=n.field(r));let a=e.foreignKey||this.foreignKey;a&&(n=n.foreignKey(a));let l=e.groupby||this.groupby;l&&(n=n.groupBy(l));let c=e.groupField||this.groupField;c&&(n=n.groupField(c)),(e.distinct!==void 0?e.distinct:this.distinct)===!0&&(n=n.distinct());let g=e.orderby||this.orderby;g&&(n=n.orderBy(g));let d=e.pageCurrent!==void 0?e.pageCurrent:this.mixinDatacomPage.current,p=e.pageSize!==void 0?e.pageSize:this.mixinDatacomPage.size,y=e.getcount!==void 0?e.getcount:this.getcount,w=e.gettree!==void 0?e.gettree:this.gettree,f=e.gettreepath!==void 0?e.gettreepath:this.gettreepath,h={getCount:y},m={limitLevel:e.limitlevel!==void 0?e.limitlevel:this.limitlevel,startWith:e.startwith!==void 0?e.startwith:this.startwith};return w&&(h.getTree=m),f&&(h.getTreePath=m),n=n.skip(p*(d-1)).limit(p).get(h),n}}}}function Vi(t){return function(e,n={}){n=function(l,c={}){return l.customUI=c.customUI||l.customUI,l.parseSystemError=c.parseSystemError||l.parseSystemError,Object.assign(l.loadingOptions,c.loadingOptions),Object.assign(l.errorOptions,c.errorOptions),typeof c.secretMethods=="object"&&(l.secretMethods=c.secretMethods),l}({customUI:!1,loadingOptions:{title:"\u52A0\u8F7D\u4E2D...",mask:!0},errorOptions:{type:"modal",retry:!1}},n);let{customUI:s,loadingOptions:i,errorOptions:o,parseSystemError:r}=n,a=!s;return new Proxy({},{get(l,c){switch(c){case"toString":return"[object UniCloudObject]";case"toJSON":return{}}return function({fn:g,interceptorName:d,getCallbackArgs:p}={}){return function(...y){return P(this,null,function*(){let w=p?p({params:y}):{},f,h;try{return yield M(j(d,"invoke"),O({},w)),f=yield g(...y),yield M(j(d,"success"),B(O({},w),{result:f})),f}catch(m){throw h=m,yield M(j(d,"fail"),B(O({},w),{error:h})),h}finally{yield M(j(d,"complete"),h?B(O({},w),{error:h}):B(O({},w),{result:f}))}})}}({fn:function g(...d){return P(this,null,function*(){let p;a&&uni.showLoading({title:i.title,mask:i.mask});let y={name:e,type:Fe.OBJECT,data:{method:c,params:d}};typeof n.secretMethods=="object"&&function(b,S){let I=S.data.method,A=b.secretMethods||{},E=A[I]||A["*"];E&&(S.secretType=E)}(n,y);let w=!1;try{p=yield t.callFunction(y)}catch(b){w=!0,p={result:new C(b)}}let{errSubject:f,errCode:h,errMsg:m,newToken:_}=p.result||{};if(a&&uni.hideLoading(),_&&_.token&&_.tokenExpired&&(Fn(_),z(R.REFRESH_TOKEN,O({},_))),h){let b=m;if(w&&r&&(b=(yield r({objectName:e,methodName:c,params:d,errSubject:f,errCode:h,errMsg:m})).errMsg||m),a)if(o.type==="toast")uni.showToast({title:b,icon:"none"});else{if(o.type!=="modal")throw new Error(`Invalid errorOptions.type: ${o.type}`);{let{confirm:I}=yield function(){return P(this,arguments,function*({title:A,content:E,showCancel:L,cancelText:U,confirmText:J}={}){return new Promise((K,ne)=>{uni.showModal({title:A,content:E,showCancel:L,cancelText:U,confirmText:J,success(G){K(G)},fail(){K({confirm:!1,cancel:!0})}})})})}({title:"\u63D0\u793A",content:b,showCancel:o.retry,cancelText:"\u53D6\u6D88",confirmText:o.retry?"\u91CD\u8BD5":"\u786E\u5B9A"});if(o.retry&&I)return g(...d)}}let S=new C({subject:f,code:h,message:m,requestId:p.requestId});throw S.detail=p.result,z(R.RESPONSE,{type:Z.CLOUD_OBJECT,content:S}),S}return z(R.RESPONSE,{type:Z.CLOUD_OBJECT,content:p.result}),p.result})},interceptorName:"callObject",getCallbackArgs:function({params:g}={}){return{objectName:e,methodName:c,params:g}}})}})}}function cs(t){return ue(Ti.replace("{spaceId}",t.config.spaceId))}function Wi(){return P(this,arguments,function*({openid:t,callLoginByWeixin:e=!1}={}){throw cs(this),new Error(`[SecureNetwork] API \`initSecureNetworkByWeixin\` is not supported on platform \`${Rt}\``)})}function Ji(t){return P(this,null,function*(){let e=cs(this);return e.initPromise||(e.initPromise=Wi.call(this,t).then(n=>n).catch(n=>{throw delete e.initPromise,n})),e.initPromise})}function Gi(t){return function({openid:e,callLoginByWeixin:n=!1}={}){return Ji.call(t,{openid:e,callLoginByWeixin:n})}}function Qi(t){(function(e){dt=e})(t)}function _n(t){let e={getSystemInfo:uni.getSystemInfo,getPushClientId:uni.getPushClientId};return function(n){return new Promise((s,i)=>{e[t](B(O({},n),{success(o){s(o)},fail(o){i(o)}}))})}}var Pt=class extends ut{constructor(){super(),this._uniPushMessageCallback=this._receivePushMessage.bind(this),this._currentMessageId=-1,this._payloadQueue=[]}init(){return Promise.all([_n("getSystemInfo")(),_n("getPushClientId")()]).then(([{appId:e}={},{cid:n}={}]=[])=>{if(!e)throw new Error("Invalid appId, please check the manifest.json file");if(!n)throw new Error("Invalid push client id");this._appId=e,this._pushClientId=n,this._seqId=Date.now()+"-"+Math.floor(9e5*Math.random()+1e5),this.emit("open"),this._initMessageListener()},e=>{throw this.emit("error",e),this.close(),e})}open(){return P(this,null,function*(){return this.init()})}_isUniCloudSSE(e){if(e.type!=="receive")return!1;let n=e&&e.data&&e.data.payload;return!(!n||n.channel!=="UNI_CLOUD_SSE"||n.seqId!==this._seqId)}_receivePushMessage(e){if(!this._isUniCloudSSE(e))return;let n=e&&e.data&&e.data.payload,{action:s,messageId:i,message:o}=n;this._payloadQueue.push({action:s,messageId:i,message:o}),this._consumMessage()}_consumMessage(){for(;;){let e=this._payloadQueue.find(n=>n.messageId===this._currentMessageId+1);if(!e)break;this._currentMessageId++,this._parseMessagePayload(e)}}_parseMessagePayload(e){let{action:n,messageId:s,message:i}=e;n==="end"?this._end({messageId:s,message:i}):n==="message"&&this._appendMessage({messageId:s,message:i})}_appendMessage({messageId:e,message:n}={}){this.emit("message",n)}_end({messageId:e,message:n}={}){this.emit("end",n),this.close()}_initMessageListener(){uni.onPushMessage(this._uniPushMessageCallback)}_destroy(){uni.offPushMessage(this._uniPushMessageCallback)}toJSON(){return{appId:this._appId,pushClientId:this._pushClientId,seqId:this._seqId}}close(){this._destroy(),this.emit("close")}};function Yi(t){t._initPromiseHub||(t._initPromiseHub=new Be({createPromise:function(){let e=Promise.resolve();var n;n=1,e=new Promise(i=>{setTimeout(()=>{i()},n)});let s=t.auth();return e.then(()=>s.getLoginState()).then(i=>i?Promise.resolve():s.signInAnonymously())}}))}var Xi={tcb:on,tencent:on,aliyun:Qs,private:rn,dcloud:rn,alipay:Si},H=new class{init(t){let e={},n=Xi[t.provider];if(!n)throw new Error("\u672A\u63D0\u4F9B\u6B63\u786E\u7684provider\u53C2\u6570");return e=n.init(t),Yi(e),Ai(e),function(s){let i=s.uploadFile;s.uploadFile=function(o){return i.call(this,o)}}(e),function(s){s.database=function(i){if(i&&Object.keys(i).length>0)return s.init(i).database();if(this._database)return this._database;let o=gn($e,{uniClient:s});return this._database=o,o},s.databaseForJQL=function(i){if(i&&Object.keys(i).length>0)return s.init(i).databaseForJQL();if(this._databaseForJQL)return this._databaseForJQL;let o=gn($e,{uniClient:s,isJQL:!0});return this._databaseForJQL=o,o}}(e),function(s){s.getCurrentUserInfo=Ki,s.chooseAndUploadFile=zi.initChooseAndUploadFile(s),Object.assign(s,{get mixinDatacom(){return as(s)}}),s.SSEChannel=Pt,s.initSecureNetworkByWeixin=Gi(s),s.setCustomClientInfo=Qi,s.importObject=Vi(s)}(e),["callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","chooseAndUploadFile"].forEach(s=>{if(!e[s])return;let i=e[s];e[s]=function(){return i.apply(e,Array.from(arguments))},e[s]=function(o,r){return function(a){let l=!1;r==="callFunction"&&(l=(a&&a.type||Fe.DEFAULT)!==Fe.DEFAULT);let c=r==="callFunction"&&!l,g=this._initPromiseHub.exec();a=a||{};let{success:d,fail:p,complete:y}=Nn(a),w=g.then(()=>l?Promise.resolve():M(j(r,"invoke"),a)).then(()=>o.call(this,a)).then(f=>l?Promise.resolve(f):M(j(r,"success"),f).then(()=>M(j(r,"complete"),f)).then(()=>(c&&z(R.RESPONSE,{type:Z.CLOUD_FUNCTION,content:f}),Promise.resolve(f))),f=>l?Promise.reject(f):M(j(r,"fail"),f).then(()=>M(j(r,"complete"),f)).then(()=>(z(R.RESPONSE,{type:Z.CLOUD_FUNCTION,content:f}),Promise.reject(f))));if(!(d||p||y))return w;w.then(f=>{d&&d(f),y&&y(f),c&&z(R.RESPONSE,{type:Z.CLOUD_FUNCTION,content:f})},f=>{p&&p(f),y&&y(f),c&&z(R.RESPONSE,{type:Z.CLOUD_FUNCTION,content:f})})}}(e[s],s).bind(e)}),e.init=this.init,e}};(()=>{let t=Hs,e={};if(t&&t.length===1)e=t[0],H=H.init(e),H._isDefault=!0;else{let n=["auth","callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","database","getCurrentUSerInfo","importObject"],s;s=t&&t.length>0?"\u5E94\u7528\u6709\u591A\u4E2A\u670D\u52A1\u7A7A\u95F4\uFF0C\u8BF7\u901A\u8FC7uniCloud.init\u65B9\u6CD5\u6307\u5B9A\u8981\u4F7F\u7528\u7684\u670D\u52A1\u7A7A\u95F4":"\u5E94\u7528\u672A\u5173\u8054\u670D\u52A1\u7A7A\u95F4\uFF0C\u8BF7\u5728uniCloud\u76EE\u5F55\u53F3\u952E\u5173\u8054\u670D\u52A1\u7A7A\u95F4",n.forEach(i=>{H[i]=function(){return console.error(s),Promise.reject(new C({code:"SYS_ERR",message:s}))}})}if(Object.assign(H,{get mixinDatacom(){return as(H)}}),ji(H),H.addInterceptor=Rn,H.removeInterceptor=Vs,H.interceptObject=Ws,uni.__uniCloud=H,Rt==="app"){let n=$s();n.uniCloud=H,n.UniCloudError=C}})();var me=H,Zi=[{font_class:"arrow-down",unicode:"\uE6BE"},{font_class:"arrow-left",unicode:"\uE6BC"},{font_class:"arrow-right",unicode:"\uE6BB"},{font_class:"arrow-up",unicode:"\uE6BD"},{font_class:"auth",unicode:"\uE6AB"},{font_class:"auth-filled",unicode:"\uE6CC"},{font_class:"back",unicode:"\uE6B9"},{font_class:"bars",unicode:"\uE627"},{font_class:"calendar",unicode:"\uE6A0"},{font_class:"calendar-filled",unicode:"\uE6C0"},{font_class:"camera",unicode:"\uE65A"},{font_class:"camera-filled",unicode:"\uE658"},{font_class:"cart",unicode:"\uE631"},{font_class:"cart-filled",unicode:"\uE6D0"},{font_class:"chat",unicode:"\uE65D"},{font_class:"chat-filled",unicode:"\uE659"},{font_class:"chatboxes",unicode:"\uE696"},{font_class:"chatboxes-filled",unicode:"\uE692"},{font_class:"chatbubble",unicode:"\uE697"},{font_class:"chatbubble-filled",unicode:"\uE694"},{font_class:"checkbox",unicode:"\uE62B"},{font_class:"checkbox-filled",unicode:"\uE62C"},{font_class:"checkmarkempty",unicode:"\uE65C"},{font_class:"circle",unicode:"\uE65B"},{font_class:"circle-filled",unicode:"\uE65E"},{font_class:"clear",unicode:"\uE66D"},{font_class:"close",unicode:"\uE673"},{font_class:"closeempty",unicode:"\uE66C"},{font_class:"cloud-download",unicode:"\uE647"},{font_class:"cloud-download-filled",unicode:"\uE646"},{font_class:"cloud-upload",unicode:"\uE645"},{font_class:"cloud-upload-filled",unicode:"\uE648"},{font_class:"color",unicode:"\uE6CF"},{font_class:"color-filled",unicode:"\uE6C9"},{font_class:"compose",unicode:"\uE67F"},{font_class:"contact",unicode:"\uE693"},{font_class:"contact-filled",unicode:"\uE695"},{font_class:"down",unicode:"\uE6B8"},{font_class:"bottom",unicode:"\uE6B8"},{font_class:"download",unicode:"\uE68D"},{font_class:"download-filled",unicode:"\uE681"},{font_class:"email",unicode:"\uE69E"},{font_class:"email-filled",unicode:"\uE69A"},{font_class:"eye",unicode:"\uE651"},{font_class:"eye-filled",unicode:"\uE66A"},{font_class:"eye-slash",unicode:"\uE6B3"},{font_class:"eye-slash-filled",unicode:"\uE6B4"},{font_class:"fire",unicode:"\uE6A1"},{font_class:"fire-filled",unicode:"\uE6C5"},{font_class:"flag",unicode:"\uE65F"},{font_class:"flag-filled",unicode:"\uE660"},{font_class:"folder-add",unicode:"\uE6A9"},{font_class:"folder-add-filled",unicode:"\uE6C8"},{font_class:"font",unicode:"\uE6A3"},{font_class:"forward",unicode:"\uE6BA"},{font_class:"gear",unicode:"\uE664"},{font_class:"gear-filled",unicode:"\uE661"},{font_class:"gift",unicode:"\uE6A4"},{font_class:"gift-filled",unicode:"\uE6C4"},{font_class:"hand-down",unicode:"\uE63D"},{font_class:"hand-down-filled",unicode:"\uE63C"},{font_class:"hand-up",unicode:"\uE63F"},{font_class:"hand-up-filled",unicode:"\uE63E"},{font_class:"headphones",unicode:"\uE630"},{font_class:"heart",unicode:"\uE639"},{font_class:"heart-filled",unicode:"\uE641"},{font_class:"help",unicode:"\uE679"},{font_class:"help-filled",unicode:"\uE674"},{font_class:"home",unicode:"\uE662"},{font_class:"home-filled",unicode:"\uE663"},{font_class:"image",unicode:"\uE670"},{font_class:"image-filled",unicode:"\uE678"},{font_class:"images",unicode:"\uE650"},{font_class:"images-filled",unicode:"\uE64B"},{font_class:"info",unicode:"\uE669"},{font_class:"info-filled",unicode:"\uE649"},{font_class:"left",unicode:"\uE6B7"},{font_class:"link",unicode:"\uE6A5"},{font_class:"list",unicode:"\uE644"},{font_class:"location",unicode:"\uE6AE"},{font_class:"location-filled",unicode:"\uE6AF"},{font_class:"locked",unicode:"\uE66B"},{font_class:"locked-filled",unicode:"\uE668"},{font_class:"loop",unicode:"\uE633"},{font_class:"mail-open",unicode:"\uE643"},{font_class:"mail-open-filled",unicode:"\uE63A"},{font_class:"map",unicode:"\uE667"},{font_class:"map-filled",unicode:"\uE666"},{font_class:"map-pin",unicode:"\uE6AD"},{font_class:"map-pin-ellipse",unicode:"\uE6AC"},{font_class:"medal",unicode:"\uE6A2"},{font_class:"medal-filled",unicode:"\uE6C3"},{font_class:"mic",unicode:"\uE671"},{font_class:"mic-filled",unicode:"\uE677"},{font_class:"micoff",unicode:"\uE67E"},{font_class:"micoff-filled",unicode:"\uE6B0"},{font_class:"minus",unicode:"\uE66F"},{font_class:"minus-filled",unicode:"\uE67D"},{font_class:"more",unicode:"\uE64D"},{font_class:"more-filled",unicode:"\uE64E"},{font_class:"navigate",unicode:"\uE66E"},{font_class:"navigate-filled",unicode:"\uE67A"},{font_class:"notification",unicode:"\uE6A6"},{font_class:"notification-filled",unicode:"\uE6C1"},{font_class:"paperclip",unicode:"\uE652"},{font_class:"paperplane",unicode:"\uE672"},{font_class:"paperplane-filled",unicode:"\uE675"},{font_class:"person",unicode:"\uE699"},{font_class:"person-filled",unicode:"\uE69D"},{font_class:"personadd",unicode:"\uE69F"},{font_class:"personadd-filled",unicode:"\uE698"},{font_class:"personadd-filled-copy",unicode:"\uE6D1"},{font_class:"phone",unicode:"\uE69C"},{font_class:"phone-filled",unicode:"\uE69B"},{font_class:"plus",unicode:"\uE676"},{font_class:"plus-filled",unicode:"\uE6C7"},{font_class:"plusempty",unicode:"\uE67B"},{font_class:"pulldown",unicode:"\uE632"},{font_class:"pyq",unicode:"\uE682"},{font_class:"qq",unicode:"\uE680"},{font_class:"redo",unicode:"\uE64A"},{font_class:"redo-filled",unicode:"\uE655"},{font_class:"refresh",unicode:"\uE657"},{font_class:"refresh-filled",unicode:"\uE656"},{font_class:"refreshempty",unicode:"\uE6BF"},{font_class:"reload",unicode:"\uE6B2"},{font_class:"right",unicode:"\uE6B5"},{font_class:"scan",unicode:"\uE62A"},{font_class:"search",unicode:"\uE654"},{font_class:"settings",unicode:"\uE653"},{font_class:"settings-filled",unicode:"\uE6CE"},{font_class:"shop",unicode:"\uE62F"},{font_class:"shop-filled",unicode:"\uE6CD"},{font_class:"smallcircle",unicode:"\uE67C"},{font_class:"smallcircle-filled",unicode:"\uE665"},{font_class:"sound",unicode:"\uE684"},{font_class:"sound-filled",unicode:"\uE686"},{font_class:"spinner-cycle",unicode:"\uE68A"},{font_class:"staff",unicode:"\uE6A7"},{font_class:"staff-filled",unicode:"\uE6CB"},{font_class:"star",unicode:"\uE688"},{font_class:"star-filled",unicode:"\uE68F"},{font_class:"starhalf",unicode:"\uE683"},{font_class:"trash",unicode:"\uE687"},{font_class:"trash-filled",unicode:"\uE685"},{font_class:"tune",unicode:"\uE6AA"},{font_class:"tune-filled",unicode:"\uE6CA"},{font_class:"undo",unicode:"\uE64F"},{font_class:"undo-filled",unicode:"\uE64C"},{font_class:"up",unicode:"\uE6B6"},{font_class:"top",unicode:"\uE6B6"},{font_class:"upload",unicode:"\uE690"},{font_class:"upload-filled",unicode:"\uE68E"},{font_class:"videocam",unicode:"\uE68C"},{font_class:"videocam-filled",unicode:"\uE689"},{font_class:"vip",unicode:"\uE6A8"},{font_class:"vip-filled",unicode:"\uE6C6"},{font_class:"wallet",unicode:"\uE6B1"},{font_class:"wallet-filled",unicode:"\uE6C2"},{font_class:"weibo",unicode:"\uE68B"},{font_class:"weixin",unicode:"\uE691"}],eo="/assets/uniicons.32e978a5.ttf",to={"uni-icons":{"":{fontFamily:"uniicons",textDecoration:"none",textAlign:"center"}}},no=t=>typeof t=="number"||/^[0-9]*$/g.test(t)?t+"px":t,so=weex.requireModule("dom");so.addRule("fontFace",{fontFamily:"uniicons",src:"url('"+eo+"')"});var io={name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""},fontFamily:{type:String,default:""}},data(){return{icons:Zi}},computed:{unicode(){let t=this.icons.find(e=>e.font_class===this.type);return t?t.unicode:""},iconSize(){return no(this.size)},styleObj(){return this.fontFamily!==""?`color: ${this.color}; font-size: ${this.iconSize}; font-family: ${this.fontFamily};`:`color: ${this.color}; font-size: ${this.iconSize};`}},methods:{_onClick(){this.$emit("click")}}};function oo(t,e,n,s,i,o){return(0,u.openBlock)(),(0,u.createElementBlock)("u-text",{style:(0,u.normalizeStyle)(o.styleObj),class:"uni-icons",onClick:e[0]||(e[0]=(...r)=>o._onClick&&o._onClick(...r))},(0,u.toDisplayString)(o.unicode),5)}var Ft=Q(io,[["render",oo],["styles",[to]]]),ro=t=>t!==null&&typeof t=="object",ao=["{","}"],Lt=class{constructor(){this._caches=Object.create(null)}interpolate(e,n,s=ao){if(!n)return[e];let i=this._caches[e];return i||(i=uo(e,s),this._caches[e]=i),ho(i,n)}},co=/^(?:\d)+/,lo=/^(?:\w)+/;function uo(t,[e,n]){let s=[],i=0,o="";for(;i<t.length;){let r=t[i++];if(r===e){o&&s.push({type:"text",value:o}),o="";let a="";for(r=t[i++];r!==void 0&&r!==n;)a+=r,r=t[i++];let l=r===n,c=co.test(a)?"list":l&&lo.test(a)?"named":"unknown";s.push({value:a,type:c})}else o+=r}return o&&s.push({type:"text",value:o}),s}function ho(t,e){let n=[],s=0,i=Array.isArray(e)?"list":ro(e)?"named":"unknown";if(i==="unknown")return n;for(;s<t.length;){let o=t[s];switch(o.type){case"text":n.push(o.value);break;case"list":n.push(e[parseInt(o.value,10)]);break;case"named":i==="named"&&n.push(e[o.value]);break}s++}return n}var at="zh-Hans",wn="zh-Hant",le="en",fo="fr",go="es",po=Object.prototype.hasOwnProperty,bn=(t,e)=>po.call(t,e),mo=new Lt;function yo(t,e){return!!e.find(n=>t.indexOf(n)!==-1)}function _o(t,e){return e.find(n=>t.indexOf(n)===0)}function Sn(t,e){if(!t)return;if(t=t.trim().replace(/_/g,"-"),e&&e[t])return t;if(t=t.toLowerCase(),t==="chinese")return at;if(t.indexOf("zh")===0)return t.indexOf("-hans")>-1?at:t.indexOf("-hant")>-1||yo(t,["-tw","-hk","-mo","-cht"])?wn:at;let n=[le,fo,go];e&&Object.keys(e).length>0&&(n=Object.keys(e));let s=_o(t,n);if(s)return s}var Ot=class{constructor({locale:e,fallbackLocale:n,messages:s,watcher:i,formater:o}){this.locale=le,this.fallbackLocale=le,this.message={},this.messages={},this.watchers=[],n&&(this.fallbackLocale=n),this.formater=o||mo,this.messages=s||{},this.setLocale(e||le),i&&this.watchLocale(i)}setLocale(e){let n=this.locale;this.locale=Sn(e,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],n!==this.locale&&this.watchers.forEach(s=>{s(this.locale,n)})}getLocale(){return this.locale}watchLocale(e){let n=this.watchers.push(e)-1;return()=>{this.watchers.splice(n,1)}}add(e,n,s=!0){let i=this.messages[e];i?s?Object.assign(i,n):Object.keys(n).forEach(o=>{bn(i,o)||(i[o]=n[o])}):this.messages[e]=n}f(e,n,s){return this.formater.interpolate(e,n,s).join("")}t(e,n,s){let i=this.message;return typeof n=="string"?(n=Sn(n,this.messages),n&&(i=this.messages[n])):s=n,bn(i,e)?this.formater.interpolate(i[e],s).join(""):(console.warn(`Cannot translate the value of keypath ${e}. Use the value of keypath as default.`),e)}};function wo(t,e){t.$watchLocale?t.$watchLocale(n=>{e.setLocale(n)}):t.$watch(()=>t.$locale,n=>{e.setLocale(n)})}function bo(){return typeof uni!="undefined"&&uni.getLocale?uni.getLocale():typeof global!="undefined"&&global.getLocale?global.getLocale():le}function ls(t,e={},n,s){if(typeof t!="string"){let r=[e,t];t=r[0],e=r[1]}typeof t!="string"&&(t=bo()),typeof n!="string"&&(n=typeof __uniConfig!="undefined"&&__uniConfig.fallbackLocale||le);let i=new Ot({locale:t,fallbackLocale:n,messages:e,watcher:s}),o=(r,a)=>{if(typeof getApp!="function")o=function(l,c){return i.t(l,c)};else{let l=!1;o=function(c,g){let d=getApp().$vm;return d&&(d.$locale,l||(l=!0,wo(d,i))),i.t(c,g)}}return o(r,a)};return{i18n:i,f(r,a,l){return i.f(r,a,l)},t(r,a){return o(r,a)},add(r,a,l=!0){return i.add(r,a,l)},watch(r){return i.watchLocale(r)},getLocale(){return i.getLocale()},setLocale(r){return i.setLocale(r)}}}var So={"uni-search-bar.cancel":"cancel","uni-search-bar.placeholder":"Search enter content"},vo={"uni-search-bar.cancel":"\u53D6\u6D88","uni-search-bar.placeholder":"\u8BF7\u8F93\u5165\u641C\u7D22\u5185\u5BB9"},xo={"uni-search-bar.cancel":"\u53D6\u6D88","uni-search-bar.placeholder":"\u8ACB\u8F38\u5165\u641C\u7D22\u5167\u5BB9"},ko={en:So,"zh-Hans":vo,"zh-Hant":xo},To={"uni-searchbar":{"":{flexDirection:"row",position:"relative",paddingTop:10,paddingRight:10,paddingBottom:10,paddingLeft:10}},"uni-searchbar__box":{"":{overflow:"hidden",position:"relative",flex:1,justifyContent:"center",flexDirection:"row",alignItems:"center",height:36,paddingTop:5,paddingRight:8,paddingBottom:5,paddingLeft:0}},"uni-searchbar__box-icon-search":{"":{flexDirection:"row",paddingTop:0,paddingRight:8,paddingBottom:0,paddingLeft:8,justifyContent:"center",alignItems:"center",color:"#B3B3B3"}},"uni-searchbar__box-search-input":{"":{flex:1,fontSize:14,color:"#333333"}},"uni-searchbar__box-icon-clear":{"":{alignItems:"center",lineHeight:24,paddingLeft:8}},"uni-searchbar__text-placeholder":{"":{fontSize:14,color:"#B3B3B3",marginLeft:5}},"uni-searchbar__cancel":{"":{paddingLeft:10,lineHeight:36,fontSize:14,color:"#333333"}}},{t:vn}=ls(ko),Io={name:"UniSearchBar",emits:["input","update:modelValue","clear","cancel","confirm","blur","focus"],props:{placeholder:{type:String,default:""},radius:{type:[Number,String],default:5},clearButton:{type:String,default:"auto"},cancelButton:{type:String,default:"auto"},cancelText:{type:String,default:""},bgColor:{type:String,default:"#F8F8F8"},maxlength:{type:[Number,String],default:100},value:{type:[Number,String],default:""},modelValue:{type:[Number,String],default:""},focus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},data(){return{show:!1,showSync:!1,searchVal:""}},computed:{cancelTextI18n(){return this.cancelText||vn("uni-search-bar.cancel")},placeholderText(){return this.placeholder||vn("uni-search-bar.placeholder")}},watch:{modelValue:{immediate:!0,handler(t){this.searchVal=t,t&&(this.show=!0)}},focus:{immediate:!0,handler(t){if(t){if(this.readonly)return;this.show=!0,this.$nextTick(()=>{this.showSync=!0})}}},searchVal(t,e){this.$emit("input",t),this.$emit("update:modelValue",t)}},methods:{searchClick(){this.readonly||this.show||(this.show=!0,this.$nextTick(()=>{this.showSync=!0}))},clear(){this.$emit("clear",{value:this.searchVal}),this.searchVal=""},cancel(){this.readonly||(this.$emit("cancel",{value:this.searchVal}),this.searchVal="",this.show=!1,this.showSync=!1,plus.key.hideSoftKeybord())},confirm(){plus.key.hideSoftKeybord(),this.$emit("confirm",{value:this.searchVal})},blur(){plus.key.hideSoftKeybord(),this.$emit("blur",{value:this.searchVal})},emitFocus(t){this.$emit("focus",t.detail)}}};function Co(t,e,n,s,i,o){let r=X((0,u.resolveDynamicComponent)("uni-icons"),Ft);return(0,u.openBlock)(),(0,u.createElementBlock)("view",{class:"uni-searchbar",renderWhole:!0},[(0,u.createElementVNode)("view",{style:(0,u.normalizeStyle)({borderRadius:n.radius+"px",backgroundColor:n.bgColor}),class:"uni-searchbar__box",onClick:e[5]||(e[5]=(...a)=>o.searchClick&&o.searchClick(...a))},[(0,u.createElementVNode)("view",{class:"uni-searchbar__box-icon-search"},[(0,u.renderSlot)(t.$slots,"searchIcon",{},()=>[(0,u.createVNode)(r,{color:"#c0c4cc",size:"18",type:"search"})])]),i.show||i.searchVal?((0,u.openBlock)(),(0,u.createElementBlock)("u-input",{key:0,focus:i.showSync,disabled:n.readonly,placeholder:o.placeholderText,maxlength:n.maxlength,class:"uni-searchbar__box-search-input",confirmType:"search",type:"text",modelValue:i.searchVal,onInput:e[0]||(e[0]=a=>i.searchVal=a.detail.value),onConfirm:e[1]||(e[1]=(...a)=>o.confirm&&o.confirm(...a)),onBlur:e[2]||(e[2]=(...a)=>o.blur&&o.blur(...a)),onFocus:e[3]||(e[3]=(...a)=>o.emitFocus&&o.emitFocus(...a))},null,40,["focus","disabled","placeholder","maxlength","modelValue"])):((0,u.openBlock)(),(0,u.createElementBlock)("u-text",{key:1,class:"uni-searchbar__text-placeholder"},(0,u.toDisplayString)(n.placeholder),1)),i.show&&(n.clearButton==="always"||n.clearButton==="auto"&&i.searchVal!=="")&&!n.readonly?((0,u.openBlock)(),(0,u.createElementBlock)("view",{key:2,class:"uni-searchbar__box-icon-clear",onClick:e[4]||(e[4]=(...a)=>o.clear&&o.clear(...a))},[(0,u.renderSlot)(t.$slots,"clearIcon",{},()=>[(0,u.createVNode)(r,{color:"#c0c4cc",size:"20",type:"clear"})])])):(0,u.createCommentVNode)("",!0)],4),n.cancelButton==="always"||i.show&&n.cancelButton==="auto"?((0,u.openBlock)(),(0,u.createElementBlock)("u-text",{key:0,onClick:e[6]||(e[6]=(...a)=>o.cancel&&o.cancel(...a)),class:"uni-searchbar__cancel"},(0,u.toDisplayString)(o.cancelTextI18n),1)):(0,u.createCommentVNode)("",!0)])}var Ao=Q(Io,[["render",Co],["styles",[To]]]),Po={"uniCloud.component.add.success":"Success","uniCloud.component.update.success":"Success","uniCloud.component.remove.showModal.title":"Tips","uniCloud.component.remove.showModal.content":"\u662F\u5426\u5220\u9664\u8BE5\u6570\u636E"},Lo={"uniCloud.component.add.success":"\u65B0\u589E\u6210\u529F","uniCloud.component.update.success":"\u4FEE\u6539\u6210\u529F","uniCloud.component.remove.showModal.title":"\u63D0\u793A","uniCloud.component.remove.showModal.content":"\u662F\u5426\u5220\u9664\u8BE5\u6570\u636E"},Oo={"uniCloud.component.add.success":"\u65B0\u589E\u6210\u529F","uniCloud.component.update.success":"\u4FEE\u6539\u6210\u529F","uniCloud.component.remove.showModal.title":"\u63D0\u793A","uniCloud.component.remove.showModal.content":"\u662F\u5426\u5220\u9664\u8BE5\u6570\u636E"},Eo={"uniCloud.component.add.success":"\u65B0\u589E\u6210\u529F","uniCloud.component.update.success":"\u4FEE\u6539\u6210\u529F","uniCloud.component.remove.showModal.title":"\u63D0\u793A","uniCloud.component.remove.showModal.content":"\u662F\u5426\u5220\u9664\u8BE5\u6570\u636E"},Ro={"uniCloud.component.add.success":"\u65B0\u589E\u6210\u529F","uniCloud.component.update.success":"\u4FEE\u6539\u6210\u529F","uniCloud.component.remove.showModal.title":"\u63D0\u793A","uniCloud.component.remove.showModal.content":"\u662F\u5426\u522A\u9664\u6578\u64DA"},Do={en:Po,es:Lo,fr:Oo,"zh-Hans":Eo,"zh-Hant":Ro},ct=Array.isArray,{t:De}=ls(Do),xn={load:"load",error:"error"},Ne={add:"add",replace:"replace"},lt={auto:"auto",onready:"onready",manual:"manual"},No=["pageCurrent","pageSize","collection","action","field","getcount","orderby","where","groupby","groupField","distinct"],Uo={name:"UniClouddb",setup(t){let e=t.ssrKey?t.getone?$t(void 0,t.ssrKey):zt([],t.ssrKey):t.getone?$t(void 0,"Fr0Bix7QXnuHb5bm+Yxeuw=="):zt([],"V8fF9aQ8CzvIBD+E9MCQJA=="),n=(0,u.getCurrentInstance)();return(0,u.onMounted)(()=>{(!e.value||e.value.length===0)&&!t.manual&&t.loadtime===lt.auto&&n.proxy.loadData()}),{dataList:e}},serverPrefetch(){return P(this,null,function*(){if(!this.manual&&this.loadtime===lt.auto)return this.loadData()})},props:{options:{type:[Object,Array],default(){return{}}},spaceInfo:{type:Object,default(){return{}}},collection:{type:[String,Array],default:""},action:{type:String,default:""},field:{type:String,default:""},orderby:{type:String,default:""},where:{type:[String,Object],default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:20},getcount:{type:[Boolean,String],default:!1},getone:{type:[Boolean,String],default:!1},gettree:{type:[Boolean,String,Object],default:!1},gettreepath:{type:[Boolean,String],default:!1},startwith:{type:String,default:""},limitlevel:{type:Number,default:10},groupby:{type:String,default:""},groupField:{type:String,default:""},distinct:{type:[Boolean,String],default:!1},pageIndistinct:{type:[Boolean,String],default:!1},foreignKey:{type:String,default:""},loadtime:{type:String,default:"auto"},manual:{type:Boolean,default:!1},ssrKey:{type:[String,Number],default:""}},data(){return{loading:!1,hasMore:!1,paginationInternal:{},errorMessage:""}},computed:{collectionArgs(){return ct(this.collection)?this.collection:[this.collection]},isLookup(){return ct(this.collection)&&this.collection.length>1||typeof this.collection=="string"&&this.collection.indexOf(",")>-1},mainCollection(){return typeof this.collection=="string"?this.collection.split(",")[0]:JSON.parse(JSON.stringify(this.collection[0])).$db[0].$param[0]}},created(){this._isEnded=!1,this.paginationInternal={current:this.pageCurrent,size:this.pageSize,count:0},this.$watch(()=>{var t=[];return No.forEach(e=>{t.push(this[e])}),t},(t,e)=>{if(this.paginationInternal.size=this.pageSize,t[0]!==e[0]&&(this.paginationInternal.current=this.pageCurrent),this.loadtime===lt.manual)return;let n=!1;for(let s=2;s<t.length;s++)if(t[s]!==e[s]){n=!0;break}n&&(this.clear(),this.reset()),this._execLoadData()})},methods:{loadData(t,e){let n=null,s=!1;return typeof t=="object"?(t.clear&&(this.pageData===Ne.replace?this.clear():s=t.clear,this.reset()),t.current!==void 0&&(this.paginationInternal.current=t.current),typeof e=="function"&&(n=e)):typeof t=="function"&&(n=t),this._execLoadData(n,s)},loadMore(){this._isEnded||this.loading||(this.pageData===Ne.add&&this.paginationInternal.current++,this._execLoadData())},refresh(){this.clear(),this._execLoadData()},clear(){this._isEnded=!1,this.dataList=[]},reset(){this.paginationInternal.current=1},add(t,{action:e,showToast:n=!0,toastTitle:s,success:i,fail:o,complete:r,needConfirm:a=!0,needLoading:l=!0,loadingTitle:c=""}={}){l&&uni.showLoading({title:c});let g=me.database(this.spaceInfo);e&&(g=g.action(e)),g.collection(this.mainCollection).add(t).then(d=>{i&&i(d),n&&uni.showToast({title:s||De("uniCloud.component.add.success")})}).catch(d=>{o&&o(d),a&&uni.showModal({content:d.message,showCancel:!1})}).finally(()=>{l&&uni.hideLoading(),r&&r()})},remove(t,{action:e,success:n,fail:s,complete:i,confirmTitle:o,confirmContent:r,needConfirm:a=!0,needLoading:l=!0,loadingTitle:c=""}={}){if(!(!t||!t.length)){if(!a){this._execRemove(t,e,n,s,i,a,l,c);return}uni.showModal({title:o||De("uniCloud.component.remove.showModal.title"),content:r||De("uniCloud.component.remove.showModal.content"),showCancel:!0,success:g=>{g.confirm&&this._execRemove(t,e,n,s,i,a,l,c)}})}},update(t,e,{action:n,showToast:s=!0,toastTitle:i,success:o,fail:r,complete:a,needConfirm:l=!0,needLoading:c=!0,loadingTitle:g=""}={}){c&&uni.showLoading({title:g});let d=me.database(this.spaceInfo);return n&&(d=d.action(n)),d.collection(this.mainCollection).doc(t).update(e).then(p=>{o&&o(p),s&&uni.showToast({title:i||De("uniCloud.component.update.success")})}).catch(p=>{r&&r(p),l&&uni.showModal({content:p.message,showCancel:!1})}).finally(()=>{c&&uni.hideLoading(),a&&a()})},getTemp(t=!0){let e=me.database(this.spaceInfo);this.action&&(e=e.action(this.action)),e=e.collection(...this.collectionArgs),this.foreignKey&&(e=e.foreignKey(this.foreignKey)),!this.where||!Object.keys(this.where).length||(e=e.where(this.where)),this.field&&(e=e.field(this.field)),this.groupby&&(e=e.groupBy(this.groupby)),this.groupField&&(e=e.groupField(this.groupField)),this.distinct===!0&&(e=e.distinct()),this.orderby&&(e=e.orderBy(this.orderby));let{current:n,size:s}=this.paginationInternal,i={};this.getcount&&(i.getCount=this.getcount);let o={limitLevel:this.limitlevel,startWith:this.startwith};return this.gettree&&(i.getTree=o),this.gettreepath&&(i.getTreePath=o),e=e.skip(s*(n-1)).limit(s),t?(e=e.getTemp(i),e.udb=this):e=e.get(i),e},setResult(t){t.code===0?this._execLoadDataSuccess(t):this._execLoadDataFail(new Error(t.message))},_execLoadData(t,e){if(!this.loading)return this.loading=!0,this.errorMessage="",this._getExec().then(n=>{this.loading=!1,this._execLoadDataSuccess(n.result,t,e)}).catch(n=>{this.loading=!1,this._execLoadDataFail(n,t)})},_execLoadDataSuccess(t,e,n){let{data:s,count:i}=t;this._isEnded=i!==void 0?this.paginationInternal.current*this.paginationInternal.size>=i:s.length<this.pageSize,this.hasMore=!this._isEnded;let o=this.getone?s.length?s[0]:void 0:s;this.getcount&&(this.paginationInternal.count=i),e&&e(o,this._isEnded,this.paginationInternal),this._dispatchEvent(xn.load,o),this.getone||this.pageData===Ne.replace?this.dataList=o:n?this.dataList=o:this.dataList.push(...o)},_execLoadDataFail(t,e){this.errorMessage=t,e&&e(),this.$emit(xn.error,t)},_getExec(){return this.getTemp(!1)},_execRemove(t,e,n,s,i,o,r,a){if(!this.collection||!t)return;let l=ct(t)?t:[t];if(!l.length)return;r&&uni.showLoading({mask:!0,title:a});let c=me.database(this.spaceInfo),g=c.command,d=c;e&&(d=d.action(e)),d.collection(this.mainCollection).where({_id:g.in(l)}).remove().then(p=>{n&&n(p.result),this.pageData===Ne.replace?this.refresh():this.removeData(l)}).catch(p=>{s&&s(p),o&&uni.showModal({content:p.message,showCancel:!1})}).finally(()=>{r&&uni.hideLoading(),i&&i()})},removeData(t){let e=t.slice(0),n=this.dataList;for(let s=n.length-1;s>=0;s--){let i=e.indexOf(n[s]._id);i>=0&&(n.splice(s,1),e.splice(i,1))}},_dispatchEvent(t,e){this._changeDataFunction?this._changeDataFunction(e,this._isEnded,this.paginationInternal):this.$emit(t,e,this._isEnded,this.paginationInternal)}}};function Fo(t,e,n,s,i,o){return(0,u.openBlock)(),(0,u.createElementBlock)("view",{renderWhole:!0},[(0,u.renderSlot)(t.$slots,"default",{options:n.options,data:s.dataList,pagination:i.paginationInternal,loading:i.loading,hasMore:i.hasMore,error:i.errorMessage})])}var Bo=Q(Uo,[["render",Fo]]),Mo={"uni-badge--x":{"":{position:"relative"}},"uni-badge--absolute":{"":{position:"absolute"}},"uni-badge--small":{"":{transform:"scale(0.8)",transformOrigin:"center center"}},"uni-badge":{"":{justifyContent:"center",flexDirection:"row",height:20,paddingTop:0,paddingRight:4,paddingBottom:0,paddingLeft:4,lineHeight:18,color:"#ffffff",borderRadius:100,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderStyle:"solid",borderColor:"#ffffff",textAlign:"center",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSize:12}},"uni-badge--info":{"":{color:"#ffffff",backgroundColor:"#909399"}},"uni-badge--primary":{"":{backgroundColor:"#2979ff"}},"uni-badge--success":{"":{backgroundColor:"#4cd964"}},"uni-badge--warning":{"":{backgroundColor:"#f0ad4e"}},"uni-badge--error":{"":{backgroundColor:"#dd524d"}},"uni-badge--inverted":{"":{paddingTop:0,paddingRight:5,paddingBottom:0,paddingLeft:0,color:"#909399"}},"uni-badge--info-inverted":{"":{color:"#909399",backgroundColor:"rgba(0,0,0,0)"}},"uni-badge--primary-inverted":{"":{color:"#2979ff",backgroundColor:"rgba(0,0,0,0)"}},"uni-badge--success-inverted":{"":{color:"#4cd964",backgroundColor:"rgba(0,0,0,0)"}},"uni-badge--warning-inverted":{"":{color:"#f0ad4e",backgroundColor:"rgba(0,0,0,0)"}},"uni-badge--error-inverted":{"":{color:"#dd524d",backgroundColor:"rgba(0,0,0,0)"}}},jo={name:"UniBadge",emits:["click"],props:{type:{type:String,default:"error"},inverted:{type:Boolean,default:!1},isDot:{type:Boolean,default:!1},maxNum:{type:Number,default:99},absolute:{type:String,default:""},offset:{type:Array,default(){return[0,0]}},text:{type:[String,Number],default:""},size:{type:String,default:"small"},customStyle:{type:Object,default(){return{}}}},data(){return{}},computed:{width(){return String(this.text).length*8+12},classNames(){let{inverted:t,type:e,size:n,absolute:s}=this;return[t?"uni-badge--"+e+"-inverted":"","uni-badge--"+e,"uni-badge--"+n,s?"uni-badge--absolute":""].join(" ")},positionStyle(){if(!this.absolute)return{};let t=this.width/2,e=10;this.isDot&&(t=5,e=5);let n=`${-t+this.offset[0]}px`,s=`${-e+this.offset[1]}px`,i={rightTop:{right:n,top:s},rightBottom:{right:n,bottom:s},leftBottom:{left:n,bottom:s},leftTop:{left:n,top:s}},o=i[this.absolute];return o||i.rightTop},dotStyle(){return this.isDot?{width:"10px",minWidth:"0",height:"10px",padding:"0",borderRadius:"10px"}:{}},displayValue(){let{isDot:t,text:e,maxNum:n}=this;return t?"":Number(e)>n?`${n}+`:e}},methods:{onClick(){this.$emit("click")}}};function qo(t,e,n,s,i,o){return(0,u.openBlock)(),(0,u.createElementBlock)("view",{class:"uni-badge--x",renderWhole:!0},[(0,u.renderSlot)(t.$slots,"default"),n.text?((0,u.openBlock)(),(0,u.createElementBlock)("u-text",{key:0,class:(0,u.normalizeClass)([o.classNames,"uni-badge"]),style:(0,u.normalizeStyle)([o.positionStyle,n.customStyle,o.dotStyle]),onClick:e[0]||(e[0]=r=>o.onClick())},(0,u.toDisplayString)(o.displayValue),7)):(0,u.createCommentVNode)("",!0)])}var Ko=Q(jo,[["render",qo],["styles",[Mo]]]),Ho={"uni-list-item":{"":{fontSize:16,position:"relative",justifyContent:"space-between",alignItems:"center",backgroundColor:"#ffffff",flexDirection:"row"}},"uni-list-item--disabled":{"":{opacity:.3}},"uni-list-item--hover":{"":{backgroundColor:"#f1f1f1"}},"uni-list-item__container":{"":{position:"relative",flexDirection:"row",paddingTop:12,paddingRight:15,paddingBottom:12,paddingLeft:15,flex:1,overflow:"hidden"}},"container--right":{"":{paddingRight:0}},"uni-list--border":{"":{position:"absolute",top:0,right:0,left:0,borderTopColor:"#e5e5e5",borderTopStyle:"solid",borderTopWidth:.5}},"uni-list-item__content":{"":{paddingRight:8,flex:1,color:"#3b4144",flexDirection:"column",justifyContent:"space-between",overflow:"hidden"}},"uni-list-item__content--center":{"":{justifyContent:"center"}},"uni-list-item__content-title":{"":{fontSize:14,color:"#3b4144",overflow:"hidden"}},"uni-list-item__content-note":{"":{marginTop:"6rpx",color:"#999999",fontSize:12,overflow:"hidden"}},"uni-list-item__extra":{"":{flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},"uni-list-item__header":{"":{flexDirection:"row",alignItems:"center"}},"uni-list-item__icon":{"":{marginRight:"18rpx",flexDirection:"row",justifyContent:"center",alignItems:"center"}},"uni-list-item__icon-img":{"":{height:26,width:26,marginRight:10}},"uni-icon-wrapper":{"":{alignItems:"center",paddingTop:0,paddingRight:10,paddingBottom:0,paddingLeft:10}},"flex--direction":{"":{flexDirection:"column"}},"uni-list--lg":{"":{height:40,width:40}},"uni-list--base":{"":{height:26,width:26}},"uni-list--sm":{"":{height:20,width:20}},"uni-list-item__extra-text":{"":{color:"#999999",fontSize:12}},"uni-ellipsis-1":{"":{lines:1,textOverflow:"ellipsis"}},"uni-ellipsis-2":{"":{lines:2,textOverflow:"ellipsis"}}},zo={name:"UniListItem",emits:["click","switchChange"],props:{direction:{type:String,default:"row"},title:{type:String,default:""},note:{type:String,default:""},ellipsis:{type:[Number,String],default:0},disabled:{type:[Boolean,String],default:!1},clickable:{type:Boolean,default:!1},showArrow:{type:[Boolean,String],default:!1},link:{type:[Boolean,String],default:!1},to:{type:String,default:""},showBadge:{type:[Boolean,String],default:!1},showSwitch:{type:[Boolean,String],default:!1},switchChecked:{type:[Boolean,String],default:!1},badgeText:{type:String,default:""},badgeType:{type:String,default:"success"},badgeStyle:{type:Object,default(){return{}}},rightText:{type:String,default:""},thumb:{type:String,default:""},thumbSize:{type:String,default:"base"},showExtraIcon:{type:[Boolean,String],default:!1},extraIcon:{type:Object,default(){return{type:"",color:"#000000",size:20,customPrefix:""}}},border:{type:Boolean,default:!0},customStyle:{type:Object,default(){return{padding:"",backgroundColor:"#FFFFFF"}}},keepScrollPosition:{type:Boolean,default:!1}},watch:{"customStyle.padding":{handler(t){typeof t=="number"&&(t+="");let e=t.split(" ");if(e.length===1){let n=e[0];this.padding={top:n,right:n,bottom:n,left:n}}else if(e.length===2){let[n,s]=e;this.padding={top:n,right:s,bottom:n,left:s}}else if(e.length===4){let[n,s,i,o]=e;this.padding={top:n,right:s,bottom:i,left:o}}},immediate:!0}},data(){return{isFirstChild:!1,padding:{top:"",right:"",bottom:"",left:""}}},mounted(){this.list=this.getForm(),this.list&&(this.list.firstChildAppend||(this.list.firstChildAppend=!0,this.isFirstChild=!0))},methods:{getForm(t="uniList"){let e=this.$parent,n=e.$options.name;for(;n!==t;){if(e=e.$parent,!e)return!1;n=e.$options.name}return e},onClick(){if(this.to!==""){this.openPage();return}(this.clickable||this.link)&&this.$emit("click",{data:{}})},onSwitchChange(t){this.$emit("switchChange",t.detail)},openPage(){["navigateTo","redirectTo","reLaunch","switchTab"].indexOf(this.link)!==-1?this.pageApi(this.link):this.pageApi("navigateTo")},pageApi(t){let e={url:this.to,success:n=>{this.$emit("click",{data:n})},fail:n=>{this.$emit("click",{data:n})}};switch(t){case"navigateTo":uni.navigateTo(e);break;case"redirectTo":uni.redirectTo(e);break;case"reLaunch":uni.reLaunch(e);break;case"switchTab":uni.switchTab(e);break;default:uni.navigateTo(e)}}}};function $o(t,e,n,s,i,o){let r=X((0,u.resolveDynamicComponent)("uni-icons"),Ft),a=X((0,u.resolveDynamicComponent)("uni-badge"),Ko),l=(0,u.resolveComponent)("switch");return(0,u.openBlock)(),(0,u.createElementBlock)("cell",{keepScrollPosition:n.keepScrollPosition},[(0,u.createElementVNode)("view",{class:(0,u.normalizeClass)([{"uni-list-item--disabled":n.disabled},"uni-list-item"]),style:(0,u.normalizeStyle)({"background-color":n.customStyle.backgroundColor}),hoverClass:!n.clickable&&!n.link||n.disabled||n.showSwitch?"":"uni-list-item--hover",onClick:e[0]||(e[0]=(...c)=>o.onClick&&o.onClick(...c))},[i.isFirstChild?(0,u.createCommentVNode)("",!0):((0,u.openBlock)(),(0,u.createElementBlock)("view",{key:0,class:(0,u.normalizeClass)(["border--left",{"uni-list--border":n.border}])},null,2)),(0,u.createElementVNode)("view",{class:(0,u.normalizeClass)(["uni-list-item__container",{"container--right":n.showArrow||n.link,"flex--direction":n.direction==="column"}]),style:(0,u.normalizeStyle)({paddingTop:i.padding.top,paddingLeft:i.padding.left,paddingRight:i.padding.right,paddingBottom:i.padding.bottom})},[(0,u.renderSlot)(t.$slots,"header",{},()=>[(0,u.createElementVNode)("view",{class:"uni-list-item__header"},[n.thumb?((0,u.openBlock)(),(0,u.createElementBlock)("view",{key:0,class:"uni-list-item__icon"},[(0,u.createElementVNode)("u-image",{src:n.thumb,class:(0,u.normalizeClass)(["uni-list-item__icon-img",["uni-list--"+n.thumbSize]])},null,10,["src"])])):n.showExtraIcon?((0,u.openBlock)(),(0,u.createElementBlock)("view",{key:1,class:"uni-list-item__icon"},[(0,u.createVNode)(r,{customPrefix:n.extraIcon.customPrefix,color:n.extraIcon.color,size:n.extraIcon.size,type:n.extraIcon.type},null,8,["customPrefix","color","size","type"])])):(0,u.createCommentVNode)("",!0)])]),(0,u.renderSlot)(t.$slots,"body",{},()=>[(0,u.createElementVNode)("view",{class:(0,u.normalizeClass)(["uni-list-item__content",{"uni-list-item__content--center":n.thumb||n.showExtraIcon||n.showBadge||n.showSwitch}])},[n.title?((0,u.openBlock)(),(0,u.createElementBlock)("u-text",{key:0,class:(0,u.normalizeClass)(["uni-list-item__content-title",[n.ellipsis!==0&&n.ellipsis<=2?"uni-ellipsis-"+n.ellipsis:""]])},(0,u.toDisplayString)(n.title),3)):(0,u.createCommentVNode)("",!0),n.note?((0,u.openBlock)(),(0,u.createElementBlock)("u-text",{key:1,class:"uni-list-item__content-note"},(0,u.toDisplayString)(n.note),1)):(0,u.createCommentVNode)("",!0)],2)]),(0,u.renderSlot)(t.$slots,"footer",{},()=>[n.rightText||n.showBadge||n.showSwitch?((0,u.openBlock)(),(0,u.createElementBlock)("view",{key:0,class:(0,u.normalizeClass)(["uni-list-item__extra",{"flex--justify":n.direction==="column"}])},[n.rightText?((0,u.openBlock)(),(0,u.createElementBlock)("u-text",{key:0,class:"uni-list-item__extra-text"},(0,u.toDisplayString)(n.rightText),1)):(0,u.createCommentVNode)("",!0),n.showBadge?((0,u.openBlock)(),(0,u.createBlock)(a,{key:1,type:n.badgeType,text:n.badgeText,"custom-style":n.badgeStyle},null,8,["type","text","custom-style"])):(0,u.createCommentVNode)("",!0),n.showSwitch?((0,u.openBlock)(),(0,u.createBlock)(l,{key:2,disabled:n.disabled,checked:n.switchChecked,onChange:o.onSwitchChange},null,8,["disabled","checked","onChange"])):(0,u.createCommentVNode)("",!0)],2)):(0,u.createCommentVNode)("",!0)])],6),n.showArrow||n.link?((0,u.openBlock)(),(0,u.createBlock)(r,{key:1,size:16,class:"uni-icon-wrapper",color:"#bbb",type:"arrowright"})):(0,u.createCommentVNode)("",!0)],14,["hoverClass"])],8,["keepScrollPosition"])}var Vo=Q(zo,[["render",$o],["styles",[Ho]]]),Wo={"uni-list":{"":{backgroundColor:"#ffffff",position:"relative",flexDirection:"column"}},"uni-list--border":{"":{position:"relative",borderTopColor:"#e5e5e5",borderTopStyle:"solid",borderTopWidth:.5,borderBottomColor:"#e5e5e5",borderBottomStyle:"solid",borderBottomWidth:.5,zIndex:-1}}},Jo={name:"uniList","mp-weixin":{options:{multipleSlots:!1}},props:{stackFromEnd:{type:Boolean,default:!1},enableBackToTop:{type:[Boolean,String],default:!1},scrollY:{type:[Boolean,String],default:!1},border:{type:Boolean,default:!0},renderReverse:{type:Boolean,default:!1}},created(){this.firstChildAppend=!1},methods:{loadMore(t){this.$emit("scrolltolower")},scroll(t){this.$emit("scroll",t)}}};function Go(t,e,n,s,i,o){return(0,u.openBlock)(),(0,u.createElementBlock)("list",{bounce:!1,scrollable:!0,showScrollbar:"",renderReverse:n.renderReverse,onScroll:e[0]||(e[0]=(...r)=>o.scroll&&o.scroll(...r)),class:(0,u.normalizeClass)(["uni-list",{"uni-list--border":n.border}]),enableBackToTop:n.enableBackToTop,loadmoreoffset:"15"},[(0,u.renderSlot)(t.$slots,"default")],42,["renderReverse","enableBackToTop"])}var Qo=Q(Jo,[["render",Go],["styles",[Wo]]]),Yo={"status-bar":{"":{backgroundColor:"#ffffff"}},container:{"":{flex:1,backgroundColor:"#f7f7f7"}},"search-body":{"":{backgroundColor:"#ffffff",borderBottomRightRadius:10,borderBottomLeftRadius:10}},"flex-center":{"":{justifyContent:"center",alignItems:"center"}},"flex-row":{"":{flexDirection:"row"}},"uni-searchbar":{"":{paddingLeft:0}},"uni-searchbar__box":{"":{borderWidth:0}},"uni-input-placeholder":{"":{fontSize:"28rpx"}},"search-container":{"":{height:52,flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",backgroundColor:"#ffffff"}},"search-container-bar":{"":{flexDirection:"row",justifyContent:"center",alignItems:"center",position:"absolute",top:0,left:0,right:0}},"search-associative":{"":{position:"absolute",top:52,left:0,right:0,bottom:0,backgroundColor:"#ffffff",marginTop:"10rpx",paddingLeft:"10rpx",paddingRight:"10rpx"}},"search-icons":{"":{paddingTop:"16rpx",paddingRight:"16rpx",paddingBottom:"16rpx",paddingLeft:"16rpx"}},"word-display":{"":{fontSize:"26rpx",color:"#666666"}},"word-container":{"":{paddingTop:"20rpx",paddingRight:"20rpx",paddingBottom:"20rpx",paddingLeft:"20rpx"}},"word-container_header":{"":{height:"72rpx",lineHeight:"72rpx",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},"word-container_header-text":{"":{color:"#3e3e3e",fontSize:"30rpx",fontWeight:"bold"}},"word-container_body":{"":{flexWrap:"wrap",flexDirection:"row"}},"word-container_body-text":{"":{fontSize:"26rpx",color:"#666666",justifyContent:"center",alignItems:"center",backgroundColor:"#f6f6f6",paddingTop:"10rpx",paddingRight:"20rpx",paddingBottom:"10rpx",paddingLeft:"20rpx",marginTop:"20rpx",marginRight:"30rpx",marginBottom:0,marginLeft:0,borderRadius:"30rpx",textAlign:"center"}},"word-container_body-info":{"":{flex:1,textAlign:"center",fontSize:"26rpx",color:"#808080",marginTop:"20rpx"}}},Xo="opendb-search-log",Zo="opendb-news-articles",er="title",tr="_id,title",pe="__local_search_history",nr=t=>{for(let e=t.length-1;e>=0;e--){let n=t.indexOf(t[e]),s=t.lastIndexOf(t[e]);n!=s&&t.splice(s,1)}return t};function sr(t,e,n){var s=t,i=null,o=!0;return n&&s(),function(){var r=arguments,a=this;o&&(o=!1,s.apply(a,r)),i&&clearTimeout(i),i=setTimeout(function(){clearTimeout(i),i=null,s.apply(a,r)},e||200)}}var ir={data(){return{mallGoodsDbName:Zo,searchLogDbName:Xo,statusBarHeight:"0px",localSearchList:uni.getStorageSync(pe),localSearchListDel:!1,netHotListIsHide:!1,searchText:"",iconColor:"#999999",associativeList:[],keyBoardPopup:!1,hotWorld:"DCloud",focus:!0,speechEngine:"iFly"}},created(){this.db=me.database(),this.searchLogDb=this.db.collection(this.searchLogDbName),this.mallGoodsDb=this.db.collection(this.mallGoodsDbName),uni.onKeyboardHeightChange(t=>{this.keyBoardPopup=t.height!==0}),this.searchText=getApp().globalData.searchText},computed:{associativeShow(){return this.searchText&&this.associativeList.length}},onLoad(){this.statusBarHeight=`${uni.getSystemInfoSync().statusBarHeight}px`},methods:{clear(t){Je("log","at pages/list/search/search.nvue:172","res: ",t)},confirm(t){this.search(t.value)},cancel(t){uni.hideKeyboard(),this.searchText="",this.loadList()},search(t){!t&&!this.hotWorld||(t?(this.searchText!==t&&(this.searchText=t),this.localSearchListManage(t),this.searchLogDbAdd(t)):this.hotWorld&&(this.searchText=this.hotWorld),uni.hideKeyboard(),this.loadList(this.searchText))},localSearchListManage(t){uni.getStorageSync(pe).length?(this.localSearchList.unshift(t),nr(this.localSearchList),this.localSearchList.length>10&&this.localSearchList.pop()):this.localSearchList=[t],uni.setStorageSync(pe,this.localSearchList)},LocalSearchListClear(){uni.showModal({content:"\u786E\u8BA4\u6E05\u7A7A\u641C\u7D22\u5386\u53F2\u5417",confirmText:"\u5220\u9664",confirmColor:"red",cancelColor:"#808080",success:t=>{t.confirm&&(this.localSearchListDel=!1,this.localSearchList=[],uni.removeStorageSync(pe))}})},LocalSearchlistItemClick(t,e){if(this.localSearchListDel){this.localSearchList.splice(e,1),uni.setStorageSync(pe,this.localSearchList),this.localSearchList.length||(this.localSearchListDel=!1);return}this.search(t)},searchHotRefresh(){this.$refs.udb.refresh()},speech(){plus.speech.startRecognize({engine:this.speechEngine,punctuation:!1,timeout:1e4},t=>{t=t instanceof Array?t[0]:t,this.search(t)},t=>{Je("error","at pages/list/search/search.nvue:254","\u8BED\u97F3\u8BC6\u522B\u9519\u8BEF: ",t)})},searchLogDbAdd(t){this.getDeviceId().then(e=>{this.searchLogDb.add({device_id:e,content:t,create_date:Date.now()})})},getDeviceId(){return new Promise((t,e)=>{let n=uni.getStorageSync("uni_id");n?t(n):plus.device.getInfo({success:s=>{t(s.uuid)},fail:()=>{t(uni.getSystemInfoSync().system+"_"+Math.random().toString(36).substr(2))}})})},associativeClick(t){Je("log","at pages/list/search/search.nvue:297","associativeClick: ",t),this.loadList(t.title)},loadList(t=""){getApp().globalData.searchText=t,uni.switchTab({url:"/pages/list/list"})},backPage(){uni.navigateBack()}},watch:{searchText:sr(function(t){t?this.mallGoodsDb.where({[er]:new RegExp(t,"gi")}).field(tr).get().then(e=>{this.associativeList=e.result.data}):(this.associativeList.length=0,getApp().globalData.searchText="")},100)}};function or(t,e,n,s,i,o){let r=X((0,u.resolveDynamicComponent)("uni-icons"),Ft),a=X((0,u.resolveDynamicComponent)("uni-search-bar"),Ao),l=X((0,u.resolveDynamicComponent)("unicloud-db"),Bo),c=X((0,u.resolveDynamicComponent)("uni-list-item"),Vo),g=X((0,u.resolveDynamicComponent)("uni-list"),Qo);return(0,u.openBlock)(),(0,u.createElementBlock)("scroll-view",{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true",style:{flexDirection:"column"}},[(0,u.createElementVNode)("view",{class:"container"},[(0,u.createElementVNode)("view",{class:"search-container"},[(0,u.createElementVNode)("view",{class:"search-container-bar"},[(0,u.createVNode)(r,{class:"search-icons",color:i.iconColor,size:"22",type:"mic-filled",onClick:o.speech},null,8,["color","onClick"]),(0,u.createVNode)(a,{ref:"searchBar",style:{flex:"1"},radius:"100",modelValue:i.searchText,"onUpdate:modelValue":e[0]||(e[0]=d=>i.searchText=d),focus:i.focus,placeholder:i.hotWorld,clearButton:"auto",cancelButton:"always",onClear:o.clear,onConfirm:o.confirm,onCancel:o.cancel},null,8,["modelValue","focus","placeholder","onClear","onConfirm","onCancel"])])]),(0,u.createElementVNode)("view",{class:"search-body"},[i.localSearchList.length?((0,u.openBlock)(),(0,u.createElementBlock)("view",{key:0,class:"word-container"},[(0,u.createElementVNode)("view",{class:"word-container_header"},[(0,u.createElementVNode)("u-text",{class:"word-container_header-text"},"\u641C\u7D22\u5386\u53F2"),i.localSearchListDel?((0,u.openBlock)(),(0,u.createElementBlock)("view",{key:1,class:"flex-center flex-row",style:{"font-weight":"500","justify-content":"space-between"}},[(0,u.createElementVNode)("u-text",{style:{"font-size":"22rpx",color:"#666","padding-top":"4rpx","padding-bottom":"4rpx","padding-right":"20rpx"},onClick:e[2]||(e[2]=(...d)=>o.LocalSearchListClear&&o.LocalSearchListClear(...d))},"\u5168\u90E8\u5220\u9664"),(0,u.createElementVNode)("u-text",{style:{"font-size":"22rpx",color:"#c0402b","padding-top":"4rpx","padding-bottom":"4rpx","padding-left":"20rpx"},onClick:e[3]||(e[3]=d=>i.localSearchListDel=!1)},"\u5B8C\u6210")])):((0,u.openBlock)(),(0,u.createBlock)(r,{key:0,onClick:e[1]||(e[1]=d=>i.localSearchListDel=!0),class:"search-icons",style:{"padding-right":"0"},color:i.iconColor,size:"18",type:"trash"},null,8,["color"]))]),(0,u.createElementVNode)("view",{class:"word-container_body"},[((0,u.openBlock)(!0),(0,u.createElementBlock)(u.Fragment,null,(0,u.renderList)(i.localSearchList,(d,p)=>((0,u.openBlock)(),(0,u.createElementBlock)("view",{class:"flex-center flex-row word-container_body-text",key:p,onClick:y=>o.LocalSearchlistItemClick(d,p)},[((0,u.openBlock)(),(0,u.createElementBlock)("u-text",{class:"word-display",key:d},(0,u.toDisplayString)(d),1)),i.localSearchListDel?((0,u.openBlock)(),(0,u.createBlock)(r,{key:0,size:"12",type:"closeempty"})):(0,u.createCommentVNode)("",!0)],8,["onClick"]))),128))])])):(0,u.createCommentVNode)("",!0),(0,u.createElementVNode)("view",{class:"word-container"},[(0,u.createElementVNode)("view",{class:"word-container_header"},[(0,u.createElementVNode)("view",{class:"flex-center flex-row"},[(0,u.createElementVNode)("u-text",{class:"word-container_header-text"},"\u641C\u7D22\u53D1\u73B0"),i.netHotListIsHide?(0,u.createCommentVNode)("",!0):((0,u.openBlock)(),(0,u.createBlock)(r,{key:0,class:"search-icons",color:i.iconColor,size:"14",type:"reload",onClick:o.searchHotRefresh},null,8,["color","onClick"]))]),(0,u.createVNode)(r,{class:"search-icons",style:{"padding-right":"0"},color:i.iconColor,size:"18",type:i.netHotListIsHide?"eye-slash":"eye",onClick:e[4]||(e[4]=d=>i.netHotListIsHide=!i.netHotListIsHide)},null,8,["color","type"])]),(0,u.createVNode)(l,{ref:"udb",field:"content",collection:"opendb-search-hot",orderby:"create_date desc,count desc","page-data":"replace","page-size":10},{default:(0,u.withCtx)(({data:d,loading:p,error:y,options:w})=>[p&&!i.netHotListIsHide?((0,u.openBlock)(),(0,u.createElementBlock)("u-text",{key:0,class:"word-container_body-info"},"\u6B63\u5728\u52A0\u8F7D...")):((0,u.openBlock)(),(0,u.createElementBlock)("view",{key:1,class:"word-container_body"},[i.netHotListIsHide?((0,u.openBlock)(),(0,u.createElementBlock)("view",{key:1,style:{flex:"1"}},[(0,u.createElementVNode)("u-text",{class:"word-container_body-info"},"\u5F53\u524D\u641C\u7D22\u53D1\u73B0\u5DF2\u9690\u85CF")])):((0,u.openBlock)(),(0,u.createElementBlock)(u.Fragment,{key:0},[y?((0,u.openBlock)(),(0,u.createElementBlock)("u-text",{key:0,class:"word-container_body-info"},(0,u.toDisplayString)(y.message),1)):((0,u.openBlock)(!0),(0,u.createElementBlock)(u.Fragment,{key:1},(0,u.renderList)(d,(f,h)=>((0,u.openBlock)(),(0,u.createElementBlock)("u-text",{class:"word-container_body-text",key:h,onClick:m=>o.search(f.content)},(0,u.toDisplayString)(f.content),9,["onClick"]))),128))],64))]))]),_:1},512)])]),o.associativeShow?((0,u.openBlock)(),(0,u.createElementBlock)("view",{key:0,class:"search-associative"},[(0,u.createVNode)(g,null,{default:(0,u.withCtx)(()=>[((0,u.openBlock)(!0),(0,u.createElementBlock)(u.Fragment,null,(0,u.renderList)(i.associativeList,(d,p)=>((0,u.openBlock)(),(0,u.createBlock)(c,{key:d._id,ellipsis:1,title:d.name,onClick:y=>o.associativeClick(d),"show-extra-icon":"",clickable:"","extra-icon":{size:18,color:i.iconColor,type:"search"}},null,8,["title","onClick","extra-icon"]))),128))]),_:1})])):(0,u.createCommentVNode)("",!0)])])}var Ve=Q(ir,[["render",or],["styles",[Yo]]]);var Bt=plus.webview.currentWebview();if(Bt){let t=parseInt(Bt.id),e="pages/list/search/search",n={};try{n=JSON.parse(Bt.__query__)}catch(i){}Ve.mpType="page";let s=Vue.createPageApp(Ve,{$store:getApp({allowDefault:!0}).$store,__pageId:t,__pagePath:e,__pageQuery:n});s.provide("__globalStyles",Vue.useCssStyles([...__uniConfig.styles,...Ve.styles||[]])),s.mount("#root")}})();
/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/
