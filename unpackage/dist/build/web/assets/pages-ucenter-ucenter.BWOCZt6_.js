import{p as e,B as t,l as s,m as a,s as i,N as o,O as l,x as n,c as r,w as c,i as u,o as d,a as f,e as g,t as m,b as p,d as h,F as _,f as k,z as w}from"./index-BFSQzsUc.js";import{_ as v}from"./cloud-image.iN2SoNPC.js";import{r as b}from"./uni-app.es.CkwVFIy4.js";import{_ as y}from"./uni-icons.Di0C3xcn.js";import{_ as x,a as I}from"./uni-list.CxxeKbhT.js";import{s as S}from"./store.WVsknOEV.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const L=e.database();const $=C({data(){return{ucenterList:[[{title:this.$t("mine.readArticles"),to:"/pages/grid/grid",icon:"flag"},{title:this.$t("mine.myScore"),to:"",event:"getScore",icon:"paperplane"}],[{title:this.$t("mine.feedback"),to:"/uni_modules/uni-feedback/pages/opendb-feedback/opendb-feedback",icon:"help"},{title:this.$t("mine.settings"),to:"/pages/ucenter/settings/settings",icon:"gear"}]],listStyles:{height:"150rpx",width:"150rpx",border:{color:"#eee",width:"1px",style:"solid",radius:"100%"}}}},onLoad(){},onShow(){},computed:{userInfo:()=>S.userInfo,hasLogin:()=>S.hasLogin,appConfig:()=>t().globalData.config},methods:{navigateToWallet(){this.hasLogin?a({url:"/pages/wallet/wallet"}):s({title:"请先登录",icon:"none"})},toSettings(){a({url:"/pages/ucenter/settings/settings"})},ucenterListClick(e){!e.to&&e.event?this[e.event]():e.to&&i({url:e.to,fail:()=>{a({url:e.to})}})},async checkVersion(){let e=await new Promise(((e,t)=>{t({message:"请在App中使用"})}));console.log(e),e.result.code>0||s({title:e.result.message,icon:"none"})},toUserInfo(){a({url:"/uni_modules/uni-id-pages/pages/userinfo/userinfo"})},gotoMarket(){},getScore(){if(!this.userInfo)return s({title:this.$t("mine.checkScore"),icon:"none"});o({mask:!0}),L.collection("uni-id-scores").where('"user_id" == $env.uid').field("score,balance").orderBy("create_date","desc").limit(1).get().then((e=>{console.log(e);const t=e.result.data[0];let a="";a=t?this.$t("mine.currentScore")+t.balance:this.$t("mine.noScore"),s({title:a,icon:"none"})})).finally((()=>{l()}))},async share(){let{result:e}=await L.collection("uni-id-users").where("'_id' == $cloudEnv_uid").field("my_invite_code").get(),t=e.data[0].my_invite_code;if(!t)return s({title:"请检查uni-config-center中uni-id配置，是否已启用 autoSetInviteCode",icon:"none"});console.log({myInviteCode:t});let{title:a,summary:i,imageUrl:o,href:l}=this.appConfig.shareInvite||{};uniShare.share({provider:["weixin","sinaweibo","qq"],scenes:["WXSceneSession","WXSceneTimeline","SinaWeibo","QQ"],type:0,href:l||location.origin+"/#/pages/ucenter/login-page/login-page?code="+t,title:a,summary:i,imageUrl:o})}}},[["render",function(e,t,s,a,i,o){const l=u,S=b(n("cloud-image"),v),C=b(n("uni-icons"),y),L=k,$=b(n("uni-list-item"),x),j=b(n("uni-list"),I);return d(),r(l,{class:"profile-container"},{default:c((()=>[f(l,{class:"profile-header"},{default:c((()=>[f(l,{class:"header-bg"}),f(l,{class:"user-profile"},{default:c((()=>[f(l,{class:"avatar-container",onClick:o.toUserInfo},{default:c((()=>[o.hasLogin&&o.userInfo.avatar_file&&o.userInfo.avatar_file.url?(d(),r(S,{key:0,width:"160rpx",height:"160rpx",src:o.userInfo.avatar_file.url,class:"avatar-image"},null,8,["src"])):(d(),r(l,{key:1,class:"default-avatar"},{default:c((()=>[f(C,{color:"#ffffff",size:"50",type:"person-filled"})])),_:1}))])),_:1},8,["onClick"]),f(l,{class:"user-info"},{default:c((()=>[f(L,{class:"username"},{default:c((()=>[g(m(o.hasLogin?o.userInfo.nickname||o.userInfo.username||o.userInfo.mobile:e.$t("mine.notLogged")),1)])),_:1})])),_:1})])),_:1})])),_:1}),f(l,{class:"wallet-card"},{default:c((()=>[f(l,{class:"wallet-header"},{default:c((()=>[f(L,{class:"wallet-title"},{default:c((()=>[g("我的钱包")])),_:1}),f(L,{class:"wallet-more",onClick:o.navigateToWallet},{default:c((()=>[g("查看详情 >")])),_:1},8,["onClick"])])),_:1}),f(l,{class:"wallet-content"},{default:c((()=>[f(l,{class:"wallet-item"},{default:c((()=>[f(L,{class:"amount"},{default:c((()=>[g(m(o.userInfo.balance||0),1)])),_:1}),f(L,{class:"label"},{default:c((()=>[g("余额")])),_:1})])),_:1})])),_:1})])),_:1}),f(l,{class:"function-lists"},{default:c((()=>[(d(!0),p(_,null,h(i.ucenterList,((e,t)=>(d(),r(j,{class:"function-list",key:t},{default:c((()=>[(d(!0),p(_,null,h(e,((e,t)=>(d(),r($,{key:t,title:e.title,link:!0,rightText:e.rightText,clickable:!0,to:e.to,onClick:t=>o.ucenterListClick(e),"show-extra-icon":!0,extraIcon:{type:e.icon,color:"#666"}},{footer:c((()=>[e.showBadge?(d(),r(l,{key:0,class:"item-footer"},{default:c((()=>[f(L,{class:"item-footer-text"},{default:c((()=>[g(m(e.rightText),1)])),_:2},1024),f(l,{class:"item-footer-badge"})])),_:2},1024)):w("",!0)])),_:2},1032,["title","rightText","to","onClick","extraIcon"])))),128))])),_:2},1024)))),128))])),_:1})])),_:1})}],["__scopeId","data-v-69ccc958"]]);export{$ as default};
