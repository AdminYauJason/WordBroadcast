import{_ as e,e as t,n as a,r as n,a as i,c as r,w as o,i as l,b as s,d,f as c,g as u,o as h,h as g,k as f,l as p,m,F as b,I as C,p as _,t as y}from"./index-D1p2mCzQ.js";import{_ as x}from"./download-excel.Ck8rHhh9.js";import{_ as k}from"./uni-pagination.xUXIXlYj.js";import{_ as S}from"./unicloud-db.iPsAcwdl.js";import{e as T,f as D}from"./bot_script.zPfMPwqS.js";const I=t.database(),$=[],j={ascending:"asc",descending:"desc"};const w=e({data:()=>({collectionList:"bot_script",query:"",where:"",orderby:"",orderByFieldName:"",selectedIndexs:[],options:{pageSize:20,pageCurrent:1,filterData:{},...T},imageStyles:{width:64,height:64},exportExcel:{filename:"bot_script.xls",type:"xls",fields:{aiScript:"aiScript",tokens:"tokens",beijingTime:"beijingTime",traderWords:"traderWords",roomId:"roomId",userPhone:"userPhone"}},exportExcelData:[]}),onLoad(){this._filter={}},onReady(){this.$refs.udb.loadData()},methods:{onqueryload(e){this.exportExcelData=e},getWhere(){const e=this.query.trim();if(!e)return"";const t=new RegExp(e,"i");return $.map((e=>t+".test("+e+")")).join(" || ")},search(){const e=this.getWhere();this.where=e,this.$nextTick((()=>{this.loadData()}))},loadData(e=!0){this.$refs.udb.loadData({clear:e})},onPageChanged(e){this.selectedIndexs.length=0,this.$refs.table.clearSelection(),this.$refs.udb.loadData({current:e.current})},navigateTo(e,t){a({url:e,events:{refreshData:()=>{this.loadData(t)}}})},selectedItems(){var e=this.$refs.udb.dataList;return this.selectedIndexs.map((t=>e[t]._id))},delTable(){this.$refs.udb.remove(this.selectedItems(),{success:e=>{this.$refs.table.clearSelection()}})},selectionChange(e){this.selectedIndexs=e.detail.index},confirmDelete(e){this.$refs.udb.remove(e,{success:e=>{this.$refs.table.clearSelection()}})},sortChange(e,t){this.orderByFieldName=t,e.order?this.orderby=t+" "+j[e.order]:this.orderby="",this.$refs.table.clearSelection(),this.$nextTick((()=>{this.$refs.udb.loadData()}))},filterChange(e,t){this._filter[t]={type:e.filterType,value:e.filter};let a=D(this._filter,I.command);Object.keys(a).length?this.where=a:this.where="",this.$nextTick((()=>{this.$refs.udb.loadData()}))}}},[["render",function(e,t,a,T,D,I){const $=l,j=C,w=_,z=n(i("download-excel"),x),E=n(i("uni-th"),s),F=n(i("uni-tr"),d),P=n(i("uni-td"),c),W=n(i("uni-table"),u),v=n(i("uni-pagination"),k),V=n(i("unicloud-db"),S);return h(),r($,null,{default:o((()=>[g($,{class:"uni-header"},{default:o((()=>[g($,{class:"uni-group"},{default:o((()=>[g($,{class:"uni-title"}),g($,{class:"uni-sub-title"})])),_:1}),g($,{class:"uni-group"},{default:o((()=>[g(j,{class:"uni-search",type:"text",modelValue:D.query,"onUpdate:modelValue":t[0]||(t[0]=e=>D.query=e),onConfirm:I.search,placeholder:"请输入搜索内容"},null,8,["modelValue","onConfirm"]),g(w,{class:"uni-button",type:"default",size:"mini",onClick:I.search},{default:o((()=>[f("搜索")])),_:1},8,["onClick"]),g(w,{class:"uni-button",type:"default",size:"mini",onClick:t[1]||(t[1]=e=>I.navigateTo("./add"))},{default:o((()=>[f("新增")])),_:1}),g(w,{class:"uni-button",type:"default",size:"mini",disabled:!D.selectedIndexs.length,onClick:I.delTable},{default:o((()=>[f("批量删除")])),_:1},8,["disabled","onClick"]),g(z,{class:"hide-on-phone",fields:D.exportExcel.fields,data:D.exportExcelData,type:D.exportExcel.type,name:D.exportExcel.filename},{default:o((()=>[g(w,{class:"uni-button",type:"primary",size:"mini"},{default:o((()=>[f("导出 Excel")])),_:1})])),_:1},8,["fields","data","type","name"])])),_:1})])),_:1}),g($,{class:"uni-container"},{default:o((()=>[g(V,{ref:"udb",collection:D.collectionList,field:"aiScript,tokens,beijingTime,traderWords,roomId,userPhone",where:D.where,"page-data":"replace",orderby:D.orderby,getcount:!0,"page-size":D.options.pageSize,"page-current":D.options.pageCurrent,options:D.options,loadtime:"manual",onLoad:I.onqueryload},{default:o((({data:e,pagination:a,loading:n,error:i,options:l})=>[g(W,{ref:"table",loading:n,emptyText:i.message||"没有更多数据",border:"",stripe:"",type:"selection",onSelectionChange:I.selectionChange},{default:o((()=>[g(F,null,{default:o((()=>[g(E,{align:"center","filter-type":"search",onFilterChange:t[2]||(t[2]=e=>I.filterChange(e,"aiScript")),sortable:"",onSortChange:t[3]||(t[3]=e=>I.sortChange(e,"aiScript"))},{default:o((()=>[f("aiScript")])),_:1}),g(E,{align:"center","filter-type":"range",onFilterChange:t[4]||(t[4]=e=>I.filterChange(e,"tokens")),sortable:"",onSortChange:t[5]||(t[5]=e=>I.sortChange(e,"tokens"))},{default:o((()=>[f("tokens")])),_:1}),g(E,{align:"center","filter-type":"date",onFilterChange:t[6]||(t[6]=e=>I.filterChange(e,"beijingTime")),sortable:"",onSortChange:t[7]||(t[7]=e=>I.sortChange(e,"beijingTime"))},{default:o((()=>[f("beijingTime")])),_:1}),g(E,{align:"center","filter-type":"search",onFilterChange:t[8]||(t[8]=e=>I.filterChange(e,"traderWords")),sortable:"",onSortChange:t[9]||(t[9]=e=>I.sortChange(e,"traderWords"))},{default:o((()=>[f("traderWords")])),_:1}),g(E,{align:"center","filter-type":"search",onFilterChange:t[10]||(t[10]=e=>I.filterChange(e,"roomId")),sortable:"",onSortChange:t[11]||(t[11]=e=>I.sortChange(e,"roomId"))},{default:o((()=>[f("roomId")])),_:1}),g(E,{align:"center","filter-type":"search",onFilterChange:t[12]||(t[12]=e=>I.filterChange(e,"userPhone")),sortable:"",onSortChange:t[13]||(t[13]=e=>I.sortChange(e,"userPhone"))},{default:o((()=>[f("userPhone")])),_:1}),g(E,{align:"center"},{default:o((()=>[f("操作")])),_:1})])),_:1}),(h(!0),p(b,null,m(e,((e,t)=>(h(),r(F,{key:t},{default:o((()=>[g(P,{align:"center"},{default:o((()=>[f(y(e.aiScript),1)])),_:2},1024),g(P,{align:"center"},{default:o((()=>[f(y(e.tokens),1)])),_:2},1024),g(P,{align:"center"},{default:o((()=>[f(y(e.beijingTime),1)])),_:2},1024),g(P,{align:"center"},{default:o((()=>[f(y(e.traderWords),1)])),_:2},1024),g(P,{align:"center"},{default:o((()=>[f(y(e.roomId),1)])),_:2},1024),g(P,{align:"center"},{default:o((()=>[f(y(e.userPhone),1)])),_:2},1024),g(P,{align:"center"},{default:o((()=>[g($,{class:"uni-group"},{default:o((()=>[g(w,{onClick:t=>I.navigateTo("./edit?id="+e._id,!1),class:"uni-button",size:"mini",type:"primary"},{default:o((()=>[f("修改")])),_:2},1032,["onClick"]),g(w,{onClick:t=>I.confirmDelete(e._id),class:"uni-button",size:"mini",type:"warn"},{default:o((()=>[f("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1032,["loading","emptyText","onSelectionChange"]),g($,{class:"uni-pagination-box"},{default:o((()=>[g(v,{"show-icon":"","page-size":a.size,modelValue:a.current,"onUpdate:modelValue":e=>a.current=e,total:a.count,onChange:I.onPageChanged},null,8,["page-size","modelValue","onUpdate:modelValue","total","onChange"])])),_:2},1024)])),_:1},8,["collection","where","orderby","page-size","page-current","options","onLoad"])])),_:1})])),_:1})}]]);export{w as default};
